/**
 * locator - In browser locator map generator
 * @version v0.0.1
 * @link https://github.com/datanews/locator#readme
 * @license MIT
 * @notes External libraries may be bundled here and their respective, original license applies.
 */
!function(t,e,o){"use strict";function n(t,e,o){var n,i=t.runtimeStyle&&t.runtimeStyle[e],a=t.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(o)&&/^-?\d/.test(o)&&(n=a.left,i&&(t.runtimeStyle.left=t.currentStyle.left),a.left="fontSize"===e?"1em":o||0,o=a.pixelLeft+"px",a.left=n,i&&(t.runtimeStyle.left=i)),/^(thin|medium|thick)$/i.test(o)?o:Math.round(parseFloat(o))+"px"}function i(t){return parseInt(t,10)}function a(t,e,i,a){if(t=(t||"").split(","),t=t[a||0]||t[0]||"auto",t=h.Util.trimText(t).split(" "),"backgroundSize"!==i||t[0]&&!t[0].match(/cover|contain|auto/)){if(t[0]=-1===t[0].indexOf("%")?n(e,i+"X",t[0]):t[0],t[1]===o){if("backgroundSize"===i)return t[1]="auto",t;t[1]=t[0]}t[1]=-1===t[1].indexOf("%")?n(e,i+"Y",t[1]):t[1]}else;return t}function r(t,e,o,n,i,a){var r,s,l,c,d=h.Util.getCSS(e,t,i);if(1===d.length&&(c=d[0],d=[],d[0]=c,d[1]=c),-1!==d[0].toString().indexOf("%"))l=parseFloat(d[0])/100,s=o.width*l,"backgroundSize"!==t&&(s-=(a||n).width*l);else if("backgroundSize"===t)if("auto"===d[0])s=n.width;else if(/contain|cover/.test(d[0])){var p=h.Util.resizeBounds(n.width,n.height,o.width,o.height,d[0]);s=p.width,r=p.height}else s=parseInt(d[0],10);else s=parseInt(d[0],10);return"auto"===d[1]?r=s/n.width*n.height:-1!==d[1].toString().indexOf("%")?(l=parseFloat(d[1])/100,r=o.height*l,"backgroundSize"!==t&&(r-=(a||n).height*l)):r=parseInt(d[1],10),[s,r]}function s(t,e){var o=[];return{storage:o,width:t,height:e,clip:function(){o.push({type:"function",name:"clip",arguments:arguments})},translate:function(){o.push({type:"function",name:"translate",arguments:arguments})},fill:function(){o.push({type:"function",name:"fill",arguments:arguments})},save:function(){o.push({type:"function",name:"save",arguments:arguments})},restore:function(){o.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){o.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){o.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var t=[];return o.push({type:"function",name:"drawShape",arguments:t}),{moveTo:function(){t.push({name:"moveTo",arguments:arguments})},lineTo:function(){t.push({name:"lineTo",arguments:arguments})},arcTo:function(){t.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){t.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){t.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){o.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){o.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(t,e){return o.push({type:"variable",name:t,arguments:e}),e}}}function l(t){return{zindex:t,children:[]}}var c,d,h={};h.Util={},h.Util.log=function(e){h.logging&&t.console&&t.console.log&&t.console.log(e)},h.Util.trimText=function(t){return function(e){return t?t.apply(e):((e||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),h.Util.asFloat=function(t){return parseFloat(t)},function(){var t=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,e=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;h.Util.parseTextShadows=function(o){if(!o||"none"===o)return[];for(var n=o.match(t),i=[],a=0;n&&a<n.length;a++){var r=n[a].match(e);i.push({color:r[0],offsetX:r[1]?r[1].replace("px",""):0,offsetY:r[2]?r[2].replace("px",""):0,blur:r[3]?r[3].replace("px",""):0})}return i}}(),h.Util.parseBackgroundImage=function(t){var e,o,n,i,a,r,s,l,c=" \r\n	",d=[],h=0,p=0,u=function(){e&&('"'===o.substr(0,1)&&(o=o.substr(1,o.length-2)),o&&l.push(o),"-"===e.substr(0,1)&&(i=e.indexOf("-",1)+1)>0&&(n=e.substr(0,i),e=e.substr(i)),d.push({prefix:n,method:e.toLowerCase(),value:a,args:l})),l=[],e=n=o=a=""};u();for(var m=0,g=t.length;g>m;m++)if(r=t[m],!(0===h&&c.indexOf(r)>-1)){switch(r){case'"':s?s===r&&(s=null):s=r;break;case"(":if(s)break;if(0===h){h=1,a+=r;continue}p++;break;case")":if(s)break;if(1===h){if(0===p){h=0,a+=r,u();continue}p--}break;case",":if(s)break;if(0===h){u();continue}if(1===h&&0===p&&!e.match(/^url$/i)){l.push(o),o="",a+=r;continue}}a+=r,0===h?e+=r:o+=r}return u(),d},h.Util.Bounds=function(t){var e,o={};return t.getBoundingClientRect&&(e=t.getBoundingClientRect(),o.top=Math.floor(e.top),o.bottom=Math.floor(e.bottom||e.top+e.height),o.left=Math.floor(e.left),o.width=Math.floor(t.offsetWidth),o.height=Math.floor(t.offsetHeight)),o},h.Util.OffsetBounds=function(t){var e=t.offsetParent?h.Util.OffsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},h.Util.getCSS=function(t,o,n){c!==t&&(d=e.defaultView.getComputedStyle(t,null));var r=d[o];if(/^background(Size|Position)$/.test(o))return a(r,t,o,n);if(/border(Top|Bottom)(Left|Right)Radius/.test(o)){var s=r.split(" ");return s.length<=1&&(s[1]=s[0]),s.map(i)}return r},h.Util.resizeBounds=function(t,e,o,n,i){var a,r,s=o/n,l=t/e;return i&&"auto"!==i?l>s^"contain"===i?(r=n,a=n*l):(a=o,r=o/l):(a=o,r=n),{width:a,height:r}},h.Util.BackgroundPosition=function(t,e,o,n,i){var a=r("backgroundPosition",t,e,o,n,i);return{left:a[0],top:a[1]}},h.Util.BackgroundSize=function(t,e,o,n){var i=r("backgroundSize",t,e,o,n);return{width:i[0],height:i[1]}},h.Util.Extend=function(t,e){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e},h.Util.Children=function(t){var e;try{e=t.nodeName&&"IFRAME"===t.nodeName.toUpperCase()?t.contentDocument||t.contentWindow.document:function(t){var e=[];return null!==t&&!function(t,e){var n=t.length,i=0;if("number"==typeof e.length)for(var a=e.length;a>i;i++)t[n++]=e[i];else for(;e[i]!==o;)t[n++]=e[i++];return t.length=n,t}(e,t),e}(t.childNodes)}catch(n){h.Util.log("html2canvas.Util.Children failed with exception: "+n.message),e=[]}return e},h.Util.isTransparent=function(t){return"transparent"===t||"rgba(0, 0, 0, 0)"===t},h.Util.Font=function(){var t={};return function(e,n,i){if(t[e+"-"+n]!==o)return t[e+"-"+n];var a,r,s,l=i.createElement("div"),c=i.createElement("img"),d=i.createElement("span"),h="Hidden Text";return l.style.visibility="hidden",l.style.fontFamily=e,l.style.fontSize=n,l.style.margin=0,l.style.padding=0,i.body.appendChild(l),c.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",c.width=1,c.height=1,c.style.margin=0,c.style.padding=0,c.style.verticalAlign="baseline",d.style.fontFamily=e,d.style.fontSize=n,d.style.margin=0,d.style.padding=0,d.appendChild(i.createTextNode(h)),l.appendChild(d),l.appendChild(c),a=c.offsetTop-d.offsetTop+1,l.removeChild(d),l.appendChild(i.createTextNode(h)),l.style.lineHeight="normal",c.style.verticalAlign="super",r=c.offsetTop-l.offsetTop+1,s={baseline:a,lineWidth:1,middle:r},t[e+"-"+n]=s,i.body.removeChild(l),s}}(),function(){function t(t){return function(e){try{t.addColorStop(e.stop,e.color)}catch(n){o.log(["failed to add color stop: ",n,"; tried to add: ",e])}}}var o=h.Util,n={};h.Generate=n;var i=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];n.parseGradient=function(t,e){var o,n,a,r,s,l,c,d,h,p,u,m,g=i.length;for(n=0;g>n&&!(a=t.match(i[n]));n+=1);if(a)switch(a[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(o={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},s=a[2].match(/\w+/g))for(l=s.length,n=0;l>n;n+=1)switch(s[n]){case"top":o.y0=0,o.y1=e.height;break;case"right":o.x0=e.width,o.x1=0;break;case"bottom":o.y0=e.height,o.y1=0;break;case"left":o.x0=0,o.x1=e.width}if(null===o.x0&&null===o.x1&&(o.x0=o.x1=e.width/2),null===o.y0&&null===o.y1&&(o.y0=o.y1=e.height/2),s=a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,c=1/Math.max(l-1,1),n=0;l>n;n+=1)d=s[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),d[2]?(r=parseFloat(d[2]),r/="%"===d[3]?100:e.width):r=n*c,o.colorStops.push({color:d[1],stop:r});break;case"-webkit-gradient":if(o={type:"radial"===a[2]?"circle":a[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},s=a[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),s&&(o.x0=s[1]*e.width/100,o.y0=s[2]*e.height/100,o.x1=s[3]*e.width/100,o.y1=s[4]*e.height/100),s=a[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(l=s.length,n=0;l>n;n+=1)d=s[n].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),r=parseFloat(d[2]),"from"===d[1]&&(r=0),"to"===d[1]&&(r=1),o.colorStops.push({color:d[3],stop:r});break;case"-moz-linear-gradient":if(o={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},s=a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),s&&(o.x0=s[1]*e.width/100,o.y0=s[2]*e.height/100,o.x1=e.width-o.x0,o.y1=e.height-o.y0),s=a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(l=s.length,c=1/Math.max(l-1,1),n=0;l>n;n+=1)d=s[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),d[2]?(r=parseFloat(d[2]),d[3]&&(r/=100)):r=n*c,o.colorStops.push({color:d[1],stop:r});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(o={type:"circle",x0:0,y0:0,x1:e.width,y1:e.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},s=a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),s&&(o.cx=s[1]*e.width/100,o.cy=s[2]*e.height/100),s=a[3].match(/\w+/),d=a[4].match(/[a-z\-]*/),s&&d)switch(d[0]){case"farthest-corner":case"cover":case"":h=Math.sqrt(Math.pow(o.cx,2)+Math.pow(o.cy,2)),p=Math.sqrt(Math.pow(o.cx,2)+Math.pow(o.y1-o.cy,2)),u=Math.sqrt(Math.pow(o.x1-o.cx,2)+Math.pow(o.y1-o.cy,2)),m=Math.sqrt(Math.pow(o.x1-o.cx,2)+Math.pow(o.cy,2)),o.rx=o.ry=Math.max(h,p,u,m);break;case"closest-corner":h=Math.sqrt(Math.pow(o.cx,2)+Math.pow(o.cy,2)),p=Math.sqrt(Math.pow(o.cx,2)+Math.pow(o.y1-o.cy,2)),u=Math.sqrt(Math.pow(o.x1-o.cx,2)+Math.pow(o.y1-o.cy,2)),m=Math.sqrt(Math.pow(o.x1-o.cx,2)+Math.pow(o.cy,2)),o.rx=o.ry=Math.min(h,p,u,m);break;case"farthest-side":"circle"===s[0]?o.rx=o.ry=Math.max(o.cx,o.cy,o.x1-o.cx,o.y1-o.cy):(o.type=s[0],o.rx=Math.max(o.cx,o.x1-o.cx),o.ry=Math.max(o.cy,o.y1-o.cy));break;case"closest-side":case"contain":"circle"===s[0]?o.rx=o.ry=Math.min(o.cx,o.cy,o.x1-o.cx,o.y1-o.cy):(o.type=s[0],o.rx=Math.min(o.cx,o.x1-o.cx),o.ry=Math.min(o.cy,o.y1-o.cy))}if(s=a[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,c=1/Math.max(l-1,1),n=0;l>n;n+=1)d=s[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),d[2]?(r=parseFloat(d[2]),r/="%"===d[3]?100:e.width):r=n*c,o.colorStops.push({color:d[1],stop:r})}return o},n.Gradient=function(o,n){if(0!==n.width&&0!==n.height){var i,a,r=e.createElement("canvas"),s=r.getContext("2d");if(r.width=n.width,r.height=n.height,i=h.Generate.parseGradient(o,n))switch(i.type){case"linear":a=s.createLinearGradient(i.x0,i.y0,i.x1,i.y1),i.colorStops.forEach(t(a)),s.fillStyle=a,s.fillRect(0,0,n.width,n.height);break;case"circle":a=s.createRadialGradient(i.cx,i.cy,0,i.cx,i.cy,i.rx),i.colorStops.forEach(t(a)),s.fillStyle=a,s.fillRect(0,0,n.width,n.height);break;case"ellipse":var l=e.createElement("canvas"),c=l.getContext("2d"),d=Math.max(i.rx,i.ry),p=2*d;l.width=l.height=p,a=c.createRadialGradient(i.rx,i.ry,0,i.rx,i.ry,d),i.colorStops.forEach(t(a)),c.fillStyle=a,c.fillRect(0,0,p,p),s.fillStyle=i.colorStops[i.colorStops.length-1].color,s.fillRect(0,0,r.width,r.height),s.drawImage(l,i.cx-i.rx,i.cy-i.ry,2*i.rx,2*i.ry)}return r}},n.ListAlpha=function(t){var e,o="";do e=t%26,o=String.fromCharCode(e+64)+o,t/=26;while(26*t>26);return o},n.ListRoman=function(t){var e,o=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],n=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],i="",a=o.length;if(0>=t||t>=4e3)return t;for(e=0;a>e;e+=1)for(;t>=n[e];)t-=n[e],i+=o[e];return i}}(),h.Parse=function(n,i){function a(){return Math.max(Math.max(dt.body.scrollWidth,dt.documentElement.scrollWidth),Math.max(dt.body.offsetWidth,dt.documentElement.offsetWidth),Math.max(dt.body.clientWidth,dt.documentElement.clientWidth))}function r(){return Math.max(Math.max(dt.body.scrollHeight,dt.documentElement.scrollHeight),Math.max(dt.body.offsetHeight,dt.documentElement.offsetHeight),Math.max(dt.body.clientHeight,dt.documentElement.clientHeight))}function c(t,e){var o=parseInt(gt(t,e),10);return isNaN(o)?0:o}function d(t,e,o,n,i,a){"transparent"!==a&&(t.setVariable("fillStyle",a),t.fillRect(e,o,n,i),ct+=1)}function p(t,e,o){return t.length>0?e+o.toUpperCase():void 0}function u(t,e){switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,p);case"uppercase":return t.toUpperCase();default:return t}}function m(t){return/^(normal|none|0px)$/.test(t)}function g(t,e,o,n){null!==t&&ht.trimText(t).length>0&&(n.fillText(t,e,o),ct+=1)}function f(t,e,o,n){var i=!1,a=gt(e,"fontWeight"),r=gt(e,"fontFamily"),s=gt(e,"fontSize"),l=ht.parseTextShadows(gt(e,"textShadow"));switch(parseInt(a,10)){case 401:a="bold";break;case 400:a="normal"}return t.setVariable("fillStyle",n),t.setVariable("font",[gt(e,"fontStyle"),gt(e,"fontVariant"),a,s,r].join(" ")),t.setVariable("textAlign",i?"right":"left"),l.length&&(t.setVariable("shadowColor",l[0].color),t.setVariable("shadowOffsetX",l[0].offsetX),t.setVariable("shadowOffsetY",l[0].offsetY),t.setVariable("shadowBlur",l[0].blur)),"none"!==o?ht.Font(r,s,dt):void 0}function b(t,e,o,n,i){switch(e){case"underline":d(t,o.left,Math.round(o.top+n.baseline+n.lineWidth),o.width,1,i);break;case"overline":d(t,o.left,Math.round(o.top),o.width,1,i);break;case"line-through":d(t,o.left,Math.ceil(o.top+n.middle+n.lineWidth),o.width,1,i)}}function w(t,e,o,n,i){var a;if(pt.rangeBounds&&!i)("none"!==o||0!==ht.trimText(e).length)&&(a=y(e,t.node,t.textOffset)),t.textOffset+=e.length;else if(t.node&&"string"==typeof t.node.nodeValue){var r=n?t.node.splitText(e.length):null;a=v(t.node,i),t.node=r}return a}function y(t,e,o){var n=dt.createRange();return n.setStart(e,o),n.setEnd(e,o+t.length),n.getBoundingClientRect()}function v(t,e){var o=t.parentNode,n=dt.createElement("wrapper"),i=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),o.replaceChild(n,t);var a=e?ht.OffsetBounds(n):ht.Bounds(n);return o.replaceChild(i,n),a}function x(t,e,o){var n,a,r=o.ctx,s=gt(t,"color"),l=gt(t,"textDecoration"),c=gt(t,"textAlign"),d={node:e,textOffset:0};ht.trimText(e.nodeValue).length>0&&(e.nodeValue=u(e.nodeValue,gt(t,"textTransform")),c=c.replace(["-webkit-auto"],["auto"]),a=!i.letterRendering&&/^(left|right|justify|auto)$/.test(c)&&m(gt(t,"letterSpacing"))?e.nodeValue.split(/(\b| )/):e.nodeValue.split(""),n=f(r,t,l,s),i.chinese&&a.forEach(function(t,e){/.*[\u4E00-\u9FA5].*$/.test(t)&&(t=t.split(""),t.unshift(e,1),a.splice.apply(a,t))}),a.forEach(function(t,e){var i=w(d,t,l,e<a.length-1,o.transform.matrix);i&&(g(t,i.left,i.bottom,r),b(r,l,i,n,s))}))}function k(t,e){var o,n,i=dt.createElement("boundelement");return i.style.display="inline",o=t.style.listStyleType,t.style.listStyleType="none",i.appendChild(dt.createTextNode(e)),t.insertBefore(i,t.firstChild),n=ht.Bounds(i),t.removeChild(i),t.style.listStyleType=o,n}function C(t){var e=-1,o=1,n=t.parentNode.childNodes;if(t.parentNode){for(;n[++e]!==t;)1===n[e].nodeType&&o++;return o}return-1}function M(t,e){var o,n=C(t);switch(e){case"decimal":o=n;break;case"decimal-leading-zero":o=1===n.toString().length?n="0"+n.toString():n.toString();break;case"upper-roman":o=h.Generate.ListRoman(n);break;case"lower-roman":o=h.Generate.ListRoman(n).toLowerCase();break;case"lower-alpha":o=h.Generate.ListAlpha(n).toLowerCase();break;case"upper-alpha":o=h.Generate.ListAlpha(n)}return o+". "}function A(t,e,o){var n,i,a,r=e.ctx,s=gt(t,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(s)){if(i=M(t,s),a=k(t,i),f(r,t,"none",gt(t,"color")),"inside"!==gt(t,"listStylePosition"))return;r.setVariable("textAlign","left"),n=o.left,g(i,n,a.bottom,r)}}function S(t){var e=n[t];return e&&e.succeeded===!0?e.img:!1}function T(t,e){var o=Math.max(t.left,e.left),n=Math.max(t.top,e.top),i=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height);return{left:o,top:n,width:i-o,height:a-n}}function R(t,e,o){var n,i="static"!==e.cssPosition,a=i?gt(t,"zIndex"):"auto",r=gt(t,"opacity"),s="none"!==gt(t,"cssFloat");e.zIndex=n=l(a),n.isPositioned=i,n.isFloated=s,n.opacity=r,n.ownStacking="auto"!==a||1>r,o&&o.zIndex.children.push(e)}function L(t,e,o,n,i){var a=c(e,"paddingLeft"),r=c(e,"paddingTop"),s=c(e,"paddingRight"),l=c(e,"paddingBottom");V(t,o,0,0,o.width,o.height,n.left+a+i[3].width,n.top+r+i[0].width,n.width-(i[1].width+i[3].width+a+s),n.height-(i[0].width+i[2].width+r+l))}function E(t){return["Top","Right","Bottom","Left"].map(function(e){return{width:c(t,"border"+e+"Width"),color:gt(t,"border"+e+"Color")}})}function O(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){return gt(t,"border"+e+"Radius")})}function I(t,e,o,n){var i=function(t,e,o){return{x:t.x+(e.x-t.x)*o,y:t.y+(e.y-t.y)*o}};return{start:t,startControl:e,endControl:o,end:n,subdivide:function(a){var r=i(t,e,a),s=i(e,o,a),l=i(o,n,a),c=i(r,s,a),d=i(s,l,a),h=i(c,d,a);return[I(t,r,c,h),I(h,d,l,n)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,o.x,o.y,n.x,n.y])},curveToReversed:function(n){n.push(["bezierCurve",o.x,o.y,e.x,e.y,t.x,t.y])}}}function P(t,e,o,n,i,a,r){e[0]>0||e[1]>0?(t.push(["line",n[0].start.x,n[0].start.y]),n[0].curveTo(t),n[1].curveTo(t)):t.push(["line",a,r]),(o[0]>0||o[1]>0)&&t.push(["line",i[0].start.x,i[0].start.y])}function z(t,e,o,n,i,a,r){var s=[];return e[0]>0||e[1]>0?(s.push(["line",n[1].start.x,n[1].start.y]),n[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),o[0]>0||o[1]>0?(s.push(["line",a[0].start.x,a[0].start.y]),a[0].curveTo(s),s.push(["line",r[0].end.x,r[0].end.y]),r[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",i[1].end.x,i[1].end.y]),i[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function B(t,e,o){var n=t.left,i=t.top,a=t.width,r=t.height,s=e[0][0],l=e[0][1],c=e[1][0],d=e[1][1],h=e[2][0],p=e[2][1],u=e[3][0],m=e[3][1],g=a-c,f=r-p,b=a-h,w=r-m;return{topLeftOuter:wt(n,i,s,l).topLeft.subdivide(.5),topLeftInner:wt(n+o[3].width,i+o[0].width,Math.max(0,s-o[3].width),Math.max(0,l-o[0].width)).topLeft.subdivide(.5),topRightOuter:wt(n+g,i,c,d).topRight.subdivide(.5),topRightInner:wt(n+Math.min(g,a+o[3].width),i+o[0].width,g>a+o[3].width?0:c-o[3].width,d-o[0].width).topRight.subdivide(.5),bottomRightOuter:wt(n+b,i+f,h,p).bottomRight.subdivide(.5),bottomRightInner:wt(n+Math.min(b,a+o[3].width),i+Math.min(f,r+o[0].width),Math.max(0,h-o[1].width),Math.max(0,p-o[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:wt(n,i+w,u,m).bottomLeft.subdivide(.5),bottomLeftInner:wt(n+o[3].width,i+w,Math.max(0,u-o[3].width),Math.max(0,m-o[2].width)).bottomLeft.subdivide(.5)}}function F(t,e,o,n,i){var a=gt(t,"backgroundClip"),r=[];switch(a){case"content-box":case"padding-box":P(r,n[0],n[1],e.topLeftInner,e.topRightInner,i.left+o[3].width,i.top+o[0].width),P(r,n[1],n[2],e.topRightInner,e.bottomRightInner,i.left+i.width-o[1].width,i.top+o[0].width),P(r,n[2],n[3],e.bottomRightInner,e.bottomLeftInner,i.left+i.width-o[1].width,i.top+i.height-o[2].width),P(r,n[3],n[0],e.bottomLeftInner,e.topLeftInner,i.left+o[3].width,i.top+i.height-o[2].width);break;default:P(r,n[0],n[1],e.topLeftOuter,e.topRightOuter,i.left,i.top),P(r,n[1],n[2],e.topRightOuter,e.bottomRightOuter,i.left+i.width,i.top),P(r,n[2],n[3],e.bottomRightOuter,e.bottomLeftOuter,i.left+i.width,i.top+i.height),P(r,n[3],n[0],e.bottomLeftOuter,e.topLeftOuter,i.left,i.top+i.height)}return r}function U(t,e,o){var n,i,a,r,s,l,c=e.left,d=e.top,h=e.width,p=e.height,u=O(t),m=B(e,u,o),g={clip:F(t,m,o,u,e),borders:[]};for(n=0;4>n;n++)if(o[n].width>0){switch(i=c,a=d,r=h,s=p-o[2].width,n){case 0:s=o[0].width,l=z({c1:[i,a],c2:[i+r,a],c3:[i+r-o[1].width,a+s],c4:[i+o[3].width,a+s]},u[0],u[1],m.topLeftOuter,m.topLeftInner,m.topRightOuter,m.topRightInner);break;case 1:i=c+h-o[1].width,r=o[1].width,l=z({c1:[i+r,a],c2:[i+r,a+s+o[2].width],c3:[i,a+s],c4:[i,a+o[0].width]},u[1],u[2],m.topRightOuter,m.topRightInner,m.bottomRightOuter,m.bottomRightInner);break;case 2:a=a+p-o[2].width,s=o[2].width,l=z({c1:[i+r,a+s],c2:[i,a+s],c3:[i+o[3].width,a],c4:[i+r-o[3].width,a]},u[2],u[3],m.bottomRightOuter,m.bottomRightInner,m.bottomLeftOuter,m.bottomLeftInner);break;case 3:r=o[3].width,l=z({c1:[i,a+s+o[2].width],c2:[i,a],c3:[i+r,a+o[0].width],c4:[i+r,a+s]},u[3],u[0],m.bottomLeftOuter,m.bottomLeftInner,m.topLeftOuter,m.topLeftInner)}g.borders.push({args:l,color:o[n].color})}return g}function _(t,e){var o=t.drawShape();return e.forEach(function(t,e){o[0===e?"moveTo":t[0]+"To"].apply(null,t.slice(1))}),o}function N(t,e,o){"transparent"!==o&&(t.setVariable("fillStyle",o),_(t,e),t.fill(),ct+=1)}function D(t,e,o){var n,i,a=dt.createElement("valuewrap"),r=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];r.forEach(function(e){try{a.style[e]=gt(t,e)}catch(o){ht.log("html2canvas: Parse: Exception caught in renderFormValue: "+o.message)}}),a.style.borderColor="black",a.style.borderStyle="solid",a.style.display="block",a.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(t.type)||"SELECT"===t.nodeName)&&(a.style.lineHeight=gt(t,"height")),a.style.top=e.top+"px",a.style.left=e.left+"px",n="SELECT"===t.nodeName?(t.options[t.selectedIndex]||0).text:t.value,n||(n=t.placeholder),i=dt.createTextNode(n),a.appendChild(i),mt.appendChild(a),x(t,i,o),mt.removeChild(a)}function V(t){t.drawImage.apply(t,Array.prototype.slice.call(arguments,1)),ct+=1}function W(o,n){var i=t.getComputedStyle(o,n);if(i&&i.content&&"none"!==i.content&&"-moz-alt-content"!==i.content&&"none"!==i.display){var a=i.content+"",r=a.substr(0,1);r===a.substr(a.length-1)&&r.match(/'|"/)&&(a=a.substr(1,a.length-2));var s="url"===a.substr(0,3),l=e.createElement(s?"img":"span");return l.className=ft+"-before "+ft+"-after",Object.keys(i).filter(G).forEach(function(t){try{l.style[t]=i[t]}catch(e){ht.log(["Tried to assign readonly property ",t,"Error:",e])}}),s?l.src=ht.parseBackgroundImage(a)[0].args[0]:l.innerHTML=a,l}}function G(e){return isNaN(t.parseInt(e,10))}function H(t,e){var o=W(t,":before"),n=W(t,":after");(o||n)&&(o&&(t.className+=" "+ft+"-before",t.parentNode.insertBefore(o,t),at(o,e,!0),t.parentNode.removeChild(o),t.className=t.className.replace(ft+"-before","").trim()),n&&(t.className+=" "+ft+"-after",t.appendChild(n),at(n,e,!0),t.removeChild(n),t.className=t.className.replace(ft+"-after","").trim()))}function Y(t,e,o,n){var i=Math.round(n.left+o.left),a=Math.round(n.top+o.top);t.createPattern(e),t.translate(i,a),t.fill(),t.translate(-i,-a)}function j(t,e,o,n,i,a,r,s){var l=[];l.push(["line",Math.round(i),Math.round(a)]),l.push(["line",Math.round(i+r),Math.round(a)]),l.push(["line",Math.round(i+r),Math.round(s+a)]),l.push(["line",Math.round(i),Math.round(s+a)]),_(t,l),t.save(),t.clip(),Y(t,e,o,n),t.restore()}function X(t,e,o){d(t,e.left,e.top,e.width,e.height,o)}function Z(t,e,o,n,i){var a=ht.BackgroundSize(t,e,n,i),r=ht.BackgroundPosition(t,e,n,i,a),s=gt(t,"backgroundRepeat").split(",").map(ht.trimText);switch(n=q(n,a),s=s[i]||s[0]){case"repeat-x":j(o,n,r,e,e.left,e.top+r.top,99999,n.height);break;case"repeat-y":j(o,n,r,e,e.left+r.left,e.top,n.width,99999);break;case"no-repeat":j(o,n,r,e,e.left+r.left,e.top+r.top,n.width,n.height);break;default:Y(o,n,r,{top:e.top,left:e.left,width:n.width,height:n.height})}}function Q(t,e,o){for(var n,i=gt(t,"backgroundImage"),a=ht.parseBackgroundImage(i),r=a.length;r--;)if(i=a[r],i.args&&0!==i.args.length){var s="url"===i.method?i.args[0]:i.value;n=S(s),n?Z(t,e,o,n,r):ht.log("html2canvas: Error loading background:",i)}}function q(t,e){if(t.width===e.width&&t.height===e.height)return t;var o,n=dt.createElement("canvas");return n.width=e.width,n.height=e.height,o=n.getContext("2d"),V(o,t,0,0,t.width,t.height,0,0,e.width,e.height),n}function $(t,e,o){return t.setVariable("globalAlpha",gt(e,"opacity")*(o?o.opacity:1))}function J(t){return t.replace("px","")}function K(t,e){var o=gt(t,"transform")||gt(t,"-webkit-transform")||gt(t,"-moz-transform")||gt(t,"-ms-transform")||gt(t,"-o-transform"),n=gt(t,"transform-origin")||gt(t,"-webkit-transform-origin")||gt(t,"-moz-transform-origin")||gt(t,"-ms-transform-origin")||gt(t,"-o-transform-origin")||"0px 0px";n=n.split(" ").map(J).map(ht.asFloat);var i;if(o&&"none"!==o){var a=o.match(yt);if(a)switch(a[1]){case"matrix":i=a[2].split(",").map(ht.trimText).map(ht.asFloat)}}return{origin:n,matrix:i}}function tt(t,e,o,n){var l=s(e?o.width:a(),e?o.height:r()),c={ctx:l,opacity:$(l,t,e),cssPosition:gt(t,"position"),borders:E(t),transform:n,clip:e&&e.clip?ht.Extend({},e.clip):null};return R(t,c,e),i.useOverflow===!0&&/(hidden|scroll|auto)/.test(gt(t,"overflow"))===!0&&/(BODY)/i.test(t.nodeName)===!1&&(c.clip=c.clip?T(c.clip,o):o),c}function et(t,e,o){var n={left:e.left+t[3].width,top:e.top+t[0].width,width:e.width-(t[1].width+t[3].width),height:e.height-(t[0].width+t[2].width)};return o&&(n=T(n,o)),n}function ot(t,e){var o=e.matrix?ht.OffsetBounds(t):ht.Bounds(t);return e.origin[0]+=o.left,e.origin[1]+=o.top,o}function nt(t,e,o,n){var i,a=K(t,e),r=ot(t,a),s=tt(t,e,r,a),l=s.borders,c=s.ctx,d=et(l,r,s.clip),h=U(t,r,l),p=ut.test(t.nodeName)?"#efefef":gt(t,"backgroundColor");switch(_(c,h.clip),c.save(),c.clip(),d.height>0&&d.width>0&&!n?(X(c,r,p),Q(t,d,c)):n&&(s.backgroundColor=p),c.restore(),h.borders.forEach(function(t){N(c,t.args,t.color)}),o||H(t,s),t.nodeName){case"IMG":(i=S(t.getAttribute("src")))?L(c,t,i,r,l):ht.log("html2canvas: Error loading <img>:"+t.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(t.type)&&(t.value||t.placeholder||"").length>0&&D(t,r,s);break;case"TEXTAREA":(t.value||t.placeholder||"").length>0&&D(t,r,s);break;case"SELECT":(t.options||t.placeholder||"").length>0&&D(t,r,s);break;case"LI":A(t,s,d);break;case"CANVAS":L(c,t,t,r,l)}return s}function it(t){return"none"!==gt(t,"display")&&"hidden"!==gt(t,"visibility")&&!t.hasAttribute("data-html2canvas-ignore")}function at(t,e,o){it(t)&&(e=nt(t,e,o,!1)||e,ut.test(t.nodeName)||rt(t,e,o))}function rt(t,e,o){ht.Children(t).forEach(function(n){n.nodeType===n.ELEMENT_NODE?at(n,e,o):n.nodeType===n.TEXT_NODE&&x(t,n,e)})}function st(){var t=gt(e.documentElement,"backgroundColor"),o=ht.isTransparent(t)&&lt===e.body,n=nt(lt,null,!1,o);return rt(lt,n),o&&(t=n.backgroundColor),mt.removeChild(bt),{backgroundColor:t,stack:n}}t.scroll(0,0);var lt=i.elements===o?e.body:i.elements[0],ct=0,dt=lt.ownerDocument,ht=h.Util,pt=ht.Support(i,dt),ut=new RegExp("("+i.ignoreElements+")"),mt=dt.body,gt=ht.getCSS,ft="___html2canvas___pseudoelement",bt=dt.createElement("style");bt.innerHTML="."+ft+'-before:before { content: "" !important; display: none !important; }.'+ft+'-after:after { content: "" !important; display: none !important; }',mt.appendChild(bt),n=n||{};var wt=function(t){return function(e,o,n,i){var a=n*t,r=i*t,s=e+n,l=o+i;return{topLeft:I({x:e,y:l},{x:e,y:l-r},{x:s-a,y:o},{x:s,y:o}),topRight:I({x:e,y:o},{x:e+a,y:o},{x:s,y:l-r},{x:s,y:l}),bottomRight:I({x:s,y:o},{x:s,y:o+r},{x:e+a,y:l},{x:e,y:l}),bottomLeft:I({x:s,y:l},{x:s-a,y:l},{x:e,y:o+r},{x:e,y:o})}}}(4*((Math.sqrt(2)-1)/3)),yt=/(matrix)\((.+)\)/;return st()},h.Preload=function(n){function i(t){S.href=t,S.href=S.href;var e=S.protocol+S.host;return e===g}function a(){v.log("html2canvas: start: images: "+y.numLoaded+" / "+y.numTotal+" (failed: "+y.numFailed+")"),!y.firstRun&&y.numLoaded>=y.numTotal&&(v.log("Finished loading images: # "+y.numTotal+" (failed: "+y.numFailed+")"),"function"==typeof n.complete&&n.complete(y))}function r(e,i,r){var s,l,c=n.proxy;S.href=e,e=S.href,s="html2canvas_"+x++,r.callbackname=s,c+=c.indexOf("?")>-1?"&":"?",c+="url="+encodeURIComponent(e)+"&callback="+s,l=C.createElement("script"),t[s]=function(e){"error:"===e.substring(0,6)?(r.succeeded=!1,y.numLoaded++,y.numFailed++,a()):(m(i,r),i.src=e),t[s]=o;try{delete t[s]}catch(n){}l.parentNode.removeChild(l),l=null,delete r.script,delete r.callbackname},l.setAttribute("type","text/javascript"),l.setAttribute("src",c),r.script=l,t.document.body.appendChild(l)}function s(e,o){var n=t.getComputedStyle(e,o),i=n.content;"url"===i.substr(0,3)&&f.loadImage(h.Util.parseBackgroundImage(i)[0].args[0]),p(n.backgroundImage,e)}function l(t){s(t,":before"),s(t,":after")}function c(t,e){var n=h.Generate.Gradient(t,e);n!==o&&(y[t]={img:n,succeeded:!0},y.numTotal++,y.numLoaded++,a())}function d(t){return t&&t.method&&t.args&&t.args.length>0}function p(t,e){var n;h.Util.parseBackgroundImage(t).filter(d).forEach(function(t){"url"===t.method?f.loadImage(t.args[0]):t.method.match(/\-?gradient$/)&&(n===o&&(n=h.Util.Bounds(e)),c(t.value,n))})}function u(t){var e=!1;try{v.Children(t).forEach(u)}catch(n){}try{e=t.nodeType}catch(i){e=!1,v.log("html2canvas: failed to access some element's nodeType - Exception: "+i.message)}if(1===e||e===o){l(t);try{p(v.getCSS(t,"backgroundImage"),t)}catch(n){v.log("html2canvas: failed to get background-image - Exception: "+n.message)}p(t)}}function m(e,i){e.onload=function(){i.timer!==o&&t.clearTimeout(i.timer),y.numLoaded++,i.succeeded=!0,e.onerror=e.onload=null,a()},e.onerror=function(){if("anonymous"===e.crossOrigin&&(t.clearTimeout(i.timer),n.proxy)){var o=e.src;return e=new Image,i.img=e,e.src=o,void r(e.src,e,i)}y.numLoaded++,y.numFailed++,i.succeeded=!1,e.onerror=e.onload=null,a()}}var g,f,b,w,y={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},v=h.Util,x=0,k=n.elements[0]||e.body,C=k.ownerDocument,M=k.getElementsByTagName("img"),A=M.length,S=C.createElement("a"),T=function(t){return t.crossOrigin!==o}(new Image);for(S.href=t.location.href,g=S.protocol+S.host,f={loadImage:function(t){var e,a;t&&y[t]===o&&(e=new Image,t.match(/data:image\/.*;base64,/i)?(e.src=t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),a=y[t]={img:e},y.numTotal++,m(e,a)):i(t)||n.allowTaint===!0?(a=y[t]={img:e},y.numTotal++,m(e,a),e.src=t):T&&!n.allowTaint&&n.useCORS?(e.crossOrigin="anonymous",a=y[t]={img:e},y.numTotal++,m(e,a),e.src=t):n.proxy&&(a=y[t]={img:e},y.numTotal++,r(t,e,a)))},cleanupDOM:function(i){var r,s;if(!y.cleanupDone){i&&"string"==typeof i?v.log("html2canvas: Cleanup because: "+i):v.log("html2canvas: Cleanup after timeout: "+n.timeout+" ms.");for(s in y)if(y.hasOwnProperty(s)&&(r=y[s],"object"==typeof r&&r.callbackname&&r.succeeded===o)){t[r.callbackname]=o;try{delete t[r.callbackname]}catch(l){}r.script&&r.script.parentNode&&(r.script.setAttribute("src","about:blank"),r.script.parentNode.removeChild(r.script)),y.numLoaded++,y.numFailed++,v.log("html2canvas: Cleaned up failed img: '"+s+"' Steps: "+y.numLoaded+" / "+y.numTotal)}t.stop!==o?t.stop():e.execCommand!==o&&e.execCommand("Stop",!1),e.close!==o&&e.close(),y.cleanupDone=!0,i&&"string"==typeof i||a()}},renderingDone:function(){w&&t.clearTimeout(w)}},n.timeout>0&&(w=t.setTimeout(f.cleanupDOM,n.timeout)),v.log("html2canvas: Preload starts: finding background-images"),y.firstRun=!0,u(k),v.log("html2canvas: Preload: Finding images"),b=0;A>b;b+=1)f.loadImage(M[b].getAttribute("src"));return y.firstRun=!1,v.log("html2canvas: Preload: Done."),y.numTotal===y.numLoaded&&a(),
f},h.Renderer=function(t,n){function i(t){function e(t){Object.keys(t).sort().forEach(function(o){var n=[],a=[],r=[],s=[];t[o].forEach(function(t){t.node.zIndex.isPositioned||t.node.zIndex.opacity<1?r.push(t):t.node.zIndex.isFloated?a.push(t):n.push(t)}),function l(t){t.forEach(function(t){s.push(t),t.children&&l(t.children)})}(n.concat(a,r)),s.forEach(function(t){t.context?e(t.context):i.push(t.node)})})}var n,i=[];return n=function(t){function e(t,n,i){var a="auto"===n.zIndex.zindex?0:Number(n.zIndex.zindex),r=t,s=n.zIndex.isPositioned,l=n.zIndex.isFloated,c={node:n},d=i;n.zIndex.ownStacking?(r=c.context={"!":[{node:n,children:[]}]},d=o):(s||l)&&(d=c.children=[]),0===a&&i?i.push(c):(t[a]||(t[a]=[]),t[a].push(c)),n.zIndex.children.forEach(function(t){e(r,t,d)})}var n={};return e(n,t),n}(t),e(n),i}function a(t){var e;if("string"==typeof n.renderer&&h.Renderer[t]!==o)e=h.Renderer[t](n);else{if("function"!=typeof t)throw new Error("Unknown renderer");e=t(n)}if("function"!=typeof e)throw new Error("Invalid renderer defined");return e}return a(n.renderer)(t,n,e,i(t.stack),h)},h.Util.Support=function(t,e){function n(){var t=new Image,n=e.createElement("canvas"),i=n.getContext===o?!1:n.getContext("2d");if(i===!1)return!1;n.width=n.height=10,t.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{i.drawImage(t,0,0),n.toDataURL()}catch(a){return!1}return h.Util.log("html2canvas: Parse: SVG powered rendering available"),!0}function i(){var t,o,n,i,a=!1;return e.createRange&&(t=e.createRange(),t.getBoundingClientRect&&(o=e.createElement("boundtest"),o.style.height="123px",o.style.display="block",e.body.appendChild(o),t.selectNode(o),n=t.getBoundingClientRect(),i=n.height,123===i&&(a=!0),e.body.removeChild(o))),a}return{rangeBounds:i(),svgRendering:t.svgRendering&&n()}},t.html2canvas=function(e,o){e=e.length?e:[e];var n,i,a={logging:!1,elements:e,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return a=h.Util.Extend(o,a),h.logging=a.logging,a.complete=function(t){("function"!=typeof a.onpreloaded||a.onpreloaded(t)!==!1)&&(n=h.Parse(t,a),("function"!=typeof a.onparsed||a.onparsed(n)!==!1)&&(i=h.Renderer(n,a),"function"==typeof a.onrendered&&a.onrendered(i)))},t.setTimeout(function(){h.Preload(a)},0),{render:function(t,e){return h.Renderer(t,h.Util.Extend(e,a))},parse:function(t,e){return h.Parse(t,h.Util.Extend(e,a))},preload:function(t){return h.Preload(h.Util.Extend(t,a))},log:h.Util.log}},t.html2canvas.log=h.Util.log,t.html2canvas.Renderer={Canvas:o},h.Renderer.Canvas=function(t){function n(t,e){t.beginPath(),e.forEach(function(e){t[e.name].apply(t,e.arguments)}),t.closePath()}function i(t){if(-1===s.indexOf(t.arguments[0].src)){c.drawImage(t.arguments[0],0,0);try{c.getImageData(0,0,1,1)}catch(e){return l=r.createElement("canvas"),c=l.getContext("2d"),!1}s.push(t.arguments[0].src)}return!0}function a(e,o){switch(o.type){case"variable":e[o.name]=o.arguments;break;case"function":switch(o.name){case"createPattern":if(o.arguments[0].width>0&&o.arguments[0].height>0)try{e.fillStyle=e.createPattern(o.arguments[0],"repeat")}catch(a){d.log("html2canvas: Renderer: Error creating pattern",a.message)}break;case"drawShape":n(e,o.arguments);break;case"drawImage":o.arguments[8]>0&&o.arguments[7]>0&&(!t.taintTest||t.taintTest&&i(o))&&e.drawImage.apply(e,o.arguments);break;default:e[o.name].apply(e,o.arguments)}}}t=t||{};var r=e,s=[],l=e.createElement("canvas"),c=l.getContext("2d"),d=h.Util,p=t.canvas||r.createElement("canvas");return function(t,e,n,i,r){var s,l,c,h=p.getContext("2d"),u=t.stack;return p.width=p.style.width=e.width||u.ctx.width,p.height=p.style.height=e.height||u.ctx.height,c=h.fillStyle,h.fillStyle=d.isTransparent(u.backgroundColor)&&e.background!==o?e.background:t.backgroundColor,h.fillRect(0,0,p.width,p.height),h.fillStyle=c,i.forEach(function(t){h.textBaseline="bottom",h.save(),t.transform.matrix&&(h.translate(t.transform.origin[0],t.transform.origin[1]),h.transform.apply(h,t.transform.matrix),h.translate(-t.transform.origin[0],-t.transform.origin[1])),t.clip&&(h.beginPath(),h.rect(t.clip.left,t.clip.top,t.clip.width,t.clip.height),h.clip()),t.ctx.storage&&t.ctx.storage.forEach(function(t){a(h,t)}),h.restore()}),d.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),1===e.elements.length&&"object"==typeof e.elements[0]&&"BODY"!==e.elements[0].nodeName?(l=r.Util.Bounds(e.elements[0]),s=n.createElement("canvas"),s.width=Math.ceil(l.width),s.height=Math.ceil(l.height),h=s.getContext("2d"),h.drawImage(p,l.left,l.top,l.width,l.height,0,0,l.width,l.height),p=null,s):p}}}(window,document),function(){"use strict";var t=function(t){this.options=_.extend({},{template:' <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">  <div class="locator {{ (noGenerate.controlsOpen) ? \'controls-open\' : \'controls-closed\' }}">  <section class="locator-display">  <div class="locator-map-wrapper">  <div class="locator-display-inner">  <div class="locator-map">  <div class="locator-map-attribution {{#options.embedAttribution}}enabled{{/}}">  {{#options.overrideAttribution}}  {{{ options.overrideAttribution }}}  {{/}}  {{^options.overrideAttribution}}  {{{ options.tilesets[options.tileset].attribution }}}  {{/}}  </div>  </div>   <div class="locator-map-help">  Move the marker by dragging the base.  {{#(options.tilesets[options.tileset] && options.tilesets[options.tileset].attribution)}}  Required attribution for this map:  <span class="attribution">{{{ options.tilesets[options.tileset].attribution }}}</span>  {{/()}}  </div>  </div>  </div>  </section>    <section class="locator-controls">  <div class="minor-controls">  <div class="toggle-controls" on-tap="toggle:\'noGenerate.controlsOpen\'"></div>   {{#options.markerToCenter}}  <button class="minor-button" on-tap="marker-to-center" title="Move marker to center of map"><i class="fa fa-compass"></i></button>  {{/}}   {{#options.centerToMarker}}  <button class="minor-button" on-tap="center-to-marker" title="Center map on marker"><i class="fa fa-plus-square-o"></i></button>  {{/}}   <button class="minor-button minor-generate" on-tap="generate" title="Generate"><i class="fa fa-download"></i></button>  </div>   <div class="locator-controls-wrapper">  <header>{{{ options.title }}}</header>   <div class="locator-input">  <div class="config-option">  <label>Marker label. Use <code>&lt;br&gt;</code> to make line breaks.</label>  <input type="text" placeholder="Marker label" value="{{ options.markerText }}" lazy>  </div>   {{^options.geocoder}}  <div class="config-option">  <label>Latitude and longitude location</label>   <br><input type="number" placeholder="Latitude" value="{{ options.lat }}" lazy>  <br><input type="number" placeholder="Longitude" value="{{ options.lng }}" lazy>  </div>  {{/options.geocoder}}   {{#options.geocoder}}  <div class="config-option">  <label>Search location by address</label>  <input type="text" placeholder="Address or place" value="{{ geocodeInput }}" lazy disabled="{{ isGeocoding }}">  </div>  {{/options.geocoder}}   {{#(_.size(options.tilesets) > 1)}}  <div class="config-option">  <label>Background map set</label>   <div class="image-picker images-{{ _.size(options.tilesets) }}">  {{#options.tilesets:i}}  <div class="image-picker-item {{ (options.tileset === i) ? \'active\' : \'\' }}" style="background-image: url({{= preview }});" title="{{ i }}" on-tap="set:\'options.tileset\',{{ i }}"></div>  {{/options.tilesets}}  </div>  </div>  {{/()}}   {{#options.markerToCenter}}  <div class="config-option config-button">  <button on-tap="marker-to-center"><i class="fa fa-compass"></i></button>  <label>Move marker to center of map</label>  </div>  {{/}}   {{#options.centerToMarker}}  <div class="config-option config-button">  <button on-tap="center-to-marker"><i class="fa fa-plus-square-o"></i></button>  <label>Center map on marker</label>  </div>  {{/}}   {{#(_.size(options.widths) > 1)}}  <div class="config-option config-select">  <label>Map width</label>   <select value="{{ options.width }}">  {{#options.widths:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.widths}}  </select>  </div>  {{/()}}   {{#(_.size(options.ratios) > 1)}}  <div class="config-option config-select">  <label>Map aspect ratio</label>   <select value="{{ options.ratio }}">  {{#options.ratios:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.ratios}}  </select>  </div>  {{/()}}   <div class="config-option">  <label>Mini-map zoom</label>   <input type="range" min="-10" max="1" value="{{ options.miniZoomOffset }}" title="Adjust zoom level for map">  </div>    <div class="config-option">  <input type="checkbox" checked="{{ options.embedAttribution }}" id="config-embed-attribution" lazy>  <label for="config-embed-attribution">Embed attribution</label>   <input type="text" placeholder="Override attribution" value="{{ options.overrideAttribution }}" lazy>  </div>   <div class="config-action">  <button class="generate-image" on-tap="generate">Generate <i class="fa fa-download"></i></button>  </div>   <div class="preview">  <h1>Preview</h1>  <img src="" /><br>  <a href="" class="download-link">Download</a>  </div>  </div>   <footer>  {{{ options.footer }}}  </footer>  </div>  </section> </div> ',title:"Locator",footer:'Made by the <a href="http://datanews.tumblr.com/" target="_blank">WNYC DataNews</a> team.  Locator only works in <a href="http://google.com/chrome" target="_blank">Chrome</a>.',tilesets:{"CartoDB Positron":{url:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a target="_blank" href="http://cartodb.com/attributions">CartoDB</a>'},"Stamen Toner":{url:"http://tile.stamen.com/toner/{z}/{x}/{y}.png",attribution:'Map tiles by <a target="_blank" href="http://stamen.com">Stamen Design</a>, under <a  target="_blank" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a  target="_blank" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_blank" href="http://www.openstreetmap.org/copyright">ODbL</a>'},"Mapbox Streets (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.np44bm6o/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>"},"Mapbox Satellite (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.oee0fah0/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>; &copy; <a target='_blank' href='https://www.digitalglobe.com/'>DigitalGlobe</a>"},"Mapbox Run, Bike, Hike (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.oee1c53c/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>"}},tileset:"CartoDB Positron",zoom:17,lat:40.74844,lng:-73.98566,minZoom:1,maxZoom:18,embedAttribution:!1,overrideAttribution:void 0,miniWidth:"15w",miniHeight:"15w",miniZoomOffset:-6,miniExtentStyles:{fill:!1,stroke:!0,color:"#000000",opacity:.9,weight:4},miniStyles:{backgroundColor:"#FFFFFF",padding:3,shadow:!0,shadowColor:"rgba(0, 0, 0, 0.65)",shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1},markerText:"Empire State Building",markerBackground:"rgba(0, 0, 0, 0.9)",markerForeground:"rgba(255, 255, 255, 0.9)",markerRadius:5,markerFontSize:16,markerFont:'"Open Sans", Helvetica, Arial, sans-serif',markerLabelDistance:20,markerLabelWidth:3,markerPadding:10,draggableMarker:L.icon({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wwLFSU1meAbBQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACOUlEQVR42u3bP0sjQRjH8W8S/wYVFEFR1LOxMaSxsrKQlPcaBH1bCvcSvMrCQhAsbE5FwcZ/hVUQQcQ7CLheMSPYqjOzzyS/DyzpdnZ/u5k8s/sERERERERERERERERERERERERERERExJCKkeOoA7PAFDANjABjQD/QAZ791vbbPfDS6wH2AfPAug/rsx6AI+AWeO2lAKtAA2gF3Oc+cAEU3R7gOLAZad9vwC/gsVsDbAHNBONcA7vdFuAGMJnwYj0B2ykGqiUYYwuYSDxVDPl59iT3ADdKCO/dIPADOM81wBawWHKZNuqDvItZUsT6tW1iwwowl1OA1Yilylf9zCnAhsEl6zCwlkOAfYFXGCE1cwhwHrsGYoQYOsB1bFu1HGCdrz1VSaluOcBZ7KsCC1YDnCIPy1YDnM4kwCWrAY7Qg0IGONaD5xx0Z/2ZBFixGmAnkwDfrAb4nEmAhQLs0juwnUmAVwrwey6tBnifyfx3YzXAF1y7hWV/TReVuF4Vy46tB3hrOLwOcGo9wFdco49FZ+bXhd5F6ForgH/AYS4BFrguKUv2Yu041ov1R1yXlAV/Ys7N1YgHvovrkipTGziIOUAtwdVv4PpTypj3dmIPkqK97QTXJTWa+M7bSTFQLdEJnfu7cCbRnPc71ZVK3SM9h2v0GY70ld1LXcyX9TeHNVybxUCgFcZZrDrPaoDvmrh2i/onK4LCPxg4jrE8yynAjxZwL72XPpRYFb+qKfznFe553g0iAvwHgeJXccwK1poAAAAASUVORK5CYII=",iconSize:[80,80],iconAnchor:[40,55],popupAnchor:[-75,0]}),widths:{Small:400,Medium:600,Large:800},width:"Medium",ratios:{"1:1":1,"4:3":4/3,"16:9":16/9},ratio:"4:3",controlsOpen:!0,centerToMarker:!0,markerToCenter:!0,geocoder:this.defaultGeocoder},t),this.id=_.uniqueId("locator-"),this.el=this.options.el,this.options.tilesets=this.parseTilesets(this.options.tilesets),this.drawInterface()};_.extend(t.prototype,{drawInterface:function(){var t=_.clone(this.options),e={controlsOpen:this.options.controlsOpen};this["interface"]=new Ractive({el:this.options.el,template:this.options.template,data:{options:this.options,noGenerate:e,isGeocoding:!1,geocodeInput:"",_:_}}),this["interface"].on("generate",_.bind(this.generate,this)),this.throttledDrawMaps=_.throttle(_.bind(this.drawMaps,this),1500),_.isFunction(this.options.geocoder)&&(this.throttledGeocoder=_.throttle(_.bind(this.options.geocoder,this),1500)),this["interface"].observe("options",_.bind(function(e){var o=e.lat!==t.lat||e.lng!==t.lng;this.throttledDrawMaps(o),t=_.clone(e)},this),{init:!1}),this["interface"].observe("geocodeInput",_.bind(function(t){_.isFunction(this.throttledGeocoder)&&this.throttledGeocoder(t,_.bind(function(t,e){this.options.lat=t,this.options.lng=e,this.throttledDrawMaps(!0)},this))},this),{init:!1}),this["interface"].observe("options.overrideAttribution",function(t){var e=this.get("options.embedAttribution");t&&!e&&this.set("options.embedAttribution",!0)},{init:!0}),this["interface"].on("toggle",function(t,e){this.set(e,!this.get(e))}),this["interface"].on("set",function(t,e,o){this.set(e,o)}),this["interface"].on("marker-to-center",_.bind(function(){var t=this.map.getCenter();this.options.lat=t.lat,this.options.lng=t.lng,this["interface"].update()},this)),this["interface"].on("center-to-marker",_.bind(function(){this.map.setView([this.options.lat,this.options.lng])},this)),this.drawMaps()},drawMaps:function(t){this.alterOptions("preDraw"),this.drawMap(t),this.drawMarker(),this.drawMinimap(),this.fixMapVerticalAlign()},alterOptions:function(t){_.isFunction(this.options[t])&&_.bind(this.options[t],this)(this.options)},drawMap:function(t){t=t||!1;var e,o,n,i=this.getEl(".locator-map");i.id=this.id+"-map",n=[this.options.lat,this.options.lng,this.options.zoom],this.map&&!t?(n[0]=this.map.getCenter().lat,n[1]=this.map.getCenter().lng,n[2]=this.map.getZoom(),this.map.remove()):this.map&&this.map.remove(),e=_.size(this.options.widths)?this.options.widths[this.options.width]:_.isNumber(this.options.width)?this.options.width:i.getBoundingClientRect().width,o=_.size(this.options.ratios)?e/this.options.ratios[this.options.ratio]:_.isNumber(this.options.ratio)?e/this.options.ratio:i.getBoundingClientRect().height,i.style.width=e+"px",i.style.height=o+"px",this.map=new L.Map(i.id,{minZoom:this.options.minZoom,maxZoom:this.options.maxZoom,attributionControl:!1}),this.map.setView([n[0],n[1]],n[2]),this.mapLayer=new L.TileLayer(this.options.tilesets[this.options.tileset].url),this.map.addLayer(this.mapLayer)},drawMinimap:function(){var t,e=this.getEl(".locator-map").getBoundingClientRect().width,o=this.getEl(".locator-map").getBoundingClientRect().height,n=_.isNumber(this.options.miniWidth)?this.options.miniWidth:-1!==this.options.miniWidth.indexOf("w")?+this.options.miniWidth.replace("w","")/100*e:+this.options.miniWidth.replace("h","")/100*o,i=_.isNumber(this.options.miniHeight)?this.options.miniHeight:-1!==this.options.miniHeight.indexOf("w")?+this.options.miniHeight.replace("w","")/100*e:+this.options.miniHeight.replace("h","")/100*o;this.minimapLayer=new L.TileLayer(this.options.tilesets[this.options.tileset].url),this.miniMap=new L.Control.MiniMap(this.minimapLayer,{width:n,height:i,zoomLevelOffset:this.options.miniZoomOffset,aimingRectOptions:{fill:!1,stroke:!1}}),this.map.addControl(this.miniMap),this.miniMap._miniMap.addLayer(this.drawMiniCanvasLayer(this.options.miniExtentStyles)),t=this.getEl(".locator-map .leaflet-control-minimap"),_.each(this.miniStylesToCSS(this.options.miniStyles),function(e,o){t.style[o]=e})},drawMiniCanvasLayer:function(t){return this.miniCanvasLayer=L.tileLayer.canvas(),this.miniCanvasLayer.drawTile=_.bind(function(e,o,n){var i=e.getContext("2d");i.clearRect(0,0,e.width,e.height);var a={};a.nwPoint=o.multiplyBy(256),a.sePoint=a.nwPoint.add(new L.Point(256,256)),a.nwCoord=this.map.unproject(a.nwPoint,n,!0),a.seCoord=this.map.unproject(a.sePoint,n,!0),a.bCoord=L.latLngBounds([[a.nwCoord.lat,a.seCoord.lng],[a.seCoord.lat,a.nwCoord.lng]]),a.bPoint=[a.nwPoint,a.sePoint];var r=this.map.getBounds(),s=this.map.project(r.getNorthWest(),n,!0),l=this.map.project(r.getSouthEast(),n,!0);i.beginPath(),i.rect(s.x-a.nwPoint.x,s.y-a.nwPoint.y,l.x-s.x,l.y-s.y),i=this.leafletStylesToCanvas(t,i),i.closePath()},this),this.map.on("moveend",_.bind(function(){this.miniCanvasLayer.redraw()},this)),this.miniCanvasLayer},drawMarker:function(){this.markerCanvas&&this.map&&this.map.removeLayer(this.markerCanvas),this.markerCanvas=L.tileLayer.canvas(),this.markerCanvas.drawTile=_.bind(this.drawMarkerTile,this),this.markerCanvas.addTo(this.map),this.draggableMarker&&this.map&&this.map.removeLayer(this.draggableMarker),this.draggableMarker=L.marker(L.latLng(this.options.lat,this.options.lng),{icon:this.options.draggableMarker,draggable:!0,opacity:0,title:"Drag marker here"}).addTo(this.map),this.draggableMarker.on("dragstart",function(t){t.target.setOpacity(1)}),this.draggableMarker.on("dragend",_.bind(function(t){t.target.setOpacity(0);var e=t.target.getLatLng();this.options.lat=e.lat,this.options.lng=e.lng,this.drawMarker()},this))},drawMarkerTile:function(t,e,o){var n,i,a,r=t.getContext("2d"),s=this.options.markerText.split("<br>");s=_.map(s,function(t){return t.trim()});var l=s.length,c=1.25,d=this.options.markerFontSize*c*l+2*this.options.markerPadding;r.clearRect(0,0,t.width,t.height);var h={};h.nwPoint=e.multiplyBy(256),h.sePoint=h.nwPoint.add(new L.Point(256,256)),h.nwCoord=this.map.unproject(h.nwPoint,o,!0),h.seCoord=this.map.unproject(h.sePoint,o,!0),h.bCoord=L.latLngBounds([[h.nwCoord.lat,h.seCoord.lng],[h.seCoord.lat,h.nwCoord.lng]]),h.bPoint=[h.nwPoint,h.sePoint],h.locCoord=L.latLng(this.options.lat,this.options.lng),h.locPoint=this.map.project(h.locCoord,o,!0),n={x:h.locPoint.x-h.nwPoint.x,y:h.locPoint.y-h.nwPoint.y},r.beginPath(),r.translate(n.x-this.options.markerRadius,n.y-this.options.markerRadius),r.fillStyle=this.options.markerBackground,r.fillRect(0,0,2*this.options.markerRadius,2*this.options.markerRadius),r.setTransform(1,0,0,1,0,0),r.closePath(),r.beginPath(),r.translate(n.x-this.options.markerLabelWidth/2,n.y-this.options.markerRadius-this.options.markerLabelDistance),r.fillStyle=this.options.markerBackground,r.fillRect(0,0,this.options.markerLabelWidth,this.options.markerLabelDistance),r.setTransform(1,0,0,1,0,0),r.closePath(),r.beginPath(),r.font=this.options.markerFontSize+"px "+this.options.markerFont,r.fillStyle=this.options.markerForeground,r.textAlign="center",i=_.max(s,function(t){return r.measureText(t).width}),i=r.measureText(i).width,a=i+2*this.options.markerPadding,r.closePath(),r.beginPath(),r.translate(n.x-a/2,n.y-this.options.markerRadius-this.options.markerLabelDistance-d),r.fillStyle=this.options.markerBackground,r.fillRect(0,0,a,d),r.setTransform(1,0,0,1,0,0),r.closePath(),_.each(s,_.bind(function(t,e){var o=1;r.beginPath(),r.translate(n.x,n.y-this.options.markerRadius-this.options.markerLabelDistance-d+this.options.markerPadding+o+this.options.markerFontSize*c*e),r.font=this.options.markerFontSize+"px "+this.options.markerFont,r.fillStyle=this.options.markerForeground,r.textAlign="center",r.textBaseline="top",r.fillText(t,0,0),r.setTransform(1,0,0,1,0,0),r.closePath()},this))},generate:function(){this.getEl(".locator-map .leaflet-control-zoom").style.display="none",this.getEl(".locator-map .leaflet-control-minimap").style.display="none",html2canvas(this.getEl(".locator-map"),{useCORS:!0,onrendered:_.bind(function(t){this.getEl(".locator-map .leaflet-control-zoom").style.display="block",this.getEl(".locator-map .leaflet-control-minimap").style.display="block",html2canvas(this.getEl(".locator-map .leaflet-control-minimap"),{useCORS:!0,onrendered:_.bind(function(e){var o=this.drawCanvasMiniMap(t,e);this.preview(o),this["export"](o)},this)})},this)})},drawCanvasMiniMap:function(t,e){var o=t.getContext("2d"),n=this.getEl(".locator-map .leaflet-control-minimap"),i=n.getBoundingClientRect().width,a=n.getBoundingClientRect().height,r=this.options.miniStyles,s=10,l=10;return o.beginPath(),o.fillStyle=r.backgroundColor,r.shadow&&(o.shadowColor=r.shadowColor,o.shadowBlur=r.shadowBlur,o.shadowOffsetX=r.shadowOffsetX,o.shadowOffsetY=r.shadowOffsetY),o.fillRect(o.canvas.width-s-i-2*r.padding,o.canvas.height-l-a-2*r.padding,i+2*r.padding,a+2*r.padding),o.closePath(),o.beginPath(),o.shadowColor=0,o.shadowBlur=0,o.shadowOffsetX=0,o.shadowOffsetY=0,o.drawImage(e,o.canvas.width-s-i-r.padding,o.canvas.height-l-a-r.padding,i,a),o.closePath(),o},preview:function(t){this.getEl(".preview img").src=t.canvas.toDataURL()},"export":function(t){var e=this.getEl(".download-link");e.href=t.canvas.toDataURL(),e.download=this.makeID(this.options.markerText)+".png",e.click()},getEl:function(t){return document.querySelector(this.el+" "+t)},miniStylesToCSS:function(t){var e={"background-color":t.backgroundColor,border:t.padding+"px solid "+t.backgroundColor};return t.shadow&&(e["box-shadow"]=t.shadowOffsetX+"px "+t.shadowOffsetY+"px "+t.shadowBlur+"px "+t.shadowColor),e},leafletStylesToCanvas:function(t,e){return t.fill&&(e.globalAlpha=t.fillOpacity||1,e.fillStyle=t.fillColor||t.color,e.fill(t.fillRule||"evenodd")),t.stroke&&0!==t.weight&&(e.globalAlpha=t.opacity||1,e.strokeStyle=t.color,e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.stroke()),e},defaultGeocoder:function(t,e){var o=new XMLHttpRequest,n="https://maps.googleapis.com/maps/api/geocode/json?address="+encodeURIComponent(t),i=_.once(e);o.onreadystatechange=function(){var t;200===o.status&&o.responseText&&(t=JSON.parse(o.responseText),t&&t.results&&t.results.length&&i(t.results[0].geometry.location.lat,t.results[0].geometry.location.lng))},o.open("GET",n),o.send()},parseTilesets:function(t){return _.each(t,function(e,o){_.isString(e)&&(t[o]={url:e}),t[o].preview||(t[o].preview=t[o].url.replace("{s}","a").replace("{x}","301").replace("{y}","385").replace("{z}","10"))}),t},makeID:function(t){return t=t.toString(),t=t.toLowerCase().trim().replace(/\W+/g,"-"),t=t?t:"locator",_.uniqueId(t+"-")},overflowed:function(t,e){return e?"y"===e?t.scrollHeight>t.clientHeight:"x"===e?t.scrollWidth>t.clientWidth:!1:t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth},fixMapVerticalAlign:function(){var t=this.getEl(".locator-display");this.overflowed(t,"y")?t.classList.add("overflowed-y"):t.classList.remove("overflowed-y")}}),window.Locator=t}();