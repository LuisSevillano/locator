/**
 * locator - In browser locator map generator
 * @version v0.0.1
 * @link https://github.com/datanews/locator#readme
 * @license MIT
 * @notes External libraries may be bundled here and their respective, original license applies.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ractive=e()}(this,function(){"use strict";function t(t){var e;if(t&&"boolean"!=typeof t)return"undefined"!=typeof window&&document&&t?t.nodeType?t:"string"==typeof t&&(e=document.getElementById(t),!e&&document.querySelector&&(e=document.querySelector(t)),e&&e.nodeType)?e:t[0]&&t[0].nodeType?t[0]:null:null}function e(t){return t&&"unknown"!=typeof t.parentNode&&t.parentNode&&t.parentNode.removeChild(t),t}function n(t){return null!=t&&t.toString?t:""}function i(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];for(var o,r;r=n.shift();)for(o in r)Ta.call(r,o)&&(t[o]=r[o]);return t}function o(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return n.forEach(function(e){for(var n in e)!e.hasOwnProperty(n)||n in t||(t[n]=e[n])}),t}function r(t){return"[object Array]"===Ma.call(t)}function s(t){return Sa.test(Ma.call(t))}function a(t,e){return null===t&&null===e?!0:"object"==typeof t||"object"==typeof e?!1:t===e}function h(t){return!isNaN(parseFloat(t))&&isFinite(t)}function l(t){return t&&"[object Object]"===Ma.call(t)}function u(t,e){return t.replace(/%s/g,function(){return e.shift()})}function c(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];throw t=u(t,n),new Error(t)}function d(){Gy.DEBUG&&Ea.apply(null,arguments)}function p(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];t=u(t,n),ka(t,n)}function f(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];t=u(t,n),Da[t]||(Da[t]=!0,ka(t,n))}function m(){Gy.DEBUG&&p.apply(null,arguments)}function g(){Gy.DEBUG&&f.apply(null,arguments)}function v(t,e,n){var i=_(t,e,n);return i?i[t][n]:null}function _(t,e,n){for(;e;){if(n in e[t])return e;if(e.isolated)return null;e=e.parent}}function y(t){return function(){return t}}function w(t){var e,n,i,o,r,s;for(e=t.split("."),(n=ja[e.length])||(n=b(e.length)),r=[],i=function(t,n){return t?"*":e[n]},o=n.length;o--;)s=n[o].map(i).join("."),r.hasOwnProperty(s)||(r.push(s),r[s]=!0);return r}function b(t){var e,n,i,o,r,s,a,h,l="";if(!ja[t]){for(i=[];l.length<t;)l+=1;for(e=parseInt(l,2),o=function(t){return"1"===t},r=0;e>=r;r+=1){for(n=r.toString(2);n.length<t;)n="0"+n;for(h=[],a=n.length,s=0;a>s;s++)h.push(o(n[s]));i[r]=h}ja[t]=i}return ja[t]}function x(t,e,n,i){var o=t[e];if(!o||!o.equalsOrStartsWith(i)&&o.equalsOrStartsWith(n))return t[e]=o?o.replace(n,i):i,!0}function L(t){var e=t.slice(2);return"i"===t[1]&&h(e)?+e:e}function P(t){return null==t?t:(Va.hasOwnProperty(t)||(Va[t]=new Ha(t)),Va[t])}function E(t,e){function n(e,n){var i,o,s;return n.isRoot?s=[].concat(Object.keys(t.viewmodel.data),Object.keys(t.viewmodel.mappings),Object.keys(t.viewmodel.computations)):(i=t.viewmodel.wrapped[n.str],o=i?i.get():t.viewmodel.get(n),s=o?Object.keys(o):null),s&&s.forEach(function(t){"_ractive"===t&&r(o)||e.push(n.join(t))}),e}var i,o,s;for(i=e.str.split("."),s=[qa];o=i.shift();)"*"===o?s=s.reduce(n,[]):s[0]===qa?s[0]=P(o):s=s.map(k(o));return s}function k(t){return function(e){return e.join(t)}}function C(t){return t?t.replace(Za,".$1"):""}function T(t,e,n){if("string"!=typeof e||!h(n))throw new Error("Bad arguments");var i=void 0,o=void 0;if(/\*/.test(e))return o={},E(t,P(C(e))).forEach(function(e){var i=t.viewmodel.get(e);if(!h(i))throw new Error(Ka);o[e.str]=i+n}),t.set(o);if(i=t.get(e),!h(i))throw new Error(Ka);return t.set(e,+i+n)}function M(t,e){return $a(this,t,void 0===e?1:+e)}function S(t){this.event=t,this.method="on"+t,this.deprecate=th[t]}function A(t,e){var n=t.indexOf(e);-1===n&&t.push(e)}function D(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]==e)return!0;return!1}function O(t,e){var n;if(!r(t)||!r(e))return!1;if(t.length!==e.length)return!1;for(n=t.length;n--;)if(t[n]!==e[n])return!1;return!0}function R(t){return"string"==typeof t?[t]:void 0===t?[]:t}function I(t){return t[t.length-1]}function B(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}function z(t){for(var e=[],n=t.length;n--;)e[n]=t[n];return e}function U(t){setTimeout(t,0)}function N(t,e){return function(){for(var n;n=t.shift();)n(e)}}function F(t,e,n,i){var o;if(e===t)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(e instanceof eh)e.then(n,i);else if(!e||"object"!=typeof e&&"function"!=typeof e)n(e);else{try{o=e.then}catch(r){return void i(r)}if("function"==typeof o){var s,a,h;a=function(e){s||(s=!0,F(t,e,n,i))},h=function(t){s||(s=!0,i(t))};try{o.call(e,a,h)}catch(r){if(!s)return i(r),void(s=!0)}}else n(e)}}function j(t,e,n){var i;return e=C(e),"~/"===e.substr(0,2)?(i=P(e.substring(2)),V(t,i.firstKey,n)):"."===e[0]?(i=Z(ah(n),e),i&&V(t,i.firstKey,n)):i=W(t,P(e),n),i}function Z(t,e){var n;if(void 0!=t&&"string"!=typeof t&&(t=t.str),"."===e)return P(t);if(n=t?t.split("."):[],"../"===e.substr(0,3)){for(;"../"===e.substr(0,3);){if(!n.length)throw new Error('Could not resolve reference - too many "../" prefixes');n.pop(),e=e.substring(3)}return n.push(e),P(n.join("."))}return P(t?t+e.replace(/^\.\//,"."):e.replace(/^\.\/?/,""))}function W(t,e,n,i){var o,r,s,a,h;if(e.isRoot)return e;for(r=e.firstKey;n;)if(o=n.context,n=n.parent,o&&(a=!0,s=t.viewmodel.get(o),s&&("object"==typeof s||"function"==typeof s)&&r in s))return o.join(e.str);return H(t.viewmodel,r)?e:t.parent&&!t.isolated&&(a=!0,n=t.component.parentFragment,r=P(r),h=W(t.parent,r,n,!0))?(t.viewmodel.map(r,{origin:t.parent.viewmodel,keypath:h}),e):i||a?void 0:(t.viewmodel.set(e,void 0),e)}function V(t,e){var n;!t.parent||t.isolated||H(t.viewmodel,e)||(e=P(e),(n=W(t.parent,e,t.component.parentFragment,!0))&&t.viewmodel.map(e,{origin:t.parent.viewmodel,keypath:n}))}function H(t,e){return""===e||e in t.data||e in t.computations||e in t.mappings}function G(t){t.teardown()}function q(t){t.unbind()}function $(t){t.unrender()}function K(t){t.cancel()}function J(t){t.detach()}function Y(t){t.detachNodes()}function Q(t){!t.ready||t.outros.length||t.outroChildren||(t.outrosComplete||(t.parent?t.parent.decrementOutros(t):t.detachNodes(),t.outrosComplete=!0),t.intros.length||t.totalChildren||("function"==typeof t.callback&&t.callback(),t.parent&&t.parent.decrementTotal()))}function X(){for(var t,e,n;uh.ractives.length;)e=uh.ractives.pop(),n=e.viewmodel.applyChanges(),n&&fh.fire(e,n);for(tt(),t=0;t<uh.views.length;t+=1)uh.views[t].update();for(uh.views.length=0,t=0;t<uh.tasks.length;t+=1)uh.tasks[t]();return uh.tasks.length=0,uh.ractives.length?X():void 0}function tt(){var t,e,n,i;for(t=ph.length;t--;)e=ph[t],e.keypath?ph.splice(t,1):(n=hh(e.root,e.ref,e.parentFragment))&&((i||(i=[])).push({item:e,keypath:n}),ph.splice(t,1));i&&i.forEach(et)}function et(t){t.item.resolve(t.keypath)}function nt(t,e,n){var i,o,r,s,a,h,l,u,c,d,p,f,m,g;if(i=new sh(function(t){return o=t}),"object"==typeof t){n=e||{},h=n.easing,l=n.duration,a=[],u=n.step,c=n.complete,(u||c)&&(p={},n.step=null,n.complete=null,d=function(t){return function(e,n){p[t]=n}});for(r in t)t.hasOwnProperty(r)&&((u||c)&&(f=d(r),n={easing:h,duration:l},u&&(n.step=f)),n.complete=c?f:Aa,a.push(it(this,r,t[r],n)));return g={easing:h,duration:l},u&&(g.step=function(t){return u(t,p)}),c&&i.then(function(t){return c(t,p)}),g.complete=o,m=it(this,null,null,g),a.push(m),i.stop=function(){for(var t;t=a.pop();)t.stop();m&&m.stop()},i}return n=n||{},n.complete&&i.then(n.complete),n.complete=o,s=it(this,t,e,n),i.stop=function(){return s.stop()},i}function it(t,e,n,i){var o,r,s,h;return e&&(e=P(C(e))),null!==e&&(h=t.viewmodel.get(e)),_h.abort(e,t),a(h,n)?(i.complete&&i.complete(i.to),xh):(i.easing&&(o="function"==typeof i.easing?i.easing:t.easing[i.easing],"function"!=typeof o&&(o=null)),r=void 0===i.duration?400:i.duration,s=new wh({keypath:e,from:h,to:n,root:t,duration:r,easing:o,interpolator:i.interpolator,step:i.step,complete:i.complete}),_h.add(s),t._animations.push(s),s)}function ot(){return this.detached?this.detached:(this.el&&B(this.el.__ractive_instances__,this),this.detached=this.fragment.detach(),Ph.fire(this),this.detached)}function rt(t){return this.el?this.fragment.find(t):null}function st(t,e){var n;return n=this._isComponentQuery?!this.selector||t.name===this.selector:t.node?da(t.node,this.selector):null,n?(this.push(t.node||t.instance),e||this._makeDirty(),!0):void 0}function at(t){var e;return(e=t.parentFragment)?e.owner:t.component&&(e=t.component.parentFragment)?e.owner:void 0}function ht(t){var e,n;for(e=[t],n=at(t);n;)e.push(n),n=at(n);return e}function lt(t,e,n,i){var o=[];return xa(o,{selector:{value:e},live:{value:n},_isComponentQuery:{value:i},_test:{value:kh}}),n?(xa(o,{cancel:{value:Ch},_root:{value:t},_sort:{value:Sh},_makeDirty:{value:Ah},_remove:{value:Dh},_dirty:{value:!1,writable:!0}}),o):o}function ut(t,e){var n,i;return this.el?(e=e||{},n=this._liveQueries,(i=n[t])?e&&e.live?i:i.slice():(i=Oh(this,t,!!e.live,!1),i.live&&(n.push(t),n["_"+t]=i),this.fragment.findAll(t,i),i)):[]}function ct(t,e){var n,i;return e=e||{},n=this._liveComponentQueries,(i=n[t])?e&&e.live?i:i.slice():(i=Oh(this,t,!!e.live,!0),i.live&&(n.push(t),n["_"+t]=i),this.fragment.findAllComponents(t,i),i)}function dt(t){return this.fragment.findComponent(t)}function pt(t){return this.container?this.container.component&&this.container.component.name===t?this.container:this.container.findContainer(t):null}function ft(t){return this.parent?this.parent.component&&this.parent.component.name===t?this.parent:this.parent.findParent(t):null}function mt(t,e){var n=void 0===arguments[2]?{}:arguments[2];if(e){n.event?n.event.name=e:n.event={name:e,_noArg:!0};var i=P(e).wildcardMatches();gt(t,i,n.event,n.args,!0)}}function gt(t,e,n,i){var o,r,s=void 0===arguments[4]?!1:arguments[4],a=!0;for(Fh.enqueue(t,n),r=e.length;r>=0;r--)o=t._subs[e[r]],o&&(a=vt(t,o,n,i)&&a);if(Fh.dequeue(t),t.parent&&a){if(s&&t.component){var h=t.component.name+"."+e[e.length-1];e=P(h).wildcardMatches(),n&&(n.component=t)}gt(t.parent,e,n,i)}}function vt(t,e,n,i){var o=null,r=!1;n&&!n._noArg&&(i=[n].concat(i)),e=e.slice();for(var s=0,a=e.length;a>s;s+=1)e[s].apply(t,i)===!1&&(r=!0);return n&&!n._noArg&&r&&(o=n.original)&&(o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()),!r}function _t(t){var e={args:Array.prototype.slice.call(arguments,1)};jh(this,t,e)}function yt(t){var e;return t=P(C(t)),e=this.viewmodel.get(t,Vh),void 0===e&&this.parent&&!this.isolated&&hh(this,t.str,this.component.parentFragment)&&(e=this.viewmodel.get(t)),e}function wt(e,n){if(!this.fragment.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(e=t(e),n=t(n)||null,!e)throw new Error("You must specify a valid target to insert into");e.insertBefore(this.detach(),n),this.el=e,(e.__ractive_instances__||(e.__ractive_instances__=[])).push(this),this.detached=null,bt(this)}function bt(t){Gh.fire(t),t.findAllComponents("*").forEach(function(t){bt(t.instance)})}function xt(t,e,n){var i,o;return t=P(C(t)),i=this.viewmodel.get(t),r(i)&&r(e)?(o=mh.start(this,!0),this.viewmodel.merge(t,i,e,n),mh.end(),o):this.set(t,e,n&&n.complete)}function Lt(t,e){var n,i;return n=E(t,e),i={},n.forEach(function(e){i[e.str]=t.get(e.str)}),i}function Pt(t,e,n,i){var o,r,s;e=P(C(e)),i=i||al,e.isPattern?(o=new rl(t,e,n,i),t.viewmodel.patternObservers.push(o),r=!0):o=new Jh(t,e,n,i),o.init(i.init),t.viewmodel.register(e,o,r?"patternObservers":"observers"),o.ready=!0;var a={cancel:function(){var n;s||(r?(n=t.viewmodel.patternObservers.indexOf(o),t.viewmodel.patternObservers.splice(n,1),t.viewmodel.unregister(e,o,"patternObservers")):t.viewmodel.unregister(e,o,"observers"),s=!0)}};return t._observers.push(a),a}function Et(t,e,n){var i,o,r,s;if(l(t)){n=e,o=t,i=[];for(t in o)o.hasOwnProperty(t)&&(e=o[t],i.push(this.observe(t,e,n)));return{cancel:function(){for(;i.length;)i.pop().cancel()}}}if("function"==typeof t)return n=e,e=t,t="",sl(this,t,e,n);if(r=t.split(" "),1===r.length)return sl(this,t,e,n);for(i=[],s=r.length;s--;)t=r[s],t&&i.push(sl(this,t,e,n));return{cancel:function(){for(;i.length;)i.pop().cancel()}}}function kt(t,e,n){var i=this.observe(t,function(){e.apply(this,arguments),i.cancel()},{init:!1,defer:n&&n.defer});return i}function Ct(t,e){var n,i=this;if(t)n=t.split(" ").map(ul).filter(cl),n.forEach(function(t){var n,o;(n=i._subs[t])&&(e?(o=n.indexOf(e),-1!==o&&n.splice(o,1)):i._subs[t]=[])});else for(t in this._subs)delete this._subs[t];return this}function Tt(t,e){var n,i,o,r=this;if("object"==typeof t){n=[];for(i in t)t.hasOwnProperty(i)&&n.push(this.on(i,t[i]));return{cancel:function(){for(var t;t=n.pop();)t.cancel()}}}return o=t.split(" ").map(ul).filter(cl),o.forEach(function(t){(r._subs[t]||(r._subs[t]=[])).push(e)}),{cancel:function(){return r.off(t,e)}}}function Mt(t,e){var n=this.on(t,function(){e.apply(this,arguments),n.cancel()});return n}function St(t,e,n){var i,o,r,s,a,h,l=[];if(i=At(t,e,n),!i)return null;for(o=t.length,a=i.length-2-i[1],r=Math.min(o,i[0]),s=r+i[1],h=0;r>h;h+=1)l.push(h);for(;s>h;h+=1)l.push(-1);for(;o>h;h+=1)l.push(h+a);return 0!==a?l.touchedFrom=i[0]:l.touchedFrom=t.length,l}function At(t,e,n){switch(e){case"splice":for(void 0!==n[0]&&n[0]<0&&(n[0]=t.length+Math.max(n[0],-t.length));n.length<2;)n.push(0);return n[1]=Math.min(n[1],t.length-n[0]),n;case"sort":case"reverse":return null;case"pop":return t.length?[t.length-1,1]:[0,0];case"push":return[t.length,0].concat(n);case"shift":return[0,t.length?1:0];case"unshift":return[0,0].concat(n)}}function Dt(e,n){var i,o,r,s=this;if(r=this.transitionsEnabled,this.noIntro&&(this.transitionsEnabled=!1),i=mh.start(this,!0),mh.scheduleTask(function(){return Cl.fire(s)},!0),this.fragment.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");if(e=t(e)||this.el,n=t(n)||this.anchor,this.el=e,this.anchor=n,!this.append&&e){var a=e.__ractive_instances__;a&&a.length&&Ot(a),e.innerHTML=""}return this.cssId&&El.apply(),e&&((o=e.__ractive_instances__)?o.push(this):e.__ractive_instances__=[this],n?e.insertBefore(this.fragment.render(),n):e.appendChild(this.fragment.render())),mh.end(),this.transitionsEnabled=r,i.then(function(){return Tl.fire(s)})}function Ot(t){t.splice(0,t.length).forEach(G)}function Rt(t,e){for(var n=t.slice(),i=e.length;i--;)~n.indexOf(e[i])||n.push(e[i]);return n}function It(t,e){var n,i,o;return i='[data-ractive-css~="{'+e+'}"]',o=function(t){var e,n,o,r,s,a,h,l=[];for(e=[];n=Rl.exec(t);)e.push({str:n[0],base:n[1],modifiers:n[2]});for(r=e.map(zt),h=e.length;h--;)a=r.slice(),o=e[h],a[h]=o.base+i+o.modifiers||"",s=r.slice(),s[h]=i+" "+s[h],l.push(a.join(" "),s.join(" "));return l.join(", ")},n=Bl.test(t)?t.replace(Bl,i):t.replace(Ol,"").replace(Dl,function(t,e){var n,i;return Il.test(e)?t:(n=e.split(",").map(Bt),i=n.map(o).join(", ")+" ",t.replace(e,i))})}function Bt(t){return t.trim?t.trim():t.replace(/^\s+/,"").replace(/\s+$/,"")}function zt(t){return t.str}function Ut(t){t&&t.constructor!==Object&&("function"==typeof t||("object"!=typeof t?c("data option must be an object or a function, `"+t+"` is not valid"):m("If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged")))}function Nt(t,e){Ut(e);var n="function"==typeof t,i="function"==typeof e;return e||n||(e={}),n||i?function(){var o=i?Ft(e,this):e,r=n?Ft(t,this):t;return jt(o,r)}:jt(e,t)}function Ft(t,e){var n=t.call(e);if(n)return"object"!=typeof n&&c("Data function must return an object"),n.constructor!==Object&&g("Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged"),n}function jt(t,e){if(t&&e){for(var n in e)n in t||(t[n]=e[n]);return t}return t||e}function Zt(t){var e,n,i;return t.matchString("=")?(e=t.pos,t.allowWhitespace(),(n=t.matchPattern(Ou))?t.matchPattern(Ru)?(i=t.matchPattern(Ou))?(t.allowWhitespace(),t.matchString("=")?[n,i]:(t.pos=e,null)):(t.pos=e,null):null:(t.pos=e,null)):null}function Wt(t){var e;return(e=t.matchPattern(Bu))?{t:fu,v:e}:null}function Vt(t){var e,n;if(t.interpolate[t.inside]===!1)return null;for(n=0;n<t.tags.length;n+=1)if(e=Ht(t,t.tags[n]))return e}function Ht(t,e){var n,i,o,r;if(n=t.pos,t.matchString("\\"+e.open)){if(0===n||"\\"!==t.str[n-1])return e.open}else if(!t.matchString(e.open))return null;if(i=Du(t))return t.matchString(e.close)?(e.open=i[0],e.close=i[1],t.sortMustacheTags(),Uu):null;if(t.allowWhitespace(),t.matchString("/")){t.pos-=1;var s=t.pos;Iu(t)?t.pos=s:(t.pos=s-e.close.length,t.error("Attempted to close a section that wasn't open"))}for(r=0;r<e.readers.length;r+=1)if(o=e.readers[r],i=o(t,e))return e.isStatic&&(i.s=!0),t.includeLinePositions&&(i.p=t.getLinePos(n)),i;return t.pos=n,null}function Gt(t){var e;return(e=t.matchPattern(Zu))?{t:lu,v:e}:null}function qt(t){var e=t.remaining();return"true"===e.substr(0,4)?(t.pos+=4,{t:pu,v:"true"}):"false"===e.substr(0,5)?(t.pos+=5,{t:pu,v:"false"}):null}function $t(t){var e;return(e=Ku(t))?Qu.test(e.v)?e.v:'"'+e.v.replace(/"/g,'\\"')+'"':(e=ju(t))?e.v:(e=t.matchPattern(Ju))?e:void 0}function Kt(t){var e,n,i;return e=t.pos,t.allowWhitespace(),n=Yu(t),null===n?(t.pos=e,null):(t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),i=Tc(t),null===i?(t.pos=e,null):{t:gu,k:n,v:i}):(t.pos=e,null))}function Jt(t){var e,n,i,o;return e=t.pos,i=Xu(t),null===i?null:(n=[i],t.matchString(",")?(o=Jt(t),o?n.concat(o):(t.pos=e,null)):n)}function Yt(t){function e(t){i.push(t)}var n,i,o,r;return n=t.pos,t.allowWhitespace(),o=Tc(t),null===o?null:(i=[o],t.allowWhitespace(),t.matchString(",")&&(r=Yt(t),null===r&&t.error(Nu),r.forEach(e)),i)}function Qt(t){return ju(t)||Wu(t)||Ku(t)||ec(t)||ic(t)||Iu(t)}function Xt(t){var e,n,i,o,r,s;return e=t.pos,i=t.matchPattern(/^@(?:keypath|index|key)/),i||(n=t.matchPattern(sc)||"",i=!n&&t.relaxedNames&&t.matchPattern(uc)||t.matchPattern(lc),i||"."!==n||(n="",i=".")),i?n||t.relaxedNames||!Hu.test(i)?!n&&Vu.test(i)?(o=Vu.exec(i)[0],t.pos=e+o.length,{t:mu,v:o}):(r=(n||"")+C(i),t.matchString("(")&&(s=r.lastIndexOf("."),-1!==s?(r=r.substr(0,s),t.pos=e+r.length):t.pos-=1),{t:vu,n:r.replace(/^this\./,"./").replace(/^this$/,".")}):(t.pos=e,null):null}function te(t){var e,n;return e=t.pos,t.matchString("(")?(t.allowWhitespace(),n=Tc(t),n||t.error(Nu),t.allowWhitespace(),t.matchString(")")||t.error(Fu),{t:bu,x:n}):null}function ee(t){var e,n,i;if(e=t.pos,t.allowWhitespace(),t.matchString(".")){if(t.allowWhitespace(),n=t.matchPattern(Ju))return{t:_u,n:n};t.error("Expected a property name")}return t.matchString("[")?(t.allowWhitespace(),i=Tc(t),i||t.error(Nu),t.allowWhitespace(),t.matchString("]")||t.error("Expected ']'"),{t:_u,x:i}):null}function ne(t){var e,n,i,o;return(n=kc(t))?(e=t.pos,t.allowWhitespace(),t.matchString("?")?(t.allowWhitespace(),i=Tc(t),i||t.error(Nu),t.allowWhitespace(),t.matchString(":")||t.error('Expected ":"'),t.allowWhitespace(),o=Tc(t),o||t.error(Nu),{t:xu,o:[n,i,o]}):(t.pos=e,n)):null}function ie(t){return Cc(t)}function oe(t){function e(t){switch(t.t){case pu:case mu:case lu:case fu:return t.v;case uu:return JSON.stringify(String(t.v));case cu:return"["+(t.m?t.m.map(e).join(","):"")+"]";case du:return"{"+(t.m?t.m.map(e).join(","):"")+"}";case gu:return t.k+":"+e(t.v);case wu:return("typeof"===t.s?"typeof ":t.s)+e(t.o);case Lu:return e(t.o[0])+("in"===t.s.substr(0,2)?" "+t.s+" ":t.s)+e(t.o[1]);case Pu:return e(t.x)+"("+(t.o?t.o.map(e).join(","):"")+")";case bu:return"("+e(t.x)+")";case yu:return e(t.x)+e(t.r);case _u:return t.n?"."+t.n:"["+e(t.x)+"]";case xu:return e(t.o[0])+"?"+e(t.o[1])+":"+e(t.o[2]);case vu:return"_"+n.indexOf(t.n);default:throw new Error("Expected legal JavaScript")}}var n;return re(t,n=[]),{r:n,s:e(t)}}function re(t,e){var n,i;if(t.t===vu&&-1===e.indexOf(t.n)&&e.unshift(t.n),i=t.o||t.m)if(l(i))re(i,e);else for(n=i.length;n--;)re(i[n],e);t.x&&re(t.x,e),t.r&&re(t.r,e),t.v&&re(t.v,e)}function se(t,e){var n;if(t){for(;t.t===bu&&t.x;)t=t.x;return t.t===vu?e.r=t.n:t.t===lu&&Ac.test(t.v)?e.r=t.v:(n=ae(t))?e.rx=n:e.x=Mc(t),e}}function ae(t){for(var e,n=[];t.t===yu&&t.r.t===_u;)e=t.r,e.x?e.x.t===vu?n.unshift(e.x):n.unshift(Mc(e.x)):n.unshift(e.n),t=t.x;return t.t!==vu?null:{r:t.n,m:n}}function he(t,e){var n,i=Tc(t);return i?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),n={t:Kl},Sc(i,n),n):null}function le(t,e){var n,i;return t.matchString("&")?(t.allowWhitespace(),(n=Tc(t))?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),i={t:Kl},Sc(n,i),i):null):null}function ue(t,e){var n,i,o,r,s;return n=t.pos,t.matchString(">")?(t.allowWhitespace(),i=t.pos,t.relaxedNames=!0,o=Tc(t),t.relaxedNames=!1,t.allowWhitespace(),r=Tc(t),t.allowWhitespace(),o?(s={t:tu},Sc(o,s),t.allowWhitespace(),r&&(s={t:Jl,n:Tu,f:[s]},Sc(r,s)),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),s):null):null}function ce(t,e){var n;return t.matchString("!")?(n=t.remaining().indexOf(e.close),-1!==n?(t.pos+=n+e.close.length,{t:eu}):void 0):null}function de(t,e){var n,i,o;if(n=t.pos,i=Tc(t),!i)return null;for(o=0;o<e.length;o+=1)if(t.remaining().substr(0,e[o].length)===e[o])return i;return t.pos=n,rc(t)}function pe(t,e){var n,i,o,r;n=t.pos;try{i=Bc(t,[e.close])}catch(s){r=s}if(!i){if("!"===t.str.charAt(n))return t.pos=n,null;if(r)throw r}if(!t.matchString(e.close)&&(t.error("Expected closing delimiter '"+e.close+"' after reference"),!i)){if("!"===t.nextChar())return null;t.error("Expected expression or legal reference")}return o={t:$l},Sc(i,o),o}function fe(t,e){var n,i,o;return t.matchPattern(Nc)?(n=t.pos,i=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/),t.allowWhitespace(),t.matchString(e.close)||t.error("expected legal partial name"),o={t:su},i&&(o.n=i),o):null}function me(t,e){var n,i,o,r;return n=t.pos,t.matchString(e.open)?(t.allowWhitespace(),t.matchString("/")?(t.allowWhitespace(),i=t.remaining(),o=i.indexOf(e.close),-1!==o?(r={t:Ql,r:i.substr(0,o).split(" ")[0]},t.pos+=o,t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),r):(t.pos=n,null)):(t.pos=n,null)):null}function ge(t,e){var n=t.pos;return t.matchString(e.open)?t.matchPattern(Zc)?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:Su}):(t.pos=n,null):null}function ve(t,e){var n,i=t.pos;return t.matchString(e.open)?t.matchPattern(Vc)?(n=Tc(t),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:Au,x:n}):(t.pos=i,null):null}function _e(t,e){var n,i,o,r,s,a,h,l,u,c,d,p;if(n=t.pos,t.matchString("^"))o={t:Jl,f:[],n:ku};else{if(!t.matchString("#"))return null;o={t:Jl,f:[]},t.matchString("partial")&&(t.pos=n-t.standardDelimiters[0].length,t.error("Partial definitions can only be at the top level of the template, or immediately inside components")),(h=t.matchPattern(Kc))&&(p=h,o.n=Hc[h])}if(t.allowWhitespace(),i=Tc(t),i||t.error("Expected expression"),d=t.matchPattern(qc)){var f=void 0;(f=t.matchPattern($c))?o.i=d+","+f:o.i=d}t.allowWhitespace(),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),t.sectionDepth+=1,s=o.f,u=[];do if(r=Fc(t,e))p&&r.r!==p&&t.error("Expected "+e.open+"/"+p+e.close),t.sectionDepth-=1,c=!0;else if(r=Wc(t,e))o.n===ku&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("illegal {{elseif...}} after {{else}}"),l||(l=ye(i,o.n)),l.f.push({t:Jl,n:Eu,x:Mc(be(u.concat(r.x))),f:s=[]}),u.push(we(r.x));else if(r=jc(t,e))o.n===ku&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("there can only be one {{else}} block, at the end of a section"),a=!0,l?l.f.push({t:Jl,n:Eu,x:Mc(be(u)),f:s=[]}):(l=ye(i,o.n),s=l.f);else{if(r=t.read(Xd),!r)break;s.push(r)}while(!c);return l&&(o.n===Tu&&(o.n=Mu),o.l=l),Sc(i,o),o.f.length||delete o.f,o}function ye(t,e){var n;return e===Tu?(n={t:Jl,n:Eu,f:[]},Sc(we(t),n)):(n={t:Jl,n:ku,f:[]},Sc(t,n)),n}function we(t){return t.t===wu&&"!"===t.s?t.o:{t:wu,s:"!",o:xe(t)}}function be(t){return 1===t.length?t[0]:{t:Lu,s:"&&",o:[xe(t[0]),xe(be(t.slice(1)))]}}function xe(t){return{t:bu,x:t}}function Le(t){var e,n,i,o,r;return e=t.pos,t.matchString(Yc)?(i=t.remaining(),o=i.indexOf(Qc),-1===o&&t.error("Illegal HTML - expected closing comment sequence ('-->')"),n=i.substr(0,o),t.pos+=o+3,r={t:eu,c:n},t.includeLinePositions&&(r.p=t.getLinePos(e)),r):null}function Pe(t){return t.replace(xc,function(t,e){var n;return n="#"!==e[0]?wc[e]:"x"===e[1]?parseInt(e.substring(2),16):parseInt(e.substring(1),10),n?String.fromCharCode(Ee(n)):t})}function Ee(t){return t?10===t?32:128>t?t:159>=t?bc[t-128]:55296>t?t:57343>=t?65533:65535>=t?t:65533:65533}function ke(t){return t.replace(Ec,"&amp;").replace(Lc,"&lt;").replace(Pc,"&gt;")}function Ce(t){return"string"==typeof t}function Te(t){return t.t===eu||t.t===nu}function Me(t){return(t.t===Jl||t.t===Yl)&&t.f}function Se(t,e,n,i,o){var s,a,h,l,u,c,d,p;for(hd(t),s=t.length;s--;)a=t[s],a.exclude?t.splice(s,1):e&&a.t===eu&&t.splice(s,1);for(ld(t,i?pd:null,o?fd:null),s=t.length;s--;){if(a=t[s],a.f){var f=a.t===Xl&&dd.test(a.e);u=n||f,!n&&f&&ld(a.f,md,gd),u||(h=t[s-1],l=t[s+1],(!h||"string"==typeof h&&fd.test(h))&&(c=!0),(!l||"string"==typeof l&&pd.test(l))&&(d=!0)),Se(a.f,e,u,c,d)}if(a.l&&(Se(a.l.f,e,n,c,d),t.splice(s+1,0,a.l),delete a.l),a.a)for(p in a.a)a.a.hasOwnProperty(p)&&"string"!=typeof a.a[p]&&Se(a.a[p],e,n,c,d);if(a.m&&Se(a.m,e,n,c,d),a.v)for(p in a.v)a.v.hasOwnProperty(p)&&(r(a.v[p].n)&&Se(a.v[p].n,e,n,c,d),r(a.v[p].d)&&Se(a.v[p].d,e,n,c,d))}for(s=t.length;s--;)"string"==typeof t[s]&&("string"==typeof t[s+1]&&(t[s]=t[s]+t[s+1],t.splice(s+1,1)),n||(t[s]=t[s].replace(cd," ")),""===t[s]&&t.splice(s,1))}function Ae(t){var e,n;return e=t.pos,t.matchString("</")?(n=t.matchPattern(_d))?t.inside&&n!==t.inside?(t.pos=e,null):{t:ou,e:n}:(t.pos-=2,void t.error("Illegal closing tag")):null}function De(t){var e,n,i;return t.allowWhitespace(),(n=t.matchPattern(bd))?(e={name:n},i=Oe(t),null!=i&&(e.value=i),e):null}function Oe(t){var e,n,i,o;return e=t.pos,/[=\/>\s]/.test(t.nextChar())||t.error("Expected `=`, `/`, `>` or whitespace"),t.allowWhitespace(),t.matchString("=")?(t.allowWhitespace(),n=t.pos,i=t.sectionDepth,o=Be(t,"'")||Be(t,'"')||Ie(t),null===o&&t.error("Expected valid attribute value"),t.sectionDepth!==i&&(t.pos=n,t.error("An attribute value must contain as many opening section tags as closing section tags")),o.length?1===o.length&&"string"==typeof o[0]?Pe(o[0]):o:""):(t.pos=e,null)}function Re(t){var e,n,i,o,r;return e=t.pos,(n=t.matchPattern(xd))?(i=n,o=t.tags.map(function(t){return t.open}),-1!==(r=yd(i,o))&&(n=n.substr(0,r),t.pos=e+n.length),n):null}function Ie(t){var e,n;for(t.inAttribute=!0,e=[],n=zu(t)||Re(t);null!==n;)e.push(n),n=zu(t)||Re(t);return e.length?(t.inAttribute=!1,e):null}function Be(t,e){var n,i,o;if(n=t.pos,!t.matchString(e))return null;for(t.inAttribute=e,i=[],o=zu(t)||ze(t,e);null!==o;)i.push(o),o=zu(t)||ze(t,e);return t.matchString(e)?(t.inAttribute=!1,i):(t.pos=n,null)}function ze(t,e){var n,i,o,r;return n=t.pos,o=t.remaining(),r=t.tags.map(function(t){return t.open}),r.push(e),i=yd(o,r),-1===i&&t.error("Quoted attribute value must have a closing quote"),i?(t.pos+=i,o.substr(0,i)):null}function Ue(t){var e,n,i;return t.allowWhitespace(),(e=Yu(t))?(i={key:e},t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),(n=t.read())?(i.value=n.v,i):null):null):null}function Ne(t,e){var n,i,o,r,s,a,h,l,u;if("string"==typeof t){if(i=kd.exec(t)){var c=t.lastIndexOf(")");return Cd.test(t)||e.error("Invalid input after method call expression '"+t.slice(c+1)+"'"),n={m:i[1]},r="["+t.slice(n.m.length+1,c)+"]",o=new Ld(r),n.a=Mc(o.result[0]),n}if(-1===t.indexOf(":"))return t.trim();t=[t]}if(n={},h=[],l=[],t){for(;t.length;)if(s=t.shift(),"string"==typeof s){if(a=s.indexOf(":"),-1!==a){a&&h.push(s.substr(0,a)),s.length>a+1&&(l[0]=s.substring(a+1));break}h.push(s)}else h.push(s);l=l.concat(t)}return h.length?l.length||"string"!=typeof h?(n={n:1===h.length&&"string"==typeof h[0]?h[0]:h},1===l.length&&"string"==typeof l[0]?(u=Pd("["+l[0]+"]"),n.a=u?u.value:l[0].trim()):n.d=l):n=h:n="",n}function Fe(t){var e,n,i,o,r,s,a,h,l,u,c,d,p,f,m,g;if(e=t.pos,t.inside||t.inAttribute)return null;if(!t.matchString("<"))return null;if("/"===t.nextChar())return null;if(n={},t.includeLinePositions&&(n.p=t.getLinePos(e)),t.matchString("!"))return n.t=hu,t.matchPattern(/^doctype/i)||t.error("Expected DOCTYPE declaration"),n.a=t.matchPattern(/^(.+?)>/),n;if(n.t=Xl,n.e=t.matchPattern(Md),!n.e)return null;for(Sd.test(t.nextChar())||t.error("Illegal tag name"),r=function(e,i){var o=i.n||i;Od.test(o)&&(t.pos-=o.length,t.error("Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, detach, insert)")),n.v[e]=i},t.allowWhitespace();s=zu(t)||wd(t);)s.name?(i=Rd[s.name])?n[i]=Ed(s.value,t):(o=Dd.exec(s.name))?(n.v||(n.v={}),a=Ed(s.value,t),r(o[1],a)):t.sanitizeEventAttributes&&Ad.test(s.name)||(n.a||(n.a={}),n.a[s.name]=s.value||(""===s.value?"":0)):(n.m||(n.m=[]),n.m.push(s)),t.allowWhitespace();if(t.allowWhitespace(),t.matchString("/")&&(h=!0),!t.matchString(">"))return null;var v=n.e.toLowerCase(),_=t.preserveWhitespace;if(!h&&!yc.test(n.e)){t.elementStack.push(v),("script"===v||"style"===v)&&(t.inside=v),l=[],u=wa(null);do if(f=t.pos,m=t.remaining(),je(v,m))if(g=vd(t)){p=!0;var y=g.e.toLowerCase();if(y!==v&&(t.pos=f,!~t.elementStack.indexOf(y))){var w="Unexpected closing tag";yc.test(y)&&(w+=" (<"+y+"> is a void element - it cannot contain children)"),t.error(w)}}else(d=Fc(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?(p=!0,t.pos=f):(d=t.read(tp))?(u[d.n]&&(t.pos=f,t.error("Duplicate partial definition")),ud(d.f,t.stripComments,_,!_,!_),u[d.n]=d.f,c=!0):(d=t.read(Xd))?l.push(d):p=!0;else p=!0;while(!p);l.length&&(n.f=l),c&&(n.p=u),t.elementStack.pop()}return t.inside=null,t.sanitizeElements&&-1!==t.sanitizeElements.indexOf(v)?Id:n}function je(t,e){var n,i;return n=/^<([a-zA-Z][a-zA-Z0-9]*)/.exec(e),i=Td[t],n&&i?!~i.indexOf(n[1].toLowerCase()):!0}function Ze(t){var e,n,i,o;return n=t.remaining(),o=t.inside?"</"+t.inside:"<",t.inside&&!t.interpolate[t.inside]?e=n.indexOf(o):(i=t.tags.map(function(t){return t.open}),i=i.concat(t.tags.map(function(t){return"\\"+t.open})),t.inAttribute===!0?i.push('"',"'","=","<",">","`"):t.inAttribute?i.push(t.inAttribute):i.push(o),e=yd(n,i)),e?(-1===e&&(e=n.length),t.pos+=e,t.inside?n.substr(0,e):Pe(n.substr(0,e))):null}function We(t){return t.replace(Fd,"\\$&")}function Ve(t){var e=t.pos,n=t.standardDelimiters[0],i=t.standardDelimiters[1],o=void 0,r=void 0;if(!t.matchPattern(Zd)||!t.matchString(n))return t.pos=e,null;var s=t.matchPattern(Wd);if(g("Inline partial comments are deprecated.\nUse this...\n  {{#partial "+s+"}} ... {{/partial}}\n\n...instead of this:\n  <!-- {{>"+s+"}} --> ... <!-- {{/"+s+"}} -->'"),!t.matchString(i)||!t.matchPattern(Vd))return t.pos=e,null;o=[];var a=new RegExp("^<!--\\s*"+Nd(n)+"\\s*\\/\\s*"+s+"\\s*"+Nd(i)+"\\s*-->");do t.matchPattern(a)?r=!0:(Bd=t.read(Xd),Bd||t.error("expected closing comment ('<!-- "+n+"/"+s+i+" -->')"),o.push(Bd));while(!r);return{t:au,f:o,n:s}}function He(t){var e,n,i,o,r;e=t.pos;var s=t.standardDelimiters;if(!t.matchString(s[0]))return null;if(!t.matchPattern(Gd))return t.pos=e,null;n=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/),n||t.error("expected legal partial name"),t.matchString(s[1])||t.error("Expected closing delimiter '"+s[1]+"'"),i=[];do(o=Fc(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?("partial"===!o.r&&t.error("Expected "+s[0]+"/partial"+s[1]),r=!0):(o=t.read(Xd),o||t.error("Expected "+s[0]+"/partial"+s[1]),i.push(o));while(!r);return{t:au,n:n,f:i}}function Ge(t){for(var e=[],n=wa(null),i=!1,o=t.preserveWhitespace;t.pos<t.str.length;){var r=t.pos,s=void 0,a=void 0;(a=t.read(tp))?(n[a.n]&&(t.pos=r,t.error("Duplicated partial definition")),ud(a.f,t.stripComments,o,!o,!o),
n[a.n]=a.f,i=!0):(s=t.read(Xd))?e.push(s):t.error("Unexpected template content")}var h={v:sa,t:e};return i&&(h.p=n),h}function qe(t,e){return new Qd(t,e||{}).result}function $e(t){var e=wa(rp);return e.parse=function(e,n){return Ke(e,n||t)},e}function Ke(t,e){if(!$d)throw new Error("Missing Ractive.parse - cannot parse template. Either preparse or use the version that includes the parser");return $d(t,e||this.options)}function Je(t,e){var n;if(!Xs){if(e&&e.noThrow)return;throw new Error("Cannot retrieve template #"+t+" as Ractive is not running in a browser.")}if(Ye(t)&&(t=t.substring(1)),!(n=document.getElementById(t))){if(e&&e.noThrow)return;throw new Error("Could not find template element with id #"+t)}if("SCRIPT"!==n.tagName.toUpperCase()){if(e&&e.noThrow)return;throw new Error("Template element with id #"+t+", must be a <script> element")}return"textContent"in n?n.textContent:n.innerHTML}function Ye(t){return t&&"#"===t[0]}function Qe(t){return!("string"==typeof t)}function Xe(t){return t.defaults&&(t=t.defaults),op.reduce(function(e,n){return e[n]=t[n],e},{})}function tn(t){var e,n=t._config.template;if(n&&n.fn)return e=en(t,n.fn),e!==n.result?(n.result=e,e=on(e,t)):void 0}function en(t,e){var n=nn(sp.getParseOptions(t));return e.call(t,n)}function nn(t){var e=wa(sp);return e.parse=function(e,n){return sp.parse(e,n||t)},e}function on(t,e){if("string"==typeof t)"#"===t[0]&&(t=sp.fromId(t)),t=$d(t,sp.getParseOptions(e));else{if(void 0==t)throw new Error("The template cannot be "+t+".");if("number"!=typeof t.v)throw new Error("The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.");if(t.v!==sa)throw new Error("Mismatched template version (expected "+sa+", got "+t.v+") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app")}return t}function rn(t,e,n){if(e)for(var i in e)(n||!t.hasOwnProperty(i))&&(t[i]=e[i])}function sn(t,e,n){if(!/_super/.test(n))return n;var i=function(){var t,o=an(i._parent,e),r="_super"in this,s=this._super;return this._super=o,t=n.apply(this,arguments),r?this._super=s:delete this._super,t};return i._parent=t,i._method=n,i}function an(t,e){var n,i;return e in t?(n=t[e],i="function"==typeof n?n:function(){return n}):i=Aa,i}function hn(t,e,n){return"options."+t+" has been deprecated in favour of options."+e+"."+(n?" You cannot specify both options, please use options."+e+".":"")}function ln(t,e,n){if(e in t){if(n in t)throw new Error(hn(e,n,!0));m(hn(e,n)),t[n]=t[e]}}function un(t){ln(t,"beforeInit","onconstruct"),ln(t,"init","onrender"),ln(t,"complete","oncomplete"),ln(t,"eventDefinitions","events"),r(t.adaptors)&&ln(t,"adaptors","adapt")}function cn(t,e,n,i){vp(i);for(var o in i)if(fp.hasOwnProperty(o)){var r=i[o];"el"!==o&&"function"==typeof r?m(""+o+" is a Ractive option that does not expect a function and will be ignored","init"===t?n:null):n[o]=r}mp.forEach(function(o){o[t](e,n,i)}),Sl[t](e,n,i),hp[t](e,n,i),Nl[t](e,n,i),dn(e.prototype,n,i)}function dn(t,e,n){for(var i in n)if(!pp[i]&&n.hasOwnProperty(i)){var o=n[i];"function"==typeof o&&(o=gp(t,i,o)),e[i]=o}}function pn(t){var e={};return t.forEach(function(t){return e[t]=!0}),e}function fn(){this.dirtyValue=this.dirtyArgs=!0,this.bound&&"function"==typeof this.owner.bubble&&this.owner.bubble()}function mn(){var t;return 1===this.items.length?this.items[0].detach():(t=document.createDocumentFragment(),this.items.forEach(function(e){var n=e.detach();n&&t.appendChild(n)}),t)}function gn(t){var e,n,i,o;if(this.items){for(n=this.items.length,e=0;n>e;e+=1)if(i=this.items[e],i.find&&(o=i.find(t)))return o;return null}}function vn(t,e){var n,i,o;if(this.items)for(i=this.items.length,n=0;i>n;n+=1)o=this.items[n],o.findAll&&o.findAll(t,e);return e}function _n(t,e){var n,i,o;if(this.items)for(i=this.items.length,n=0;i>n;n+=1)o=this.items[n],o.findAllComponents&&o.findAllComponents(t,e);return e}function yn(t){var e,n,i,o;if(this.items){for(e=this.items.length,n=0;e>n;n+=1)if(i=this.items[n],i.findComponent&&(o=i.findComponent(t)))return o;return null}}function wn(t){var e,n=t.index;return e=this.items[n+1]?this.items[n+1].firstNode():this.owner===this.root?this.owner.component?this.owner.component.findNextNode():null:this.owner.findNextNode(this)}function bn(){return this.items&&this.items[0]?this.items[0].firstNode():null}function xn(t,e,n,i){return i=i||0,t.map(function(t){var o,r,s;return t.text?t.text:t.fragments?t.fragments.map(function(t){return xn(t.items,e,n,i)}).join(""):(o=n+"-"+i++,s=t.keypath&&(r=t.root.viewmodel.wrapped[t.keypath.str])?r.value:t.getValue(),e[o]=s,"${"+o+"}")}).join("")}function Ln(){var t,e,n,i;return this.dirtyArgs&&(e=Cp(this.items,t={},this.root._guid),n=Pd("["+e+"]",t),i=n?n.value:[this.toString()],this.argsList=i,this.dirtyArgs=!1),this.argsList}function Pn(){var t=this;do if(t.pElement)return t.pElement.node;while(t=t.parent);return this.root.detached||this.root.el}function En(){var t,e,n,i;return this.dirtyValue&&(e=Cp(this.items,t={},this.root._guid),n=Pd(e,t),i=n?n.value:this.toString(),this.value=i,this.dirtyValue=!1),this.value}function kn(){this.registered&&this.root.viewmodel.unregister(this.keypath,this),this.resolver&&this.resolver.unbind()}function Cn(){return this.value}function Tn(t,e){for(var n,i=0;i<e.prop.length;i++)if(void 0!==(n=t[e.prop[i]]))return n}function Mn(t,e){var n,i,o,r,s,a={},h=!1;for(e||(a.refs=n={});t;){if((s=t.owner)&&(i=s.indexRefs)){if(e&&(o=s.getIndexRef(e)))return a.ref={fragment:t,ref:o},a;if(!e)for(r in i)o=i[r],n[o.n]||(h=!0,n[o.n]={fragment:t,ref:o})}!t.parent&&t.owner&&t.owner.component&&t.owner.component.parentFragment&&!t.owner.component.instance.isolated?(a.componentBoundary=!0,t=t.owner.component.parentFragment):t=t.parent}return h?a:void 0}function Sn(t,e,n){var i;return"@"===e.charAt(0)?new Fp(t,e,n):(i=Wp(t.parentFragment,e))?new Zp(t,i,n):new zp(t,e,n)}function An(t,e){var n,i;if(qp[t])return qp[t];for(i=[];e--;)i[e]="_"+e;return n=new Function(i.join(","),"return("+t+")"),qp[t]=n,n}function Dn(t){return t.call()}function On(t,e){return t.replace(/_([0-9]+)/g,function(t,n){var i,o;return+n>=e.length?"_"+n:(i=e[n],void 0===i?"undefined":i.isSpecial?(o=i.value,"number"==typeof o?o:'"'+o+'"'):i.str)})}function Rn(t){return P("${"+t.replace(/[\.\[\]]/g,"-").replace(/\*/,"#MUL#")+"}")}function In(t){return void 0!==t&&"@"!==t[0]}function Bn(t,e){var n,i,o;if(t.__ractive_nowrap)return t;if(i="__ractive_"+e._guid,n=t[i])return n;if(/this/.test(t.toString())){ba(t,i,{value:$p.call(t,e),configurable:!0});for(o in t)t.hasOwnProperty(o)&&(t[i][o]=t[o]);return e._boundFunctions.push({fn:t,prop:i}),t[i]}return ba(t,"__ractive_nowrap",{value:t}),t.__ractive_nowrap}function zn(t){return t.value}function Un(t){return void 0!=t}function Nn(t){t.forceResolution()}function Fn(t,e){function n(e){t.resolve(e)}function i(e){var n=t.keypath;e!=n&&(t.resolve(e),void 0!==n&&t.fragments&&t.fragments.forEach(function(t){t.rebind(n,e)}))}var o,r,s;r=e.parentFragment,s=e.template,t.root=r.root,t.parentFragment=r,t.pElement=r.pElement,t.template=e.template,t.index=e.index||0,t.isStatic=e.template.s,t.type=e.template.t,t.registered=!1,(o=s.r)&&(t.resolver=Hp(t,o,n)),e.template.x&&(t.resolver=new Kp(t,r,e.template.x,i)),e.template.rx&&(t.resolver=new Xp(t,e.template.rx,i)),t.template.n!==ku||t.hasOwnProperty("value")||t.setValue(void 0)}function jn(t){var e,n,i;return t&&t.isSpecial?(this.keypath=t,void this.setValue(t.value)):(this.registered&&(this.root.viewmodel.unregister(this.keypath,this),this.registered=!1,e=!0),this.keypath=t,void 0!=t&&(n=this.root.viewmodel.get(t),this.root.viewmodel.register(t,this),this.registered=!0),this.setValue(n),void(e&&(i=this.twowayBinding)&&i.rebound()))}function Zn(t,e){this.fragments&&this.fragments.forEach(function(n){return n.rebind(t,e)}),this.resolver&&this.resolver.rebind(t,e)}function Wn(){this.parentFragment.bubble()}function Vn(){var t;return 1===this.fragments.length?this.fragments[0].detach():(t=document.createDocumentFragment(),this.fragments.forEach(function(e){t.appendChild(e.detach())}),t)}function Hn(t){var e,n,i;for(n=this.fragments.length,e=0;n>e;e+=1)if(i=this.fragments[e].find(t))return i;return null}function Gn(t,e){var n,i;for(i=this.fragments.length,n=0;i>n;n+=1)this.fragments[n].findAll(t,e)}function qn(t,e){var n,i;for(i=this.fragments.length,n=0;i>n;n+=1)this.fragments[n].findAllComponents(t,e)}function $n(t){var e,n,i;for(n=this.fragments.length,e=0;n>e;e+=1)if(i=this.fragments[e].findComponent(t))return i;return null}function Kn(t){return this.fragments[t.index+1]?this.fragments[t.index+1].firstNode():this.parentFragment.findNextNode(this)}function Jn(){var t,e,n;if(t=this.fragments.length)for(e=0;t>e;e+=1)if(n=this.fragments[e].firstNode())return n;return this.parentFragment.findNextNode(this)}function Yn(t){var e,n,i,o,r,s,a,h=this;if(!this.shuffling&&!this.unbound&&this.currentSubtype===Cu){if(this.shuffling=!0,mh.scheduleTask(function(){return h.shuffling=!1}),e=this.parentFragment,r=[],t.forEach(function(t,e){var i,o,s,a,l;return t===e?void(r[t]=h.fragments[e]):(i=h.fragments[e],void 0===n&&(n=e),-1===t?(h.fragmentsToUnrender.push(i),void i.unbind()):(o=t-e,s=h.keypath.join(e),a=h.keypath.join(t),i.index=t,(l=i.registeredIndexRefs)&&l.forEach(Qn),i.rebind(s,a),void(r[t]=i)))}),o=this.root.viewmodel.get(this.keypath).length,void 0===n){if(this.length===o)return;n=this.length}for(this.length=this.fragments.length=o,this.rendered&&mh.addView(this),s={template:this.template.f,root:this.root,owner:this},i=n;o>i;i+=1)a=r[i],a||this.fragmentsToCreate.push(i),this.fragments[i]=a}}function Qn(t){t.rebind("","")}function Xn(){var t=this;return this.docFrag=document.createDocumentFragment(),this.fragments.forEach(function(e){return t.docFrag.appendChild(e.render())}),this.renderedFragments=this.fragments.slice(),this.fragmentsToRender=[],this.rendered=!0,this.docFrag}function ti(t){var e,n,i=this;this.updating||(this.updating=!0,this.keypath&&(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),this.fragmentsToCreate.length?(n={template:this.template.f||[],root:this.root,pElement:this.pElement,owner:this},this.fragmentsToCreate.forEach(function(t){var e;n.context=i.keypath.join(t),n.index=t,e=new _y(n),i.fragmentsToRender.push(i.fragments[t]=e)}),this.fragmentsToCreate.length=0):ni(this,t)&&(this.bubble(),this.rendered&&mh.addView(this)),this.value=t,this.updating=!1)}function ei(t,e,n){if(e===Cu&&t.indexRefs&&t.indexRefs[0]){var i=t.indexRefs[0];(n&&"i"===i.t||!n&&"k"===i.t)&&(n||(t.length=0,t.fragmentsToUnrender=t.fragments.slice(0),t.fragmentsToUnrender.forEach(function(t){return t.unbind()}))),i.t=n?"k":"i"}t.currentSubtype=e}function ni(t,e){var n={template:t.template.f||[],root:t.root,pElement:t.parentFragment.pElement,owner:t};if(t.hasContext=!0,t.subtype)switch(t.subtype){case Eu:return t.hasContext=!1,ai(t,e,!1,n);case ku:return t.hasContext=!1,ai(t,e,!0,n);case Tu:return si(t,n);case Mu:return ri(t,e,n);case Cu:if(l(e))return ei(t,t.subtype,!0),oi(t,e,n)}return t.ordered=!!s(e),t.ordered?(ei(t,Cu,!1),ii(t,e,n)):l(e)||"function"==typeof e?t.template.i?(ei(t,Cu,!0),oi(t,e,n)):(ei(t,Tu,!1),si(t,n)):(ei(t,Eu,!1),t.hasContext=!1,ai(t,e,!1,n))}function ii(t,e,n){var i,o,r;if(o=e.length,o===t.length)return!1;if(o<t.length)t.fragmentsToUnrender=t.fragments.splice(o,t.length-o),t.fragmentsToUnrender.forEach(q);else if(o>t.length)for(i=t.length;o>i;i+=1)n.context=t.keypath.join(i),n.index=i,r=new _y(n),t.fragmentsToRender.push(t.fragments[i]=r);return t.length=o,!0}function oi(t,e,n){var i,o,r,s,a,h;for(r=t.hasKey||(t.hasKey={}),o=t.fragments.length;o--;)s=t.fragments[o],s.key in e||(a=!0,s.unbind(),t.fragmentsToUnrender.push(s),t.fragments.splice(o,1),r[s.key]=!1);for(o=t.fragments.length;o--;)s=t.fragments[o],s.index!==o&&(s.index=o,(h=s.registeredIndexRefs)&&h.forEach(ui));o=t.fragments.length;for(i in e)r[i]||(a=!0,n.context=t.keypath.join(i),n.key=i,n.index=o++,s=new _y(n),t.fragmentsToRender.push(s),t.fragments.push(s),r[i]=!0);return t.length=t.fragments.length,a}function ri(t,e,n){return e?si(t,n):hi(t)}function si(t,e){var n;return t.length?void 0:(e.context=t.keypath,e.index=0,n=new _y(e),t.fragmentsToRender.push(t.fragments[0]=n),t.length=1,!0)}function ai(t,e,n,i){var o,r,a,h,u;if(r=s(e)&&0===e.length,a=!1,!s(e)&&l(e)){a=!0;for(u in e){a=!1;break}}return o=n?r||a||!e:e&&!r&&!a,o?t.length?t.length>1?(t.fragmentsToUnrender=t.fragments.splice(1),t.fragmentsToUnrender.forEach(q),!0):void 0:(i.index=0,h=new _y(i),t.fragmentsToRender.push(t.fragments[0]=h),t.length=1,!0):hi(t)}function hi(t){return t.length?(t.fragmentsToUnrender=t.fragments.splice(0,t.fragments.length).filter(li),t.fragmentsToUnrender.forEach(q),t.length=t.fragmentsToRender.length=0,!0):void 0}function li(t){return t.rendered}function ui(t){t.rebind("","")}function ci(t){var e,n,i;for(e="",n=0,i=this.length,n=0;i>n;n+=1)e+=this.fragments[n].toString(t);return e}function di(){var t=this;this.fragments.forEach(q),this.fragmentsToRender.forEach(function(e){return B(t.fragments,e)}),this.fragmentsToRender=[],Rp.call(this),this.length=0,this.unbound=!0}function pi(t){this.fragments.forEach(t?fi:mi),this.renderedFragments=[],this.rendered=!1}function fi(t){t.unrender(!0)}function mi(t){t.unrender(!1)}function gi(){var t,e,n,i,o,r,s;for(n=this.renderedFragments;t=this.fragmentsToUnrender.pop();)t.unrender(!0),n.splice(n.indexOf(t),1);for(;t=this.fragmentsToRender.shift();)t.render();for(this.rendered&&(o=this.parentFragment.getNode()),s=this.fragments.length,r=0;s>r;r+=1)t=this.fragments[r],e=n.indexOf(t,r),e!==r?(this.docFrag.appendChild(t.detach()),-1!==e&&n.splice(e,1),n.splice(r,0,t)):this.docFrag.childNodes.length&&(i=t.firstNode(),o.insertBefore(this.docFrag,i));this.rendered&&this.docFrag.childNodes.length&&(i=this.parentFragment.findNextNode(this),o.insertBefore(this.docFrag,i)),this.renderedFragments=this.fragments.slice()}function vi(){var t,e;if(this.docFrag){for(t=this.nodes.length,e=0;t>e;e+=1)this.docFrag.appendChild(this.nodes[e]);return this.docFrag}}function _i(t){var e,n,i,o;for(n=this.nodes.length,e=0;n>e;e+=1)if(i=this.nodes[e],1===i.nodeType){if(da(i,t))return i;if(o=i.querySelector(t))return o}return null}function yi(t,e){var n,i,o,r,s,a;for(i=this.nodes.length,n=0;i>n;n+=1)if(o=this.nodes[n],1===o.nodeType&&(da(o,t)&&e.push(o),r=o.querySelectorAll(t)))for(s=r.length,a=0;s>a;a+=1)e.push(r[a])}function wi(){return this.rendered&&this.nodes[0]?this.nodes[0]:this.parentFragment.findNextNode(this)}function bi(t){return Af[t]||(Af[t]=ca(t))}function xi(t){var e,n,i;t&&"select"===t.name&&t.binding&&(e=z(t.node.options).filter(Li),t.getAttribute("multiple")?i=e.map(function(t){return t.value}):(n=e[0])&&(i=n.value),void 0!==i&&t.binding.setValue(i),t.bubble())}function Li(t){return t.selected}function Pi(){if(this.rendered)throw new Error("Attempted to render an item that was already rendered");return this.docFrag=document.createDocumentFragment(),this.nodes=Df(this.value,this.parentFragment.getNode(),this.docFrag),Of(this.pElement),this.rendered=!0,this.docFrag}function Ei(t){var e;(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),t!==this.value&&(this.value=t,this.parentFragment.bubble(),this.rendered&&mh.addView(this))}function ki(){return void 0!=this.value?Pe(""+this.value):""}function Ci(t){this.rendered&&t&&(this.nodes.forEach(e),this.rendered=!1)}function Ti(){var t,e;if(this.rendered){for(;this.nodes&&this.nodes.length;)t=this.nodes.pop(),t.parentNode.removeChild(t);e=this.parentFragment.getNode(),this.nodes=Df(this.value,e,this.docFrag),e.insertBefore(this.docFrag,this.parentFragment.findNextNode(this)),Of(this.pElement)}}function Mi(){var t,e=this.node;return e?((t=e.parentNode)&&t.removeChild(e),e):void 0}function Si(){return null}function Ai(){return this.node}function Di(t){return this.attributes&&this.attributes[t]?this.attributes[t].value:void 0}function Oi(){var t=this.useProperty||!this.rendered?this.fragment.getValue():this.fragment.toString();a(t,this.value)||("id"===this.name&&this.value&&delete this.root.nodes[this.value],this.value=t,"value"===this.name&&this.node&&(this.node._ractive.value=t),this.rendered&&mh.addView(this))}function Ri(t){var e=t.fragment.items;if(1===e.length)return e[0].type===$l?e[0]:void 0}function Ii(t){return this.type=iu,this.element=t.element,this.root=t.root,rm(this,t.name),this.isBoolean=_c.test(this.name),t.value&&"string"!=typeof t.value?(this.parentFragment=this.element.parentFragment,this.fragment=new _y({template:t.value,root:this.root,owner:this}),this.value=this.fragment.getValue(),this.interpolator=sm(this),this.isBindable=!!this.interpolator&&!this.interpolator.isStatic,void(this.ready=!0)):void(this.value=this.isBoolean?!0:t.value||"")}function Bi(t,e){this.fragment&&this.fragment.rebind(t,e)}function zi(t){var e;this.node=t,t.namespaceURI&&t.namespaceURI!==ia.html||(e=um[this.name]||this.name,void 0!==t[e]&&(this.propertyName=e),(this.isBoolean||this.isTwoway)&&(this.useProperty=!0),"value"===e&&(t._ractive.value=this.value)),this.rendered=!0,this.update()}function Ui(){var t=this,e=t.name,n=t.namespacePrefix,i=t.value,o=t.interpolator,r=t.fragment;if(("value"!==e||"select"!==this.element.name&&"textarea"!==this.element.name)&&("value"!==e||void 0===this.element.getAttribute("contenteditable"))){if("name"===e&&"input"===this.element.name&&o)return"name={{"+(o.keypath.str||o.ref)+"}}";if(this.isBoolean)return i?e:"";if(r){if(1===r.items.length&&null==r.items[0].value)return"";i=r.toString()}return n&&(e=n+":"+e),i?e+'="'+Ni(i)+'"':e}}function Ni(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Fi(){this.fragment&&this.fragment.unbind(),"id"===this.name&&delete this.root.nodes[this.value]}function ji(){var t,e,n,i,o=this.value;if(!this.locked)for(this.node._ractive.value=o,t=this.node.options,i=t.length;i--;)if(e=t[i],n=e._ractive?e._ractive.value:e.value,n==o){e.selected=!0;break}}function Zi(){var t,e,n,i,o=this.value;for(r(o)||(o=[o]),t=this.node.options,e=t.length;e--;)n=t[e],i=n._ractive?n._ractive.value:n.value,n.selected=D(o,i)}function Wi(){var t=this,e=t.node,n=t.value;e.checked=n==e._ractive.value}function Vi(){var t,e,n,i,o=this.node;if(t=o.checked,o.value=this.element.getAttribute("value"),o.checked=this.element.getAttribute("value")===this.element.getAttribute("name"),t&&!o.checked&&this.element.binding&&(n=this.element.binding.siblings,i=n.length)){for(;i--;){if(e=n[i],!e.element.node)return;if(e.element.node.checked)return mh.addRactive(e.root),e.handleChange()}this.root.viewmodel.set(e.keypath,void 0)}}function Hi(){var t,e,n=this,i=n.element,o=n.node,s=n.value,a=i.binding;if(t=i.getAttribute("value"),r(s)){for(e=s.length;e--;)if(t==s[e])return void(a.isChecked=o.checked=!0);a.isChecked=o.checked=!1}else a.isChecked=o.checked=s==t}function Gi(){this.node.className=n(this.value)}function qi(){var t=this,e=t.node,n=t.value;this.root.nodes[n]=e,e.id=n}function $i(){var t,e;t=this.node,e=this.value,void 0===e&&(e=""),t.style.setAttribute("cssText",e)}function Ki(){var t=this.value;void 0===t&&(t=""),this.locked||(this.node.innerHTML=t)}function Ji(){var t=this,e=t.node,n=t.value;e._ractive.value=n,this.locked||(e.value=void 0==n?"":n)}function Yi(){this.locked||(this.node[this.propertyName]=this.value)}function Qi(){var t=this,e=t.node,n=t.namespace,i=t.name,o=t.value,r=t.fragment;n?e.setAttributeNS(n,i,(r||o).toString()):this.isBoolean?o?e.setAttribute(i,""):e.removeAttribute(i):null==o?e.removeAttribute(i):e.setAttribute(i,(r||o).toString())}function Xi(){var t,e,n=this,i=n.name,o=n.element,r=n.node;"id"===i?e=ym:"value"===i?"select"===o.name&&"value"===i?e=o.getAttribute("multiple")?fm:pm:"textarea"===o.name?e=xm:null!=o.getAttribute("contenteditable")?e=bm:"input"===o.name&&(t=o.getAttribute("type"),e="file"===t?Aa:"radio"===t&&o.binding&&"name"===o.binding.name?gm:xm):this.isTwoway&&"name"===i?"radio"===r.type?e=mm:"checkbox"===r.type&&(e=vm):"style"===i&&r.style.setAttribute?e=wm:"class"!==i||r.namespaceURI&&r.namespaceURI!==ia.html?this.useProperty&&(e=Lm):e=_m,e||(e=Pm),this.update=e,this.update()}function to(t,e){var n=e?"svg":"div";return Cm.innerHTML="<"+n+" "+t+"></"+n+">",z(Cm.childNodes[0].attributes)}function eo(t,e){for(var n=t.length;n--;)if(t[n].name===e.name)return!1;return!0}function no(t){for(;t=t.parent;)if("form"===t.name)return t}function io(){this._ractive.binding.handleChange()}function oo(){var t;Bm.call(this),t=this._ractive.root.viewmodel.get(this._ractive.binding.keypath),this.value=void 0==t?"":t}function ro(){var t=this._ractive.binding,e=this;t._timeout&&clearTimeout(t._timeout),t._timeout=setTimeout(function(){t.rendered&&Bm.call(e),t._timeout=void 0},t.element.lazy)}function so(t,e,n){var i=t+e+n;return jm[i]||(jm[i]=[])}function ao(t){return t.isChecked}function ho(t){return t.element.getAttribute("value")}function lo(t){var e,n,i,o,r,s=t.attributes;return t.binding&&(t.binding.teardown(),t.binding=null),(t.getAttribute("contenteditable")||s.contenteditable&&uo(s.contenteditable))&&uo(s.value)?n=Nm:"input"===t.name?(e=t.getAttribute("type"),"radio"===e||"checkbox"===e?(i=uo(s.name),o=uo(s.checked),i&&o&&m("A radio input can have two-way binding on its name attribute, or its checked attribute - not both",{ractive:t.root}),i?n="radio"===e?Hm:qm:o&&(n="radio"===e?Wm:Km)):"file"===e&&uo(s.value)?n=eg:uo(s.value)&&(n="number"===e||"range"===e?ng:zm)):"select"===t.name&&uo(s.value)?n=t.getAttribute("multiple")?Xm:Ym:"textarea"===t.name&&uo(s.value)&&(n=zm),n&&(r=new n(t))&&r.keypath?r:void 0}function uo(t){return t&&t.isBindable}function co(){var t=this.getAction();t&&!this.hasListener?this.listen():!t&&this.hasListener&&this.unrender()}function po(t){jh(this.root,this.getAction(),{event:t})}function fo(){return this.action.toString().trim()}function mo(t,e,n){var i,o,r,s=this;this.element=t,this.root=t.root,this.parentFragment=t.parentFragment,this.name=e,-1!==e.indexOf("*")&&(c('Only component proxy-events may contain "*" wildcards, <%s on-%s="..."/> is not valid',t.name,e),this.invalid=!0),n.m?(o=n.a.r,this.method=n.m,this.keypaths=[],this.fn=Gp(n.a.s,o.length),this.parentFragment=t.parentFragment,r=this.root,this.refResolvers=[],o.forEach(function(t,e){var n=void 0;(n=hg.exec(t))?s.keypaths[e]={eventObject:!0,refinements:n[1]?n[1].split("."):[]}:s.refResolvers.push(Hp(s,t,function(t){return s.resolve(e,t)}))}),this.fire=go):(i=n.n||n,"string"!=typeof i&&(i=new _y({template:i,root:this.root,owner:this})),this.action=i,n.d?(this.dynamicParams=new _y({template:n.d,root:this.root,owner:this.element}),this.fire=_o):n.a&&(this.params=n.a,this.fire=vo))}function go(t){var e,n,i;if(e=this.root,"function"!=typeof e[this.method])throw new Error('Attempted to call a non-existent method ("'+this.method+'")');n=this.keypaths.map(function(n){var i,o,r;if(void 0!==n){if(n.eventObject){if(i=t,o=n.refinements.length)for(r=0;o>r;r+=1)i=i[n.refinements[r]]}else i=e.viewmodel.get(n);return i}}),Fh.enqueue(e,t),i=this.fn.apply(null,n),e[this.method].apply(e,i),Fh.dequeue(e)}function vo(t){jh(this.root,this.getAction(),{event:t,args:this.params})}function _o(t){var e=this.dynamicParams.getArgsList();"string"==typeof e&&(e=e.substr(1,e.length-2)),jh(this.root,this.getAction(),{event:t,args:e})}function yo(t){var e,n,i,o={};e=this._ractive,n=e.events[t.type],(i=Wp(n.element.parentFragment))&&(o=Wp.resolve(i)),n.fire({node:this,original:t,index:o,keypath:e.keypath.str,context:e.root.viewmodel.get(e.keypath)})}function wo(){var t,e=this.name;if(!this.invalid){if(t=v("events",this.root,e))this.custom=t(this.node,bo(e));else{if(!("on"+e in this.node||window&&"on"+e in window||ta))return void(dg[e]||g(Ia(e,"event"),{node:this.node}));this.node.addEventListener(e,lg,!1)}this.hasListener=!0}}function bo(t){return cg[t]||(cg[t]=function(e){var n=e.node._ractive;e.index=n.index,e.keypath=n.keypath.str,e.context=n.root.viewmodel.get(n.keypath),n.events[t].fire(e)}),cg[t]}function xo(t,e){function n(n){n&&n.rebind(t,e)}var i;return this.method?(i=this.element.parentFragment,void this.refResolvers.forEach(n)):("string"!=typeof this.action&&n(this.action),void(this.dynamicParams&&n(this.dynamicParams)))}function Lo(){this.node=this.element.node,this.node._ractive.events[this.name]=this,(this.method||this.getAction())&&this.listen()}function Po(t,e){this.keypaths[t]=e}function Eo(){return this.method?void this.refResolvers.forEach(q):("string"!=typeof this.action&&this.action.unbind(),void(this.dynamicParams&&this.dynamicParams.unbind()))}function ko(){this.custom?this.custom.teardown():this.node.removeEventListener(this.name,lg,!1),this.hasListener=!1}function Co(){var t=this;this.dirty||(this.dirty=!0,mh.scheduleTask(function(){To(t),t.dirty=!1})),this.parentFragment.bubble()}function To(t){var e,n,i,o,r;e=t.node,e&&(o=z(e.options),n=t.getAttribute("value"),i=t.getAttribute("multiple"),void 0!==n?(o.forEach(function(t){var e,o;e=t._ractive?t._ractive.value:t.value,o=i?Mo(n,e):n==e,o&&(r=!0),t.selected=o}),r||(o[0]&&(o[0].selected=!0),t.binding&&t.binding.forceUpdate())):t.binding&&t.binding.forceUpdate())}function Mo(t,e){for(var n=t.length;n--;)if(t[n]==e)return!0}function So(t,e){t.select=Do(t.parent),t.select&&(t.select.options.push(t),e.a||(e.a={}),void 0!==e.a.value||e.a.hasOwnProperty("disabled")||(e.a.value=e.f),"selected"in e.a&&void 0!==t.select.getAttribute("value")&&delete e.a.selected)}function Ao(t){t.select&&B(t.select.options,t)}function Do(t){if(t)do if("select"===t.name)return t;while(t=t.parent)}function Oo(t){var e,n,i,o,r,s,a;this.type=Xl,e=this.parentFragment=t.parentFragment,n=this.template=t.template,this.parent=t.pElement||e.pElement,this.root=i=e.root,this.index=t.index,this.key=t.key,this.name=om(n.e),"option"===this.name&&So(this,n),"select"===this.name&&(this.options=[],this.bubble=Co),"form"===this.name&&(this.formBindings=[]),a=nm(this,n),this.attributes=Mm(this,n.a),this.conditionalAttributes=Dm(this,n.m),n.f&&(this.fragment=new _y({template:n.f,root:i,owner:this,pElement:this,cssIds:null})),s=i.twoway,a.twoway===!1?s=!1:a.twoway===!0&&(s=!0),this.twoway=s,this.lazy=a.lazy,s&&(o=ig(this,n.a))&&(this.binding=o,r=this.root._twowayBindings[o.keypath.str]||(this.root._twowayBindings[o.keypath.str]=[]),r.push(o)),n.v&&(this.eventHandlers=wg(this,n.v)),n.o&&(this.decorator=new Eg(this,n.o)),this.intro=n.t0||n.t1,this.outro=n.t0||n.t2}function Ro(t,e){function n(n){n.rebind(t,e)}var i,o,r,s;if(this.attributes&&this.attributes.forEach(n),this.conditionalAttributes&&this.conditionalAttributes.forEach(n),this.eventHandlers&&this.eventHandlers.forEach(n),this.decorator&&n(this.decorator),this.fragment&&n(this.fragment),r=this.liveQueries)for(s=this.root,i=r.length;i--;)r[i]._makeDirty();this.node&&(o=this.node._ractive)&&x(o,"keypath",t,e)}function Io(t){var e;(t.attributes.width||t.attributes.height)&&t.node.addEventListener("load",e=function(){var n=t.getAttribute("width"),i=t.getAttribute("height");void 0!==n&&t.node.setAttribute("width",n),void 0!==i&&t.node.setAttribute("height",i),t.node.removeEventListener("load",e,!1)},!1)}function Bo(t){t.node.addEventListener("reset",Uo,!1)}function zo(t){t.node.removeEventListener("reset",Uo,!1)}function Uo(){var t=this._ractive.proxy;mh.start(),t.formBindings.forEach(No),mh.end()}function No(t){t.root.viewmodel.set(t.keypath,t.resetValue)}function Fo(t,e,n){var i,o,r;this.element=t,this.root=i=t.root,this.isIntro=n,o=e.n||e,("string"==typeof o||(r=new _y({template:o,root:i,owner:t}),o=r.toString(),r.unbind(),""!==o))&&(this.name=o,e.a?this.params=e.a:e.d&&(r=new _y({template:e.d,root:i,owner:t}),this.params=r.getArgsList(),r.unbind()),this._fn=v("transitions",i,o),this._fn||g(Ia(o,"transition"),{ractive:this.root}))}function jo(t){return t}function Zo(){ev.hidden=document[Yg]}function Wo(){ev.hidden=!0}function Vo(){ev.hidden=!1}function Ho(){var t,e,n,i=this;return t=this.node=this.element.node,e=t.getAttribute("style"),this.complete=function(o){n||(!o&&i.isIntro&&Go(t,e),t._ractive.transition=null,i._manager.remove(i),n=!0)},this._fn?void this._fn.apply(this.root,[this].concat(this.params)):void this.complete()}function Go(t,e){e?t.setAttribute("style",e):(t.getAttribute("style"),t.removeAttribute("style"))}function qo(){var t,e,n,i=this,o=this.root;return t=$o(this),e=this.node=ca(this.name,t),this.parentFragment.cssIds&&this.node.setAttribute("data-ractive-css",this.parentFragment.cssIds.map(function(t){return"{"+t+"}"}).join(" ")),ba(this.node,"_ractive",{value:{proxy:this,keypath:ah(this.parentFragment),events:wa(null),root:o}}),this.attributes.forEach(function(t){return t.render(e)}),this.conditionalAttributes.forEach(function(t){return t.render(e)}),this.fragment&&("script"===this.name?(this.bubble=dv,this.node.text=this.fragment.toString(!1),this.fragment.unrender=Aa):"style"===this.name?(this.bubble=cv,this.bubble(),this.fragment.unrender=Aa):this.binding&&this.getAttribute("contenteditable")?this.fragment.unrender=Aa:this.node.appendChild(this.fragment.render())),this.binding&&(this.binding.render(),this.node._ractive.binding=this.binding),this.eventHandlers&&this.eventHandlers.forEach(function(t){return t.render()}),"option"===this.name&&Ko(this),"img"===this.name?Io(this):"form"===this.name?Bo(this):"input"===this.name||"textarea"===this.name?this.node.defaultValue=this.node.value:"option"===this.name&&(this.node.defaultSelected=this.node.selected),this.decorator&&this.decorator.fn&&mh.scheduleTask(function(){i.decorator.torndown||i.decorator.init()},!0),o.transitionsEnabled&&this.intro&&(n=new pv(this,this.intro,!0),mh.registerTransition(n),mh.scheduleTask(function(){return n.start()},!0),this.transition=n),this.node.autofocus&&mh.scheduleTask(function(){return i.node.focus()},!0),Jo(this),this.node}function $o(t){var e,n,i;return e=(n=t.getAttribute("xmlns"))?n:"svg"===t.name?ia.svg:(i=t.parent)?"foreignObject"===i.name?ia.html:i.node.namespaceURI:t.root.el.namespaceURI}function Ko(t){var e,n,i;if(t.select&&(n=t.select.getAttribute("value"),void 0!==n))if(e=t.getAttribute("value"),t.select.node.multiple&&r(n)){for(i=n.length;i--;)if(e==n[i]){t.node.selected=!0;break}}else t.node.selected=e==n}function Jo(t){var e,n,i,o,r;e=t.root;do for(n=e._liveQueries,i=n.length;i--;)o=n[i],r=n["_"+o],r._test(t)&&(t.liveQueries||(t.liveQueries=[])).push(r);while(e=e.parent)}function Yo(t){var e,n,i;if(e=t.getAttribute("value"),void 0===e||!t.select)return!1;if(n=t.select.getAttribute("value"),n==e)return!0;if(t.select.getAttribute("multiple")&&r(n))for(i=n.length;i--;)if(n[i]==e)return!0}function Qo(t){var e,n,i,o;return e=t.attributes,n=e.type,i=e.value,o=e.name,n&&"radio"===n.value&&i&&o.interpolator&&i.value===o.interpolator.value?!0:void 0}function Xo(t){var e=t.toString();return e?" "+e:""}function tr(){this.fragment&&this.fragment.unbind(),this.binding&&this.binding.unbind(),this.eventHandlers&&this.eventHandlers.forEach(q),"option"===this.name&&Ao(this),this.attributes.forEach(q),this.conditionalAttributes.forEach(q)}function er(t){var e,n,i;(i=this.transition)&&i.complete(),"option"===this.name?this.detach():t&&mh.detachWhenReady(this),this.fragment&&this.fragment.unrender(!1),(e=this.binding)&&(this.binding.unrender(),this.node._ractive.binding=null,n=this.root._twowayBindings[e.keypath.str],n.splice(n.indexOf(e),1)),this.eventHandlers&&this.eventHandlers.forEach($),this.decorator&&mh.registerDecorator(this.decorator),this.root.transitionsEnabled&&this.outro&&(i=new pv(this,this.outro,!1),mh.registerTransition(i),mh.scheduleTask(function(){return i.start()})),this.liveQueries&&nr(this),"form"===this.name&&zo(this)}function nr(t){var e,n,i;for(i=t.liveQueries.length;i--;)e=t.liveQueries[i],n=e.selector,e._remove(t.node)}function ir(t,e){var n=bv.exec(e)[0];return null===t||n.length<t.length?n:t}function or(t,e,n){var i;if(i=rr(t,e,n||{}))return i;if(i=sp.fromId(e,{
noThrow:!0})){i=xv(i);var o=sp.parse(i,sp.getParseOptions(t));return t.partials[e]=o.t}}function rr(t,e,n){var i=void 0,o=hr(e,n.owner);if(o)return o;var r=_("partials",t,e);if(r){if(o=r.partials[e],"function"==typeof o&&(i=o.bind(r),i.isOwner=r.partials.hasOwnProperty(e),o=i.call(t,sp)),!o&&""!==o)return void m(Ra,e,"partial","partial",{ractive:t});if(!sp.isParsed(o)){var s=sp.parse(o,sp.getParseOptions(r));s.p&&m("Partials ({{>%s}}) cannot contain nested inline partials",e,{ractive:t});var a=i?r:sr(r,e);a.partials[e]=o=s.t}return i&&(o._fn=i),o.v?o.t:o}}function sr(t,e){return t.partials.hasOwnProperty(e)?t:ar(t.constructor,e)}function ar(t,e){return t?t.partials.hasOwnProperty(e)?t:ar(t._Parent,e):void 0}function hr(t,e){if(e){if(e.template&&e.template.p&&e.template.p[t])return e.template.p[t];if(e.parentFragment&&e.parentFragment.owner)return hr(t,e.parentFragment.owner)}}function lr(t,e){var n,i=_("components",t,e);if(i&&(n=i.components[e],!n._Parent)){var o=n.bind(i);if(o.isOwner=i.components.hasOwnProperty(e),n=o(),!n)return void m(Ra,e,"component","component",{ractive:t});"string"==typeof n&&(n=lr(t,n)),n._fn=o,i.components[e]=n}return n}function ur(){var t=this.instance.fragment.detach();return Ov.fire(this.instance),t}function cr(t){return this.instance.fragment.find(t)}function dr(t,e){return this.instance.fragment.findAll(t,e)}function pr(t,e){e._test(this,!0),this.instance.fragment&&this.instance.fragment.findAllComponents(t,e)}function fr(t){return t&&t!==this.name?this.instance.fragment?this.instance.fragment.findComponent(t):null:this.instance}function mr(){return this.parentFragment.findNextNode(this)}function gr(){return this.rendered?this.instance.fragment.firstNode():null}function vr(t,e,n){function i(t){var n,i;t.value=e,t.updating||(i=t.ractive,n=t.keypath,t.updating=!0,mh.start(i),i.viewmodel.mark(n),mh.end(),t.updating=!1)}var o,r,s,a,h,l;if(o=t.obj,r=t.prop,n&&!n.configurable){if("length"===r)return;throw new Error('Cannot use magic mode with property "'+r+'" - object is not configurable')}n&&(s=n.get,a=n.set),h=s||function(){return e},l=function(t){a&&a(t),e=s?s():t,l._ractiveWrappers.forEach(i)},l._ractiveWrappers=[t],Object.defineProperty(o,r,{get:h,set:l,enumerable:!0,configurable:!0})}function _r(t,e){var n,i,o,r;if(this.adaptors)for(n=this.adaptors.length,i=0;n>i;i+=1)if(o=this.adaptors[i],o.filter(e,t,this.ractive))return r=this.wrapped[t]=o.wrap(this.ractive,e,t,wr(t)),void(r.value=e)}function yr(t,e){var n,i={};if(!e)return t;e+=".";for(n in t)t.hasOwnProperty(n)&&(i[e+n]=t[n]);return i}function wr(t){var e;return i_[t]||(e=t?t+".":"",i_[t]=function(n,i){var o;return"string"==typeof n?(o={},o[e+n]=i,o):"object"==typeof n?e?yr(n,t):n:void 0}),i_[t]}function br(t){var e,n,i=[qa];for(e=t.length;e--;)for(n=t[e].parent;n&&!n.isRoot;)-1===t.indexOf(n)&&A(i,n),n=n.parent;return i}function xr(t,e,n){var i;Pr(t,e),n||(i=e.wildcardMatches(),i.forEach(function(n){Lr(t,n,e)}))}function Lr(t,e,n){var i,o,r;e=e.str||e,i=t.depsMap.patternObservers,o=i&&i[e],o&&o.forEach(function(e){r=n.join(e.lastKey),Pr(t,r),Lr(t,e,r)})}function Pr(t,e){t.patternObservers.forEach(function(t){t.regex.test(e.str)&&t.update(e)})}function Er(){function t(t){var i=t.key;t.viewmodel===s?(s.clearCache(i.str),t.invalidate(),n.push(i),e(i)):t.viewmodel.mark(i)}function e(n){var i,o;s.noCascade.hasOwnProperty(n.str)||((o=s.deps.computed[n.str])&&o.forEach(t),(i=s.depsMap.computed[n.str])&&i.forEach(e))}var n,i,o,r=this,s=this,a={};return n=this.changes,n.length?(n.slice().forEach(e),i=o_(n),i.forEach(function(e){var i;-1===n.indexOf(e)&&(i=s.deps.computed[e.str])&&i.forEach(t)}),this.changes=[],this.patternObservers.length&&(i.forEach(function(t){return r_(r,t,!0)}),n.forEach(function(t){return r_(r,t)})),this.deps.observers&&(i.forEach(function(t){return kr(r,null,t,"observers")}),Tr(this,n,"observers")),this.deps["default"]&&(o=[],i.forEach(function(t){return kr(r,o,t,"default")}),o.length&&Cr(this,o,n),Tr(this,n,"default")),n.forEach(function(t){a[t.str]=r.get(t)}),this.implicitChanges={},this.noCascade={},a):void 0}function kr(t,e,n,i){var o,r;(o=Mr(t,n,i))&&(r=t.get(n),o.forEach(function(t){e&&t.refineValue?e.push(t):t.setValue(r)}))}function Cr(t,e,n){e.forEach(function(e){for(var i=!1,o=0,r=n.length,s=[];r>o;){var a=n[o];if(a===e.keypath){i=!0;break}a.slice(0,e.keypath.length)===e.keypath&&s.push(a),o++}i&&e.setValue(t.get(e.keypath)),s.length&&e.refineValue(s)})}function Tr(t,e,n){function i(t){t.forEach(o),t.forEach(r)}function o(e){var i=Mr(t,e,n);i&&a.push({keypath:e,deps:i})}function r(e){var o;(o=t.depsMap[n][e.str])&&i(o)}function s(e){var n=t.get(e.keypath);e.deps.forEach(function(t){return t.setValue(n)})}var a=[];i(e),a.forEach(s)}function Mr(t,e,n){var i=t.deps[n];return i?i[e.str]:null}function Sr(){this.captureGroups.push([])}function Ar(t,e){var n,i;if(e||(i=this.wrapped[t])&&i.teardown()!==!1&&(this.wrapped[t]=null),this.cache[t]=void 0,n=this.cacheMap[t])for(;n.length;)this.clearCache(n.pop())}function Dr(t,e){var n=e.firstKey;return!(n in t.data||n in t.computations||n in t.mappings)}function Or(t,e){var n=new d_(t,e);return this.ready&&n.init(this),this.computations[t.str]=n}function Rr(t,e){var n,i,o,r,s,a=this.cache,h=t.str;if(e=e||g_,e.capture&&(r=I(this.captureGroups))&&(~r.indexOf(t)||r.push(t)),Ta.call(this.mappings,t.firstKey))return this.mappings[t.firstKey].get(t,e);if(t.isSpecial)return t.value;if(void 0===a[h]?((i=this.computations[h])&&!i.bypass?(n=i.get(),this.adapt(h,n)):(o=this.wrapped[h])?n=o.value:t.isRoot?(this.adapt("",this.data),n=this.data):n=Ir(this,t),a[h]=n):n=a[h],!e.noUnwrap&&(o=this.wrapped[h])&&(n=o.get()),t.isRoot&&e.fullRootGet)for(s in this.mappings)n[s]=this.mappings[s].getValue();return n===f_?void 0:n}function Ir(t,e){var n,i,o,r;return n=t.get(e.parent),(r=t.wrapped[e.parent.str])&&(n=r.get()),null!==n&&void 0!==n?((i=t.cacheMap[e.parent.str])?-1===i.indexOf(e.str)&&i.push(e.str):t.cacheMap[e.parent.str]=[e.str],"object"!=typeof n||e.lastKey in n?(o=n[e.lastKey],t.adapt(e.str,o,!1),t.cache[e.str]=o,o):t.cache[e.str]=f_):void 0}function Br(){var t;for(t in this.computations)this.computations[t].init(this)}function zr(t,e){var n=this.mappings[t.str]=new y_(t,e);return n.initViewmodel(this),n}function Ur(t,e){var n,i=t.str;e&&(e.implicit&&(this.implicitChanges[i]=!0),e.noCascade&&(this.noCascade[i]=!0)),(n=this.computations[i])&&n.invalidate(),-1===this.changes.indexOf(t)&&this.changes.push(t);var o=e?e.keepExistingWrapper:!1;this.clearCache(i,o),this.ready&&this.onchange()}function Nr(t,e,n,i){var o,r,s,a;if(this.mark(t),i&&i.compare){s=jr(i.compare);try{o=e.map(s),r=n.map(s)}catch(h){m('merge(): "%s" comparison failed. Falling back to identity checking',t),o=e,r=n}}else o=e,r=n;a=b_(o,r),this.smartUpdate(t,n,a,e.length!==n.length)}function Fr(t){return JSON.stringify(t)}function jr(t){if(t===!0)return Fr;if("string"==typeof t)return L_[t]||(L_[t]=function(e){return e[t]}),L_[t];if("function"==typeof t)return t;throw new Error("The `compare` option must be a function, or a string representing an identifying field (or `true` to use JSON.stringify)")}function Zr(t,e){var n,i,o,r=void 0===arguments[2]?"default":arguments[2];e.isStatic||((n=this.mappings[t.firstKey])?n.register(t,e,r):(i=this.deps[r]||(this.deps[r]={}),o=i[t.str]||(i[t.str]=[]),o.push(e),this.depsMap[r]||(this.depsMap[r]={}),t.isRoot||Wr(this,t,r)))}function Wr(t,e,n){for(var i,o,r;!e.isRoot;)i=t.depsMap[n],o=i[e.parent.str]||(i[e.parent.str]=[]),r=e.str,void 0===o["_"+r]&&(o["_"+r]=0,o.push(e)),o["_"+r]+=1,e=e.parent}function Vr(){return this.captureGroups.pop()}function Hr(t){this.data=t,this.clearCache("")}function Gr(t,e){var n,i,o,r,s=void 0===arguments[2]?{}:arguments[2];if(!s.noMapping&&(n=this.mappings[t.firstKey]))return n.set(t,e);if(i=this.computations[t.str]){if(i.setting)return;i.set(e),e=i.get()}a(this.cache[t.str],e)||(o=this.wrapped[t.str],o&&o.reset&&(r=o.reset(e)!==!1,r&&(e=o.get())),i||r||qr(this,t,e),s.silent?this.clearCache(t.str):this.mark(t))}function qr(t,e,n){var i,o,r,s;r=function(){i.set?i.set(e.lastKey,n):(o=i.get(),s())},s=function(){o||(o=Yv(e.lastKey),t.set(e.parent,o,{silent:!0})),o[e.lastKey]=n},i=t.wrapped[e.parent.str],i?r():(o=t.get(e.parent),(i=t.wrapped[e.parent.str])?r():s())}function $r(t,e,n){var i,o,r,s=this;if(o=n.length,n.forEach(function(e,n){-1===e&&s.mark(t.join(n),S_)}),this.set(t,e,{silent:!0}),(i=this.deps["default"][t.str])&&i.filter(Kr).forEach(function(t){return t.shuffle(n,e)}),o!==e.length){for(this.mark(t.join("length"),M_),r=n.touchedFrom;r<e.length;r+=1)this.mark(t.join(r));for(r=e.length;o>r;r+=1)this.mark(t.join(r),S_)}}function Kr(t){return"function"==typeof t.shuffle}function Jr(){var t,e=this;for(Object.keys(this.cache).forEach(function(t){return e.clearCache(t)});t=this.unresolvedImplicitDependencies.pop();)t.teardown()}function Yr(t,e){var n,i,o,r=void 0===arguments[2]?"default":arguments[2];if(!e.isStatic){if(n=this.mappings[t.firstKey])return n.unregister(t,e,r);if(i=this.deps[r][t.str],o=i.indexOf(e),-1===o)throw new Error("Attempted to remove a dependant that was no longer registered! This should not happen. If you are seeing this bug in development please raise an issue at https://github.com/RactiveJS/Ractive/issues - thanks");i.splice(o,1),t.isRoot||Qr(this,t,r)}}function Qr(t,e,n){for(var i,o;!e.isRoot;)i=t.depsMap[n],o=i[e.parent.str],o["_"+e.str]-=1,o["_"+e.str]||(B(o,e),o["_"+e.str]=void 0),e=e.parent}function Xr(t){this.hook=new nh(t),this.inProcess={},this.queue={}}function ts(t,e){return t[e._guid]||(t[e._guid]=[])}function es(t,e){var n=ts(t.queue,e);for(t.hook.fire(e);n.length;)es(t,n.shift());delete t.queue[e._guid]}function ns(t,e){var n,i={};for(n in e)i[n]=is(t,n,e[n]);return i}function is(t,e,n){var i,o;return"function"==typeof n&&(i=rs(n,t)),"string"==typeof n&&(i=os(t,n)),"object"==typeof n&&("string"==typeof n.get?i=os(t,n.get):"function"==typeof n.get?i=rs(n.get,t):c("`%s` computation must have a `get()` method",e),"function"==typeof n.set&&(o=rs(n.set,t))),{getter:i,setter:o}}function os(t,e){var n,i,o;return n="return ("+e.replace(z_,function(t,e){return i=!0,'__ractive.get("'+e+'")'})+");",i&&(n="var __ractive = this; "+n),o=new Function(n),i?o.bind(t):o}function rs(t,e){return/this/.test(t.toString())?t.bind(e):t}function ss(e){var n,o,r=void 0===arguments[1]?{}:arguments[1],s=void 0===arguments[2]?{}:arguments[2];if(Gy.DEBUG&&Ca(),ls(e,s),ba(e,"data",{get:us}),U_.fire(e,r),Z_.forEach(function(t){e[t]=i(wa(e.constructor[t]||null),r[t])}),o=new R_({adapt:as(e,e.adapt,r),data:jl.init(e.constructor,e,r),computed:B_(e,i(wa(e.constructor.prototype.computed),r.computed)),mappings:s.mappings,ractive:e,onchange:function(){return mh.addRactive(e)}}),e.viewmodel=o,o.init(),_p.init(e.constructor,e,r),N_.fire(e),F_.begin(e),e.template){var a=void 0;(s.cssIds||e.cssId)&&(a=s.cssIds?s.cssIds.slice():[],e.cssId&&a.push(e.cssId)),e.fragment=new _y({template:e.template,root:e,owner:e,cssIds:a})}if(F_.end(e),n=t(e.el)){var h=e.render(n,e.append);Gy.DEBUG_PROMISES&&h["catch"](function(t){throw g("Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\n  Ractive.DEBUG_PROMISES = false;"),m("An error happened during rendering",{ractive:e}),t.stack&&d(t.stack),t})}}function as(t,e,n){function i(e){return"string"==typeof e&&(e=v("adaptors",t,e),e||c(Ia(e,"adaptor"))),e}var o,r,s;if(e=e.map(i),o=R(n.adapt).map(i),o=hs(e,o),r="magic"in n?n.magic:t.magic,s="modifyArrays"in n?n.modifyArrays:t.modifyArrays,r){if(!na)throw new Error("Getters and setters (magic mode) are not supported in this browser");s&&o.push(e_),o.push(t_)}return s&&o.push(Kv),o}function hs(t,e){for(var n=t.slice(),i=e.length;i--;)~n.indexOf(e[i])||n.push(e[i]);return n}function ls(t,e){t._guid="r-"+j_++,t._subs=wa(null),t._config={},t._twowayBindings=wa(null),t._animations=[],t.nodes={},t._liveQueries=[],t._liveComponentQueries=[],t._boundFunctions=[],t._observers=[],e.component?(t.parent=e.parent,t.container=e.container||null,t.root=t.parent.root,t.component=e.component,e.component.instance=t,t._inlinePartials=e.inlinePartials):(t.root=t,t.parent=t.container=null)}function us(){throw new Error("Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead")}function cs(t,e,n){this.parentFragment=t.parentFragment,this.callback=n,this.fragment=new _y({template:e,root:t.root,owner:this}),this.update()}function ds(t,e,n){var i;return e.r?i=Hp(t,e.r,n):e.x?i=new Kp(t,t.parentFragment,e.x,n):e.rx&&(i=new Xp(t,e.rx,n)),i}function ps(t){return 1===t.length&&t[0].t===$l}function fs(t,e){var n;for(n in e)e.hasOwnProperty(n)&&ms(t.instance,t.root,n,e[n])}function ms(t,e,n,i){"string"!=typeof i&&c("Components currently only support simple events - you cannot include arguments. Sorry!"),t.on(n,function(){var t,n;return arguments.length&&arguments[0]&&arguments[0].node&&(t=Array.prototype.shift.call(arguments)),n=Array.prototype.slice.call(arguments),jh(e,i,{event:t,args:n}),!1})}function gs(t,e){var n,i;if(!e)throw new Error('Component "'+this.name+'" not found');n=this.parentFragment=t.parentFragment,i=n.root,this.root=i,this.type=ru,this.name=t.template.e,this.index=t.index,this.indexRefBindings={},this.yielders={},this.resolvers=[],H_(this,e,t.template.a,t.template.f,t.template.p),G_(this,t.template.v),(t.template.t0||t.template.t1||t.template.t2||t.template.o)&&m('The "intro", "outro" and "decorator" directives have no effect on components',{ractive:this.instance}),q_(this)}function vs(t,e){function n(n){n.rebind(t,e)}var i;this.resolvers.forEach(n);for(var o in this.yielders)this.yielders[o][0]&&n(this.yielders[o][0]);(i=this.root._liveComponentQueries["_"+this.name])&&i._makeDirty()}function _s(){var t=this.instance;return t.render(this.parentFragment.getNode()),this.rendered=!0,t.fragment.detach()}function ys(){return this.instance.fragment.toString()}function ws(){var t=this.instance;this.resolvers.forEach(q),bs(this),t._observers.forEach(K),t.fragment.unbind(),t.viewmodel.teardown(),t.fragment.rendered&&t.el.__ractive_instances__&&B(t.el.__ractive_instances__,t),X_.fire(t)}function bs(t){var e,n;e=t.root;do(n=e._liveComponentQueries["_"+t.name])&&n._remove(t);while(e=e.parent)}function xs(t){this.shouldDestroy=t,this.instance.unrender()}function Ls(t){var e=this;this.owner=t.owner,this.parent=this.owner.parentFragment,this.root=t.root,this.pElement=t.pElement,this.context=t.context,this.index=t.index,this.key=t.key,this.registeredIndexRefs=[],this.cssIds="cssIds"in t?t.cssIds:this.parent?this.parent.cssIds:null,this.items=t.template.map(function(n,i){return Ps({parentFragment:e,pElement:t.pElement,template:n,index:i})}),this.value=this.argsList=null,this.dirtyArgs=this.dirtyValue=!0,this.bound=!0}function Ps(t){if("string"==typeof t.template)return new Op(t);switch(t.template.t){case su:return new sy(t);case $l:return new sf(t);case Jl:return new kf(t);case Kl:return new Vf(t);case Xl:var e=void 0;return(e=Av(t.parentFragment.root,t.template.e))?new ny(t,e):new yv(t);case tu:return new Sv(t);case eu:return new oy(t);case hu:return new hy(t);default:throw new Error("Something very strange happened. Please file an issue at https://github.com/ractivejs/ractive/issues. Thanks!")}}function Es(t,e){(!this.owner||this.owner.hasContext)&&x(this,"context",t,e),this.items.forEach(function(n){n.rebind&&n.rebind(t,e)})}function ks(){var t;return 1===this.items.length?t=this.items[0].render():(t=document.createDocumentFragment(),this.items.forEach(function(e){t.appendChild(e.render())})),this.rendered=!0,t}function Cs(t){return this.items?this.items.map(t?Ms:Ts).join(""):""}function Ts(t){return t.toString()}function Ms(t){return t.toString(!0)}function Ss(){this.bound&&(this.items.forEach(As),this.bound=!1)}function As(t){t.unbind&&t.unbind()}function Ds(t){if(!this.rendered)throw new Error("Attempted to unrender a fragment that was not rendered");this.items.forEach(function(e){return e.unrender(t)}),this.rendered=!1}function Os(t){var e,n,i,o,r;if(t=t||{},"object"!=typeof t)throw new Error("The reset method takes either no arguments, or an object containing new data");for((n=this.viewmodel.wrapped[""])&&n.reset?n.reset(t)===!1&&this.viewmodel.reset(t):this.viewmodel.reset(t),i=_p.reset(this),o=i.length;o--;)if(wy.indexOf(i[o])>-1){r=!0;break}if(r){var s=void 0;this.viewmodel.mark(qa),(s=this.component)&&(s.shouldDestroy=!0),this.unrender(),s&&(s.shouldDestroy=!1),this.fragment.template!==this.template&&(this.fragment.unbind(),this.fragment=new _y({template:this.template,root:this,owner:this})),e=this.render(this.el,this.anchor)}else e=mh.start(this,!0),this.viewmodel.mark(qa),mh.end();return by.fire(this,t),e}function Rs(t){var e,n;hp.init(null,this,{template:t}),e=this.transitionsEnabled,this.transitionsEnabled=!1,(n=this.component)&&(n.shouldDestroy=!0),this.unrender(),n&&(n.shouldDestroy=!1),this.fragment.unbind(),this.fragment=new _y({template:this.template,root:this,owner:this}),this.render(this.el,this.anchor),this.transitionsEnabled=e}function Is(t,e){var n,i;if(i=mh.start(this,!0),l(t)){n=t;for(t in n)n.hasOwnProperty(t)&&(e=n[t],Bs(this,t,e))}else Bs(this,t,e);return mh.end(),i}function Bs(t,e,n){e=P(C(e)),e.isPattern?E(t,e).forEach(function(e){t.viewmodel.set(e,n)}):t.viewmodel.set(e,n)}function zs(t,e){return $a(this,t,void 0===e?-1:-e)}function Us(){var t;return this.fragment.unbind(),this.viewmodel.teardown(),this._observers.forEach(K),this.fragment.rendered&&this.el.__ractive_instances__&&B(this.el.__ractive_instances__,this),this.shouldDestroy=!0,t=this.fragment.rendered?this.unrender():sh.resolve(),Ay.fire(this),this._boundFunctions.forEach(Ns),t}function Ns(t){delete t.fn[t.prop]}function Fs(t){var e=this;if("string"!=typeof t)throw new TypeError(Oa);var n=void 0;return/\*/.test(t)?(n={},E(this,P(C(t))).forEach(function(t){n[t.str]=!e.viewmodel.get(t)}),this.set(n)):this.set(t,!this.get(t))}function js(){return this.fragment.toString(!0)}function Zs(){var t,e;if(!this.fragment.rendered)return m("ractive.unrender() was called on a Ractive instance that was not rendered"),sh.resolve();for(t=mh.start(this,!0),e=!this.component||this.component.shouldDestroy||this.shouldDestroy;this._animations[0];)this._animations[0].stop();return this.fragment.unrender(e),B(this.el.__ractive_instances__,this),Iy.fire(this),mh.end(),t}function Ws(t){var e;return t=P(t)||qa,e=mh.start(this,!0),this.viewmodel.mark(t),mh.end(),Uy.fire(this,t),e}function Vs(t,e){var n,i,o;if("string"!=typeof t||e){o=[];for(i in this._twowayBindings)(!t||P(i).equalsOrStartsWith(t))&&o.push.apply(o,this._twowayBindings[i])}else o=this._twowayBindings[t];return n=Hs(this,o),this.set(n)}function Hs(t,e){var n={},i=[];return e.forEach(function(t){var e,o;if(!t.radioName||t.element.node.checked){if(t.checkboxName)return void(i[t.keypath.str]||t.changed()||(i.push(t.keypath),i[t.keypath.str]=t));e=t.attribute.value,o=t.getValue(),O(e,o)||a(e,o)||(n[t.keypath.str]=o)}}),i.length&&i.forEach(function(t){var e,o,r;e=i[t.str],o=e.attribute.value,r=e.getValue(),O(o,r)||(n[t.str]=r)}),n}function Gs(t,e){return"function"==typeof e&&/_super/.test(t)}function qs(t){for(var e={};t;)$s(t,e),Js(t,e),t=t._Parent!==Gy?t._Parent:!1;return e}function $s(t,e){mp.forEach(function(n){Ks(n.useDefaults?t.prototype:t,e,n.name)})}function Ks(t,e,n){var i,o=Object.keys(t[n]);o.length&&((i=e[n])||(i=e[n]={}),o.filter(function(t){return!(t in i)}).forEach(function(e){return i[e]=t[n][e]}))}function Js(t,e){Object.keys(t.prototype).forEach(function(n){if("computed"!==n){var i=t.prototype[n];if(n in e){if("function"==typeof e[n]&&"function"==typeof i&&e[n]._method){var o=void 0,r=i._method;r&&(i=i._method),o=jy(e[n]._method,i),r&&(o._method=o),e[n]=o}}else e[n]=i._method?i._method:i}})}function Ys(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return e.length?e.reduce(Qs,this):Qs(this)}function Qs(t){var e,n,o=void 0===arguments[1]?{}:arguments[1];return o.prototype instanceof Gy&&(o=Zy(o)),e=function(t){return this instanceof e?void W_(this,t):new e(t)},n=wa(t.prototype),n.constructor=e,xa(e,{defaults:{value:n},extend:{value:Ys,writable:!0,configurable:!0},_Parent:{value:t}}),_p.extend(t,n,o),jl.extend(t,n,o),o.computed&&(n.computed=i(wa(t.prototype.computed),o.computed)),e.prototype=n,e}var Xs,ta,ea,na,ia,oa,ra,sa=3,aa={el:void 0,append:!1,template:{v:sa,t:[]},preserveWhitespace:!1,sanitize:!1,stripComments:!0,delimiters:["{{","}}"],tripleDelimiters:["{{{","}}}"],interpolate:!1,data:{},computed:{},magic:!1,modifyArrays:!0,adapt:[],isolated:!1,twoway:!0,lazy:!1,noIntro:!1,transitionsEnabled:!0,complete:void 0,css:null,noCssTransform:!1},ha=aa,la={linear:function(t){return t},easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return Math.pow(t-1,3)+1},easeInOut:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)}};Xs="object"==typeof document,ta="undefined"!=typeof navigator&&/jsDom/.test(navigator.appName),ea="undefined"!=typeof console&&"function"==typeof console.warn&&"function"==typeof console.warn.apply;try{Object.defineProperty({},"test",{value:0}),na=!0}catch(ua){na=!1}ia={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},oa="undefined"==typeof document?!1:document&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),ra=["o","ms","moz","webkit"];var ca,da,pa,fa,ma,ga,va,_a,ya;if(ca=oa?function(t,e){return e&&e!==ia.html?document.createElementNS(e,t):document.createElement(t)}:function(t,e){if(e&&e!==ia.html)throw"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information";return document.createElement(t)},Xs){for(pa=ca("div"),fa=["matches","matchesSelector"],ya=function(t){return function(e,n){return e[t](n)}},va=fa.length;va--&&!da;)if(ma=fa[va],pa[ma])da=ya(ma);else for(_a=ra.length;_a--;)if(ga=ra[va]+ma.substr(0,1).toUpperCase()+ma.substring(1),pa[ga]){da=ya(ga);break}da||(da=function(t,e){var n,i,o;for(i=t.parentNode,i||(pa.innerHTML="",i=pa,t=t.cloneNode(),pa.appendChild(t)),n=i.querySelectorAll(e),o=n.length;o--;)if(n[o]===t)return!0;return!1})}else da=null;var wa,ba,xa,La=null;try{Object.defineProperty({},"test",{value:0}),Xs&&Object.defineProperty(document.createElement("div"),"test",{value:0}),ba=Object.defineProperty}catch(Pa){ba=function(t,e,n){t[e]=n.value}}try{try{Object.defineProperties({},{test:{value:0}})}catch(Pa){throw Pa}Xs&&Object.defineProperties(ca("div"),{test:{value:0}}),xa=Object.defineProperties}catch(Pa){xa=function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&ba(t,n,e[n])}}try{Object.create(null),wa=Object.create}catch(Pa){wa=function(){var t=function(){};return function(e,n){var i;return null===e?{}:(t.prototype=e,i=new t,n&&Object.defineProperties(i,n),i)}}()}var Ea,ka,Ca,Ta=Object.prototype.hasOwnProperty,Ma=Object.prototype.toString,Sa=/^\[object (?:Array|FileList)\]$/,Aa=function(){},Da={};ea?!function(){var t=["%cRactive.js %c0.7.3 %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"],e="You're running Ractive 0.7.3 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://docs.ractivejs.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n";Ca=function(){var n=!!console.groupCollapsed;console[n?"groupCollapsed":"log"].apply(console,t),console.log(e),n&&console.groupEnd(t),Ca=Aa},ka=function(t,e){if(Ca(),"object"==typeof e[e.length-1]){var n=e.pop(),i=n?n.ractive:null;if(i){var o=void 0;i.component&&(o=i.component.name)&&(t="<"+o+"> "+t);var r=void 0;(r=n.node||i.fragment&&i.fragment.rendered&&i.find("*"))&&e.push(r)}}console.warn.apply(console,["%cRactive.js: %c"+t,"color: rgb(114, 157, 52);","color: rgb(85, 85, 85);"].concat(e))},Ea=function(){console.log.apply(console,arguments)}}():ka=Ea=Ca=Aa;var Oa="Bad arguments",Ra='A function was specified for "%s" %s, but no %s was returned',Ia=function(t,e){return'Missing "'+t+'" '+e+" plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#"+e+"s"},Ba=function(t,e,n,i){if(t===e)return y(e);if(i){var o=v("interpolators",n,i);if(o)return o(t,e)||y(e);c(Ia(i,"interpolator"))}return Na.number(t,e)||Na.array(t,e)||Na.object(t,e)||y(e)},za=Ba,Ua={number:function(t,e){var n;return h(t)&&h(e)?(t=+t,e=+e,n=e-t,n?function(e){return t+e*n}:function(){return t}):null},array:function(t,e){var n,i,o,s;if(!r(t)||!r(e))return null;for(n=[],i=[],s=o=Math.min(t.length,e.length);s--;)i[s]=za(t[s],e[s]);for(s=o;s<t.length;s+=1)n[s]=t[s];for(s=o;s<e.length;s+=1)n[s]=e[s];return function(t){for(var e=o;e--;)n[e]=i[e](t);return n}},object:function(t,e){var n,i,o,r,s;if(!l(t)||!l(e))return null;n=[],r={},o={};for(s in t)Ta.call(t,s)&&(Ta.call(e,s)?(n.push(s),o[s]=za(t[s],e[s])):r[s]=t[s]);for(s in e)Ta.call(e,s)&&!Ta.call(t,s)&&(r[s]=e[s]);return i=n.length,function(t){for(var e,s=i;s--;)e=n[s],r[e]=o[e](t);return r}}},Na=Ua,Fa=w,ja={},Za=/\[\s*(\*|[0-9]|[1-9][0-9]+)\s*\]/g,Wa=/\*/,Va={},Ha=function(t){var e=t.split(".");this.str=t,"@"===t[0]&&(this.isSpecial=!0,this.value=L(t)),this.firstKey=e[0],this.lastKey=e.pop(),this.isPattern=Wa.test(t),this.parent=""===t?null:P(e.join(".")),this.isRoot=!t};Ha.prototype={equalsOrStartsWith:function(t){return t===this||this.startsWith(t)},join:function(t){return P(this.isRoot?String(t):this.str+"."+t)},replace:function(t,e){return this===t?e:this.startsWith(t)?null===e?e:P(this.str.replace(t.str+".",e.str+".")):void 0},startsWith:function(t){return t?t&&this.str.substr(0,t.str.length+1)===t.str+".":!1},toString:function(){throw new Error("Bad coercion")},valueOf:function(){throw new Error("Bad coercion")},wildcardMatches:function(){return this._wildcardMatches||(this._wildcardMatches=Fa(this.str))}};var Ga,qa=P(""),$a=T,Ka="Cannot add to a non-numeric value",Ja=M;"undefined"==typeof window?Ga=null:(!function(t,e,n){var i,o;if(!n.requestAnimationFrame){for(i=0;i<t.length&&!n.requestAnimationFrame;++i)n.requestAnimationFrame=n[t[i]+"RequestAnimationFrame"];n.requestAnimationFrame||(o=n.setTimeout,n.requestAnimationFrame=function(t){var n,i,r;return n=Date.now(),i=Math.max(0,16-(n-e)),r=o(function(){t(n+i)},i),e=n+i,r})}}(ra,0,window),Ga=window.requestAnimationFrame);var Ya,Qa=Ga;Ya="undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};var Xa=Ya,th={construct:{deprecated:"beforeInit",replacement:"onconstruct"},render:{deprecated:"init",message:'The "init" method has been deprecated and will likely be removed in a future release. You can either use the "oninit" method which will fire only once prior to, and regardless of, any eventual ractive instance being rendered, or if you need to access the rendered DOM, use "onrender" instead. See http://docs.ractivejs.org/latest/migrating for more information.'},complete:{deprecated:"complete",replacement:"oncomplete"}};S.prototype.fire=function(t,e){function n(n){return t[n]?(e?t[n](e):t[n](),!0):void 0}n(this.method),!t[this.method]&&this.deprecate&&n(this.deprecate.deprecated)&&(this.deprecate.message?m(this.deprecate.message):m('The method "%s" has been deprecated in favor of "%s" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.',this.deprecate.deprecated,this.deprecate.replacement)),e?t.fire(this.event,e):t.fire(this.event)};var eh,nh=S,ih={},oh={},rh={};"function"==typeof Promise?eh=Promise:(eh=function(t){var e,n,i,o,r,s,a=[],h=[],l=ih;i=function(t){return function(i){l===ih&&(e=i,l=t,n=N(l===oh?a:h,e),U(n))}},o=i(oh),r=i(rh);try{t(o,r)}catch(u){r(u)}return s={then:function(t,e){var i=new eh(function(o,r){var s=function(t,e,n){"function"==typeof t?e.push(function(e){var n;try{n=t(e),F(i,n,o,r)}catch(s){r(s)}}):e.push(n)};s(t,a,o),s(e,h,r),l!==ih&&U(n)});return i}},s["catch"]=function(t){return this.then(null,t)},s},eh.all=function(t){return new eh(function(e,n){var i,o,r,s=[];if(!t.length)return void e(s);for(r=function(t,o){t&&"function"==typeof t.then?t.then(function(t){s[o]=t,--i||e(s)},n):(s[o]=t,--i||e(s))},i=o=t.length;o--;)r(t[o],o)})},eh.resolve=function(t){return new eh(function(e){e(t)})},eh.reject=function(t){return new eh(function(e,n){n(t)})});var sh=eh,ah=function(t){do if(void 0!==t.context)return t.context;while(t=t.parent);return qa},hh=j,lh=function(t,e){this.callback=t,this.parent=e,this.intros=[],this.outros=[],this.children=[],this.totalChildren=this.outroChildren=0,this.detachQueue=[],this.decoratorQueue=[],this.outrosComplete=!1,e&&e.addChild(this)};lh.prototype={addChild:function(t){this.children.push(t),this.totalChildren+=1,this.outroChildren+=1},decrementOutros:function(){this.outroChildren-=1,Q(this)},decrementTotal:function(){this.totalChildren-=1,Q(this)},add:function(t){var e=t.isIntro?this.intros:this.outros;e.push(t)},addDecorator:function(t){this.decoratorQueue.push(t)},remove:function(t){var e=t.isIntro?this.intros:this.outros;B(e,t),Q(this)},init:function(){this.ready=!0,Q(this)},detachNodes:function(){this.decoratorQueue.forEach(G),this.detachQueue.forEach(J),this.children.forEach(Y)}};var uh,ch,dh=lh,ph=[],fh=new nh("change");ch={start:function(t,e){var n,i;return e&&(n=new sh(function(t){return i=t})),uh={previousBatch:uh,transitionManager:new dh(i,uh&&uh.transitionManager),views:[],tasks:[],ractives:[],instance:t},t&&uh.ractives.push(t),n},end:function(){X(),uh.transitionManager.init(),!uh.previousBatch&&uh.instance&&(uh.instance.viewmodel.changes=[]),uh=uh.previousBatch},addRactive:function(t){uh&&A(uh.ractives,t)},registerTransition:function(t){t._manager=uh.transitionManager,uh.transitionManager.add(t)},registerDecorator:function(t){uh.transitionManager.addDecorator(t)},addView:function(t){uh.views.push(t)},addUnresolved:function(t){ph.push(t)},removeUnresolved:function(t){B(ph,t)},detachWhenReady:function(t){uh.transitionManager.detachQueue.push(t)},scheduleTask:function(t,e){var n;if(uh){for(n=uh;e&&n.previousBatch;)n=n.previousBatch;n.tasks.push(t)}else t()}};var mh=ch,gh=[],vh={tick:function(){var t,e,n;for(n=Xa(),mh.start(),t=0;t<gh.length;t+=1)e=gh[t],e.tick(n)||gh.splice(t--,1);mh.end(),gh.length?Qa(vh.tick):vh.running=!1},add:function(t){gh.push(t),vh.running||(vh.running=!0,Qa(vh.tick))},abort:function(t,e){for(var n,i=gh.length;i--;)n=gh[i],n.root===e&&n.keypath===t&&n.stop()}},_h=vh,yh=function(t){var e;this.startTime=Date.now();for(e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this.interpolator=za(this.from,this.to,this.root,this.interpolator),this.running=!0,this.tick()};yh.prototype={tick:function(){var t,e,n,i,o,r;return r=this.keypath,this.running?(i=Date.now(),t=i-this.startTime,t>=this.duration?(null!==r&&(mh.start(this.root),this.root.viewmodel.set(r,this.to),mh.end()),this.step&&this.step(1,this.to),this.complete(this.to),o=this.root._animations.indexOf(this),-1===o&&m("Animation was not found"),this.root._animations.splice(o,1),
this.running=!1,!1):(e=this.easing?this.easing(t/this.duration):t/this.duration,null!==r&&(n=this.interpolator(e),mh.start(this.root),this.root.viewmodel.set(r,n),mh.end()),this.step&&this.step(e,n),!0)):!1},stop:function(){var t;this.running=!1,t=this.root._animations.indexOf(this),-1===t&&m("Animation was not found"),this.root._animations.splice(t,1)}};var wh=yh,bh=nt,xh={stop:Aa},Lh=ot,Ph=new nh("detach"),Eh=rt,kh=st,Ch=function(){var t,e,n;t=this._root[this._isComponentQuery?"liveComponentQueries":"liveQueries"],e=this.selector,n=t.indexOf(e),-1!==n&&(t.splice(n,1),t[e]=null)},Th=function(t,e){var n,i,o,r,s,a,h,l,u,c;for(n=ht(t.component||t._ractive.proxy),i=ht(e.component||e._ractive.proxy),o=I(n),r=I(i);o&&o===r;)n.pop(),i.pop(),s=o,o=I(n),r=I(i);if(o=o.component||o,r=r.component||r,u=o.parentFragment,c=r.parentFragment,u===c)return a=u.items.indexOf(o),h=c.items.indexOf(r),a-h||n.length-i.length;if(l=s.fragments)return a=l.indexOf(u),h=l.indexOf(c),a-h||n.length-i.length;throw new Error("An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/RactiveJS/Ractive/issues - thanks!")},Mh=function(t,e){var n;return t.compareDocumentPosition?(n=t.compareDocumentPosition(e),2&n?1:-1):Th(t,e)},Sh=function(){this.sort(this._isComponentQuery?Th:Mh),this._dirty=!1},Ah=function(){var t=this;this._dirty||(this._dirty=!0,mh.scheduleTask(function(){t._sort()}))},Dh=function(t){var e=this.indexOf(this._isComponentQuery?t.instance:t);-1!==e&&this.splice(e,1)},Oh=lt,Rh=ut,Ih=ct,Bh=dt,zh=pt,Uh=ft,Nh={enqueue:function(t,e){t.event&&(t._eventQueue=t._eventQueue||[],t._eventQueue.push(t.event)),t.event=e},dequeue:function(t){t._eventQueue&&t._eventQueue.length?t.event=t._eventQueue.pop():delete t.event}},Fh=Nh,jh=mt,Zh=_t,Wh=yt,Vh={capture:!0,noUnwrap:!0,fullRootGet:!0},Hh=wt,Gh=new nh("insert"),qh=xt,$h=function(t,e,n,i){this.root=t,this.keypath=e,this.callback=n,this.defer=i.defer,this.context=i&&i.context?i.context:t};$h.prototype={init:function(t){this.value=this.root.get(this.keypath.str),t!==!1?this.update():this.oldValue=this.value},setValue:function(t){var e=this;a(t,this.value)||(this.value=t,this.defer&&this.ready?mh.scheduleTask(function(){return e.update()}):this.update())},update:function(){this.updating||(this.updating=!0,this.callback.call(this.context,this.value,this.oldValue,this.keypath.str),this.oldValue=this.value,this.updating=!1)}};var Kh,Jh=$h,Yh=Lt,Qh=Array.prototype.slice;Kh=function(t,e,n,i){this.root=t,this.callback=n,this.defer=i.defer,this.keypath=e,this.regex=new RegExp("^"+e.str.replace(/\./g,"\\.").replace(/\*/g,"([^\\.]+)")+"$"),this.values={},this.defer&&(this.proxies=[]),this.context=i&&i.context?i.context:t},Kh.prototype={init:function(t){var e,n;if(e=Yh(this.root,this.keypath),t!==!1)for(n in e)e.hasOwnProperty(n)&&this.update(P(n));else this.values=e},update:function(t){var e,n=this;if(t.isPattern){e=Yh(this.root,t);for(t in e)e.hasOwnProperty(t)&&this.update(P(t))}else if(!this.root.viewmodel.implicitChanges[t.str])return this.defer&&this.ready?void mh.scheduleTask(function(){return n.getProxy(t).update()}):void this.reallyUpdate(t)},reallyUpdate:function(t){var e,n,i,o;return e=t.str,n=this.root.viewmodel.get(t),this.updating?void(this.values[e]=n):(this.updating=!0,a(n,this.values[e])&&this.ready||(i=Qh.call(this.regex.exec(e),1),o=[n,this.values[e],e].concat(i),this.values[e]=n,this.callback.apply(this.context,o)),void(this.updating=!1))},getProxy:function(t){var e=this;return this.proxies[t.str]||(this.proxies[t.str]={update:function(){return e.reallyUpdate(t)}}),this.proxies[t.str]}};var Xh,tl,el,nl,il,ol,rl=Kh,sl=Pt,al={},hl=Et,ll=kt,ul=function(t){return t.trim()},cl=function(t){return""!==t},dl=Ct,pl=Tt,fl=Mt,ml=St,gl=Array.prototype,vl=function(t){return function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;n>o;o++)i[o-1]=arguments[o];var s,a,h,l,u=[];if(e=P(C(e)),s=this.viewmodel.get(e),a=s.length,!r(s))throw new Error("Called ractive."+t+"('"+e.str+"'), but '"+e.str+"' does not refer to an array");return u=ml(s,t,i),l=gl[t].apply(s,i),h=mh.start(this,!0).then(function(){return l}),u?this.viewmodel.smartUpdate(e,s,u):this.viewmodel.mark(e),mh.end(),h}},_l=vl("pop"),yl=vl("push"),wl="/* Ractive.js component styles */\n",bl=[],xl=!1;Xs?(el=document.createElement("style"),el.type="text/css",nl=document.getElementsByTagName("head")[0],ol=!1,il=el.styleSheet,tl=function(){var t=wl+bl.map(function(t){return"\n/* {"+t.id+"} */\n"+t.styles}).join("\n");il?il.cssText=t:el.innerHTML=t,ol||(nl.appendChild(el),ol=!0)},Xh={add:function(t){bl.push(t),xl=!0},apply:function(){xl&&(tl(),xl=!1)}}):Xh={add:Aa,apply:Aa};var Ll,Pl,El=Xh,kl=Dt,Cl=new nh("render"),Tl=new nh("complete"),Ml={extend:function(t,e,n){e.adapt=Rt(e.adapt,R(n.adapt))},init:function(){}},Sl=Ml,Al=It,Dl=/(?:^|\})?\s*([^\{\}]+)\s*\{/g,Ol=/\/\*.*?\*\//g,Rl=/((?:(?:\[[^\]+]\])|(?:[^\s\+\>\~:]))+)((?::[^\s\+\>\~\(]+(?:\([^\)]+\))?)?\s*[\s\+\>\~]?)\s*/g,Il=/^@media/,Bl=/\[data-ractive-css~="\{[a-z0-9-]+\}"]/g,zl=1,Ul={name:"css",extend:function(t,e,n){if(n.css){var i=zl++,o=n.noCssTransform?n.css:Al(n.css,i);e.cssId=i,El.add({id:i,styles:o})}},init:function(){}},Nl=Ul,Fl={name:"data",extend:function(t,e,n){var i=void 0,o=void 0;if(n.data&&l(n.data))for(i in n.data)o=n.data[i],o&&"object"==typeof o&&(l(o)||r(o))&&m("Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }");e.data=Nt(e.data,n.data)},init:function(t,e,n){var i=Nt(t.prototype.data,n.data);return"function"==typeof i&&(i=i.call(e)),i||{}},reset:function(t){var e=this.init(t.constructor,t,t.viewmodel);return t.viewmodel.reset(e),!0}},jl=Fl,Zl=/^\s+/;Pl=function(t){this.name="ParseError",this.message=t;try{throw new Error(t)}catch(e){this.stack=e.stack}},Pl.prototype=Error.prototype,Ll=function(t,e){var n,i,o=0;for(this.str=t,this.options=e||{},this.pos=0,this.lines=this.str.split("\n"),this.lineEnds=this.lines.map(function(t){var e=o+t.length+1;return o=e,e},0),this.init&&this.init(t,e),n=[];this.pos<this.str.length&&(i=this.read());)n.push(i);this.leftover=this.remaining(),this.result=this.postProcess?this.postProcess(n,e):n},Ll.prototype={read:function(t){var e,n,i,o;for(t||(t=this.converters),e=this.pos,i=t.length,n=0;i>n;n+=1)if(this.pos=e,o=t[n](this))return o;return null},getLinePos:function(t){for(var e,n=0,i=0;t>=this.lineEnds[n];)i=this.lineEnds[n],n+=1;return e=t-i,[n+1,e+1,t]},error:function(t){var e=this.getLinePos(this.pos),n=e[0],i=e[1],o=this.lines[e[0]-1],r=0,s=o.replace(/\t/g,function(t,n){return n<e[1]&&(r+=1),"  "})+"\n"+new Array(e[1]+r).join(" ")+"^----",a=new Pl(""+t+" at line "+n+" character "+i+":\n"+s);throw a.line=e[0],a.character=e[1],a.shortMessage=t,a},matchString:function(t){return this.str.substr(this.pos,t.length)===t?(this.pos+=t.length,t):void 0},matchPattern:function(t){var e;return(e=t.exec(this.remaining()))?(this.pos+=e[0].length,e[1]||e[0]):void 0},allowWhitespace:function(){this.matchPattern(Zl)},remaining:function(){return this.str.substring(this.pos)},nextChar:function(){return this.str.charAt(this.pos)}},Ll.extend=function(t){var e,n,i=this;e=function(t,e){Ll.call(this,t,e)},e.prototype=wa(i.prototype);for(n in t)Ta.call(t,n)&&(e.prototype[n]=t[n]);return e.extend=Ll.extend,e};var Wl,Vl,Hl,Gl=Ll,ql=1,$l=2,Kl=3,Jl=4,Yl=5,Ql=6,Xl=7,tu=8,eu=9,nu=10,iu=13,ou=14,ru=15,su=16,au=17,hu=18,lu=20,uu=21,cu=22,du=23,pu=24,fu=25,mu=26,gu=27,vu=30,_u=31,yu=32,wu=33,bu=34,xu=35,Lu=36,Pu=40,Eu=50,ku=51,Cu=52,Tu=53,Mu=54,Su=60,Au=61,Du=Zt,Ou=/^[^\s=]+/,Ru=/^\s+/,Iu=Wt,Bu=/^(\/(?:[^\n\r\u2028\u2029\/\\[]|\\.|\[(?:[^\n\r\u2028\u2029\]\\]|\\.)*])+\/(?:([gimuy])(?![a-z]*\2))*(?![a-zA-Z_$0-9]))/,zu=Vt,Uu={t:nu,exclude:!0},Nu="Expected a JavaScript expression",Fu="Expected closing paren",ju=Gt,Zu=/^(?:[+-]?)0*(?:(?:(?:[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,Wu=qt;Wl=/^(?=.)[^"'\\]+?(?:(?!.)|(?=["'\\]))/,Vl=/^\\(?:['"\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/,Hl=/^\\(?:\r\n|[\u000A\u000D\u2028\u2029])/;var Vu,Hu,Gu=function(t){return function(e){var n,i,o,r;for(n=e.pos,i='"',o=!1;!o;)r=e.matchPattern(Wl)||e.matchPattern(Vl)||e.matchString(t),r?i+='"'===r?'\\"':"\\'"===r?"'":r:(r=e.matchPattern(Hl),r?i+="\\u"+("000"+r.charCodeAt(1).toString(16)).slice(-4):o=!0);return i+='"',JSON.parse(i)}},qu=Gu('"'),$u=Gu("'"),Ku=function(t){var e,n;return e=t.pos,t.matchString('"')?(n=$u(t),t.matchString('"')?{t:uu,v:n}:(t.pos=e,null)):t.matchString("'")?(n=qu(t),t.matchString("'")?{t:uu,v:n}:(t.pos=e,null)):null},Ju=/^[a-zA-Z_$][a-zA-Z_$0-9]*/,Yu=$t,Qu=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/,Xu=Kt,tc=Jt,ec=function(t){var e,n;return e=t.pos,t.allowWhitespace(),t.matchString("{")?(n=tc(t),t.allowWhitespace(),t.matchString("}")?{t:du,m:n}:(t.pos=e,null)):(t.pos=e,null)},nc=Yt,ic=function(t){var e,n;return e=t.pos,t.allowWhitespace(),t.matchString("[")?(n=nc(t),t.matchString("]")?{t:cu,m:n}:(t.pos=e,null)):(t.pos=e,null)},oc=Qt,rc=Xt,sc=/^(?:~\/|(?:\.\.\/)+|\.\/(?:\.\.\/)*|\.)/;Vu=/^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null)\b/,Hu=/^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;var ac,hc,lc=/^[a-zA-Z$_0-9]+(?:(?:\.[a-zA-Z$_0-9]+)|(?:\[[0-9]+\]))*/,uc=/^[a-zA-Z_$][-a-zA-Z_$0-9]*/,cc=te,dc=function(t){return oc(t)||rc(t)||cc(t)},pc=ee,fc=function(t){var e,n,i,o;if(n=dc(t),!n)return null;for(;n;)if(e=t.pos,i=pc(t))n={t:yu,x:n,r:i};else{if(!t.matchString("("))break;t.allowWhitespace(),o=nc(t),t.allowWhitespace(),t.matchString(")")||t.error(Fu),n={t:Pu,x:n},o&&(n.o=o)}return n};hc=function(t,e){return function(n){var i;return(i=e(n))?i:n.matchString(t)?(n.allowWhitespace(),i=Tc(n),i||n.error(Nu),{s:t,o:i,t:wu}):null}},function(){var t,e,n,i,o;for(i="! ~ + - typeof".split(" "),o=fc,t=0,e=i.length;e>t;t+=1)n=hc(i[t],o),o=n;ac=o}();var mc,gc,vc=ac;gc=function(t,e){return function(n){var i,o,r;if(o=e(n),!o)return null;for(;;){if(i=n.pos,n.allowWhitespace(),!n.matchString(t))return n.pos=i,o;if("in"===t&&/[a-zA-Z_$0-9]/.test(n.remaining().charAt(0)))return n.pos=i,o;if(n.allowWhitespace(),r=e(n),!r)return n.pos=i,o;o={t:Lu,s:t,o:[o,r]}}}},function(){var t,e,n,i,o;for(i="* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||".split(" "),o=vc,t=0,e=i.length;e>t;t+=1)n=gc(i[t],o),o=n;mc=o}();var _c,yc,wc,bc,xc,Lc,Pc,Ec,kc=mc,Cc=ne,Tc=ie,Mc=oe,Sc=se,Ac=/^[0-9][1-9]*$/,Dc=he,Oc=le,Rc=ue,Ic=ce,Bc=de,zc=pe,Uc=fe,Nc=/^yield\s*/,Fc=me,jc=ge,Zc=/^\s*else\s*/,Wc=ve,Vc=/^\s*elseif\s+/,Hc={each:Cu,"if":Eu,"if-with":Mu,"with":Tu,unless:ku},Gc=_e,qc=/^\s*:\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,$c=/^\s*,\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,Kc=new RegExp("^("+Object.keys(Hc).join("|")+")\\b"),Jc=Le,Yc="<!--",Qc="-->";_c=/^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i,yc=/^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i,wc={quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},bc=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376],xc=new RegExp("&(#?(?:x[\\w\\d]+|\\d+|"+Object.keys(wc).join("|")+"));?","g"),Lc=/</g,Pc=/>/g,Ec=/&/g;var Xc,td,ed,nd,id,od,rd,sd=/^\s*\r?\n/,ad=/\r?\n\s*$/,hd=function(t){var e,n,i,o,r;for(e=1;e<t.length;e+=1)n=t[e],i=t[e-1],o=t[e-2],Ce(n)&&Te(i)&&Ce(o)&&ad.test(o)&&sd.test(n)&&(t[e-2]=o.replace(ad,"\n"),t[e]=n.replace(sd,"")),Me(n)&&Ce(i)&&ad.test(i)&&Ce(n.f[0])&&sd.test(n.f[0])&&(t[e-1]=i.replace(ad,"\n"),n.f[0]=n.f[0].replace(sd,"")),Ce(n)&&Me(i)&&(r=I(i.f),Ce(r)&&ad.test(r)&&sd.test(n)&&(i.f[i.f.length-1]=r.replace(ad,"\n"),t[e]=n.replace(sd,"")));return t},ld=function(t,e,n){var i;e&&(i=t[0],"string"==typeof i&&(i=i.replace(e,""),i?t[0]=i:t.shift())),n&&(i=I(t),"string"==typeof i&&(i=i.replace(n,""),i?t[t.length-1]=i:t.pop()))},ud=Se,cd=/[ \t\f\r\n]+/g,dd=/^(?:pre|script|style|textarea)$/i,pd=/^[ \t\f\r\n]+/,fd=/[ \t\f\r\n]+$/,md=/^(?:\r\n|\r|\n)/,gd=/(?:\r\n|\r|\n)$/,vd=Ae,_d=/^([a-zA-Z]{1,}:?[a-zA-Z0-9\-]*)\s*\>/,yd=function(t,e){var n,i,o;for(n=e.length;n--;){if(i=t.indexOf(e[n]),!i)return 0;-1!==i&&(!o||o>i)&&(o=i)}return o||-1},wd=De,bd=/^[^\s"'>\/=]+/,xd=/^[^\s"'=<>`]+/;td={"true":!0,"false":!1,undefined:void 0,"null":null},ed=new RegExp("^(?:"+Object.keys(td).join("|")+")"),nd=/^(?:[+-]?)(?:(?:(?:0|[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,id=/\$\{([^\}]+)\}/g,od=/^\$\{([^\}]+)\}/,rd=/^\s*$/,Xc=Gl.extend({init:function(t,e){this.values=e.values,this.allowWhitespace()},postProcess:function(t){return 1===t.length&&rd.test(this.leftover)?{value:t[0].v}:null},converters:[function(t){var e;return t.values?(e=t.matchPattern(od),e&&t.values.hasOwnProperty(e)?{v:t.values[e]}:void 0):null},function(t){var e;return(e=t.matchPattern(ed))?{v:td[e]}:void 0},function(t){var e;return(e=t.matchPattern(nd))?{v:+e}:void 0},function(t){var e,n=Ku(t);return n&&(e=t.values)?{v:n.v.replace(id,function(t,n){return n in e?e[n]:n})}:n},function(t){var e,n;if(!t.matchString("{"))return null;if(e={},t.allowWhitespace(),t.matchString("}"))return{v:e};for(;n=Ue(t);){if(e[n.key]=n.value,t.allowWhitespace(),t.matchString("}"))return{v:e};if(!t.matchString(","))return null}return null},function(t){var e,n;if(!t.matchString("["))return null;if(e=[],t.allowWhitespace(),t.matchString("]"))return{v:e};for(;n=t.read();){if(e.push(n.v),t.allowWhitespace(),t.matchString("]"))return{v:e};if(!t.matchString(","))return null;t.allowWhitespace()}return null}]});var Ld,Pd=function(t,e){var n=new Xc(t,{values:e});return n.result},Ed=Ne,kd=/^([a-zA-Z_$][a-zA-Z_$0-9]*)\(/,Cd=/\)\s*$/;Ld=Gl.extend({converters:[Tc]});var Td,Md=/^[a-zA-Z]{1,}:?[a-zA-Z0-9\-]*/,Sd=/^[\s\n\/>]/,Ad=/^on/,Dd=/^on-([a-zA-Z\\*\\.$_][a-zA-Z\\*\\.$_0-9\-]+)$/,Od=/^(?:change|reset|teardown|update|construct|config|init|render|unrender|detach|insert)$/,Rd={"intro-outro":"t0",intro:"t1",outro:"t2",decorator:"o"},Id={exclude:!0};Td={li:["li"],dt:["dt","dd"],dd:["dt","dd"],p:"address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul".split(" "),rt:["rt","rp"],rp:["rt","rp"],optgroup:["optgroup"],option:["option","optgroup"],thead:["tbody","tfoot"],tbody:["tbody","tfoot"],tfoot:["tbody"],tr:["tr","tbody"],td:["td","th","tr"],th:["td","th","tr"]};var Bd,zd=Fe,Ud=Ze,Nd=We,Fd=/[-\/\\^$*+?.()|[\]{}]/g,jd=Ve,Zd=/^<!--\s*/,Wd=/s*>\s*([a-zA-Z_$][-a-zA-Z_$0-9]*)\s*/,Vd=/\s*-->/,Hd=He,Gd=/^#\s*partial\s+/,qd=Ge,$d=qe,Kd=[Rc,Oc,Gc,Uc,zc,Ic],Jd=[Dc],Yd=[Oc,Gc,zc],Qd=void 0,Xd=[zu,Jc,zd,Ud],tp=[jd,Hd];Qd=Gl.extend({init:function(t,e){var n=e.tripleDelimiters||["{{{","}}}"],i=e.staticDelimiters||["[[","]]"],o=e.staticTripleDelimiters||["[[[","]]]"];this.standardDelimiters=e.delimiters||["{{","}}"],this.tags=[{isStatic:!1,isTriple:!1,open:this.standardDelimiters[0],close:this.standardDelimiters[1],readers:Kd},{isStatic:!1,isTriple:!0,open:n[0],close:n[1],readers:Jd},{isStatic:!0,isTriple:!1,open:i[0],close:i[1],readers:Yd},{isStatic:!0,isTriple:!0,open:o[0],close:o[1],readers:Jd}],this.sortMustacheTags(),this.sectionDepth=0,this.elementStack=[],this.interpolate={script:!e.interpolate||e.interpolate.script!==!1,style:!e.interpolate||e.interpolate.style!==!1},e.sanitize===!0&&(e.sanitize={elements:"applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title".split(" "),eventAttributes:!0}),this.stripComments=e.stripComments!==!1,this.preserveWhitespace=e.preserveWhitespace,this.sanitizeElements=e.sanitize&&e.sanitize.elements,this.sanitizeEventAttributes=e.sanitize&&e.sanitize.eventAttributes,this.includeLinePositions=e.includeLinePositions},postProcess:function(t){return t.length?(this.sectionDepth>0&&this.error("A section was left open"),ud(t[0].t,this.stripComments,this.preserveWhitespace,!this.preserveWhitespace,!this.preserveWhitespace),t[0]):{t:[],v:sa}},converters:[qd],sortMustacheTags:function(){this.tags.sort(function(t,e){return e.open.length-t.open.length})}});var ep,np,ip,op=["preserveWhitespace","sanitize","stripComments","delimiters","tripleDelimiters","interpolate"],rp={fromId:Je,isHashedId:Ye,isParsed:Qe,getParseOptions:Xe,createHelper:$e,parse:Ke},sp=rp,ap={name:"template",extend:function(t,e,n){var i;"template"in n&&(i=n.template,"function"==typeof i?e.template=i:e.template=on(i,e))},init:function(t,e,n){var i,o;i="template"in n?n.template:t.prototype.template,"function"==typeof i&&(o=i,i=en(e,o),e._config.template={fn:o,result:i}),i=on(i,e),e.template=i.t,i.p&&rn(e.partials,i.p)},reset:function(t){var e,n=tn(t);return n?(e=on(n,t),t.template=e.t,rn(t.partials,e.p,!0),!0):void 0}},hp=ap;ep=["adaptors","components","computed","decorators","easing","events","interpolators","partials","transitions"],np=function(t,e){this.name=t,this.useDefaults=e},np.prototype={constructor:np,extend:function(t,e,n){this.configure(this.useDefaults?t.defaults:t,this.useDefaults?e:e.constructor,n)},init:function(){},configure:function(t,e,n){var i,o=this.name,r=n[o];i=wa(t[o]);for(var s in r)i[s]=r[s];e[o]=i},reset:function(t){var e=t[this.name],n=!1;return Object.keys(e).forEach(function(t){var i=e[t];i._fn&&(i._fn.isOwner?e[t]=i._fn:delete e[t],n=!0)}),n}},ip=ep.map(function(t){return new np(t,"computed"===t)});var lp,up,cp,dp,pp,fp,mp=ip,gp=sn,vp=un;dp={adapt:Sl,css:Nl,data:jl,template:hp},cp=Object.keys(ha),fp=pn(cp.filter(function(t){return!dp[t]})),pp=pn(cp.concat(mp.map(function(t){return t.name}))),up=[].concat(cp.filter(function(t){return!mp[t]&&!dp[t]}),mp,dp.data,dp.template,dp.css),lp={extend:function(t,e,n){return cn("extend",t,e,n)},init:function(t,e,n){return cn("init",t,e,n)},reset:function(t){return up.filter(function(e){return e.reset&&e.reset(t)}).map(function(t){return t.name})},order:up};var _p=lp,yp=fn,wp=mn,bp=gn,xp=vn,Lp=_n,Pp=yn,Ep=wn,kp=bn,Cp=xn,Tp=Ln,Mp=Pn,Sp=En,Ap=function(){return e(this.node)},Dp=function(t){this.type=ql,this.text=t.template};Dp.prototype={detach:Ap,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createTextNode(this.text)),this.node},toString:function(t){return t?ke(this.text):this.text},unrender:function(t){return t?this.detach():void 0}};var Op=Dp,Rp=kn,Ip=Cn,Bp=function(t,e,n){var i;this.ref=e,this.resolved=!1,this.root=t.root,this.parentFragment=t.parentFragment,this.callback=n,i=hh(t.root,e,t.parentFragment),void 0!=i?this.resolve(i):mh.addUnresolved(this)};Bp.prototype={resolve:function(t){this.keypath&&!t&&mh.addUnresolved(this),this.resolved=!0,this.keypath=t,this.callback(t)},forceResolution:function(){this.resolve(P(this.ref))},rebind:function(t,e){var n;void 0!=this.keypath&&(n=this.keypath.replace(t,e),void 0!==n&&this.resolve(n))},unbind:function(){this.resolved||mh.removeUnresolved(this)}};var zp=Bp,Up=function(t,e,n){this.parentFragment=t.parentFragment,this.ref=e,this.callback=n,this.rebind()},Np={"@keypath":{prefix:"c",prop:["context"]},"@index":{prefix:"i",prop:["index"]},"@key":{prefix:"k",prop:["key","index"]}};Up.prototype={rebind:function(){var t,e=this.ref,n=this.parentFragment,i=Np[e];if(!i)throw new Error('Unknown special reference "'+e+'" - valid references are @index, @key and @keypath');if(this.cached)return this.callback(P("@"+i.prefix+Tn(this.cached,i)));if(-1!==i.prop.indexOf("index")||-1!==i.prop.indexOf("key"))for(;n;){if(n.owner.currentSubtype===Cu&&void 0!==(t=Tn(n,i)))return this.cached=n,n.registerIndexRef(this),this.callback(P("@"+i.prefix+t));n=!n.parent&&n.owner&&n.owner.component&&n.owner.component.parentFragment&&!n.owner.component.instance.isolated?n.owner.component.parentFragment:n.parent}else for(;n;){if(void 0!==(t=Tn(n,i)))return this.callback(P("@"+i.prefix+t.str));n=n.parent}},unbind:function(){this.cached&&this.cached.unregisterIndexRef(this)}};var Fp=Up,jp=function(t,e,n){this.parentFragment=t.parentFragment,this.ref=e,this.callback=n,e.ref.fragment.registerIndexRef(this),this.rebind()};jp.prototype={rebind:function(){var t,e=this.ref.ref;t="k"===e.ref.t?"k"+e.fragment.key:"i"+e.fragment.index,void 0!==t&&this.callback(P("@"+t))},unbind:function(){this.ref.ref.fragment.unregisterIndexRef(this)}};var Zp=jp,Wp=Mn;Mn.resolve=function(t){var e,n,i={};for(e in t.refs)n=t.refs[e],i[n.ref.n]="k"===n.ref.t?n.fragment.key:n.fragment.index;return i};var Vp,Hp=Sn,Gp=An,qp={},$p=Function.prototype.bind;Vp=function(t,e,n,i){var o,r=this;o=t.root,this.root=o,this.parentFragment=e,this.callback=i,this.owner=t,this.str=n.s,this.keypaths=[],this.pending=n.r.length,this.refResolvers=n.r.map(function(t,e){return Hp(r,t,function(t){r.resolve(e,t)})}),this.ready=!0,this.bubble()},Vp.prototype={bubble:function(){this.ready&&(this.uniqueString=On(this.str,this.keypaths),this.keypath=Rn(this.uniqueString),this.createEvaluator(),this.callback(this.keypath))},unbind:function(){for(var t;t=this.refResolvers.pop();)t.unbind()},resolve:function(t,e){this.keypaths[t]=e,this.bubble()},createEvaluator:function(){var t,e,n,i,o,r=this;i=this.keypath,t=this.root.viewmodel.computations[i.str],t?this.root.viewmodel.mark(i):(o=Gp(this.str,this.refResolvers.length),e=this.keypaths.map(function(t){var e;return"undefined"===t?function(){}:t.isSpecial?(e=t.value,function(){return e}):function(){var e=r.root.viewmodel.get(t,{noUnwrap:!0,fullRootGet:!0});return"function"==typeof e&&(e=Bn(e,r.root)),e}}),n={deps:this.keypaths.filter(In),getter:function(){var t=e.map(Dn);return o.apply(null,t)}},t=this.root.viewmodel.compute(i,n))},rebind:function(t,e){this.refResolvers.forEach(function(n){return n.rebind(t,e)})}};var Kp=Vp,Jp=function(t,e,n){var i=this;this.resolver=e,this.root=e.root,this.parentFragment=n,this.viewmodel=e.root.viewmodel,"string"==typeof t?this.value=t:t.t===vu?this.refResolver=Hp(this,t.n,function(t){i.resolve(t)}):new Kp(e,n,t,function(t){i.resolve(t)})};Jp.prototype={resolve:function(t){this.keypath&&this.viewmodel.unregister(this.keypath,this),this.keypath=t,this.value=this.viewmodel.get(t),this.bind(),this.resolver.bubble()},bind:function(){this.viewmodel.register(this.keypath,this)},rebind:function(t,e){this.refResolver&&this.refResolver.rebind(t,e)},setValue:function(t){this.value=t,this.resolver.bubble()},unbind:function(){this.keypath&&this.viewmodel.unregister(this.keypath,this),this.refResolver&&this.refResolver.unbind()},forceResolution:function(){this.refResolver&&this.refResolver.forceResolution()}};var Yp=Jp,Qp=function(t,e,n){var i,o,r,s,a=this;this.parentFragment=s=t.parentFragment,this.root=i=t.root,this.mustache=t,this.ref=o=e.r,this.callback=n,this.unresolved=[],(r=hh(i,o,s))?this.base=r:this.baseResolver=new zp(this,o,function(t){a.base=t,a.baseResolver=null,a.bubble()}),this.members=e.m.map(function(t){return new Yp(t,a,s)}),this.ready=!0,this.bubble()};Qp.prototype={getKeypath:function(){var t=this.members.map(zn);return!t.every(Un)||this.baseResolver?null:this.base.join(t.join("."))},bubble:function(){this.ready&&!this.baseResolver&&this.callback(this.getKeypath())},unbind:function(){this.members.forEach(q)},rebind:function(t,e){var n;if(this.base){var i=this.base.replace(t,e);i&&i!==this.base&&(this.base=i,n=!0)}this.members.forEach(function(i){i.rebind(t,e)&&(n=!0)}),n&&this.bubble()},forceResolution:function(){this.baseResolver&&(this.base=P(this.ref),this.baseResolver.unbind(),this.baseResolver=null),this.members.forEach(Nn),this.bubble()}};var Xp=Qp,tf=Fn,ef=jn,nf=Zn,of={getValue:Ip,init:tf,resolve:ef,rebind:nf},rf=function(t){this.type=$l,of.init(this,t)};rf.prototype={update:function(){this.node.data=void 0==this.value?"":this.value},resolve:of.resolve,rebind:of.rebind,detach:Ap,unbind:Rp,render:function(){return this.node||(this.node=document.createTextNode(n(this.value))),this.node},unrender:function(t){t&&e(this.node)},getValue:of.getValue,setValue:function(t){var e;this.keypath&&(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),a(t,this.value)||(this.value=t,this.parentFragment.bubble(),this.node&&mh.addView(this))},firstNode:function(){return this.node},toString:function(t){var e=""+n(this.value);return t?ke(e):e}};var sf=rf,af=Wn,hf=Vn,lf=Hn,uf=Gn,cf=qn,df=$n,pf=Kn,ff=Jn,mf=Yn,gf=function(t,e){of.rebind.call(this,t,e)},vf=Xn,_f=ti,yf=ci,wf=di,bf=pi,xf=gi,Lf=function(t){this.type=Jl,this.subtype=this.currentSubtype=t.template.n,this.inverted=this.subtype===ku,this.pElement=t.pElement,this.fragments=[],this.fragmentsToCreate=[],this.fragmentsToRender=[],this.fragmentsToUnrender=[],t.template.i&&(this.indexRefs=t.template.i.split(",").map(function(t,e){return{n:t,t:0===e?"k":"i"}})),this.renderedFragments=[],this.length=0,of.init(this,t)};Lf.prototype={bubble:af,detach:hf,find:lf,findAll:uf,findAllComponents:cf,findComponent:df,findNextNode:pf,firstNode:ff,getIndexRef:function(t){if(this.indexRefs)for(var e=this.indexRefs.length;e--;){var n=this.indexRefs[e];if(n.n===t)return n}},getValue:of.getValue,shuffle:mf,rebind:gf,render:vf,resolve:of.resolve,setValue:_f,toString:yf,unbind:wf,unrender:bf,update:xf};var Pf,Ef,kf=Lf,Cf=vi,Tf=_i,Mf=yi,Sf=wi,Af={};try{ca("table").innerHTML="foo"}catch(Pa){Pf=!0,Ef={TABLE:['<table class="x">',"</table>"],THEAD:['<table><thead class="x">',"</thead></table>"],TBODY:['<table><tbody class="x">',"</tbody></table>"],TR:['<table><tr class="x">',"</tr></table>"],SELECT:['<select class="x">',"</select>"]}}var Df=function(t,e,n){var i,o,r,s,a,h=[];if(null!=t&&""!==t){for(Pf&&(o=Ef[e.tagName])?(i=bi("DIV"),i.innerHTML=o[0]+t+o[1],i=i.querySelector(".x"),"SELECT"===i.tagName&&(r=i.options[i.selectedIndex])):e.namespaceURI===ia.svg?(i=bi("DIV"),i.innerHTML='<svg class="x">'+t+"</svg>",i=i.querySelector(".x")):(i=bi(e.tagName),i.innerHTML=t,"SELECT"===i.tagName&&(r=i.options[i.selectedIndex]));s=i.firstChild;)h.push(s),n.appendChild(s);if("SELECT"===e.tagName)for(a=h.length;a--;)h[a]!==r&&(h[a].selected=!1)}return h},Of=xi,Rf=Pi,If=Ei,Bf=ki,zf=Ci,Uf=Ti,Nf=function(t){this.type=Kl,of.init(this,t)};Nf.prototype={detach:Cf,find:Tf,findAll:Mf,firstNode:Sf,getValue:of.getValue,rebind:of.rebind,render:Rf,resolve:of.resolve,setValue:If,toString:Bf,unbind:Rp,unrender:zf,update:Uf};var Ff,jf,Zf,Wf,Vf=Nf,Hf=function(){this.parentFragment.bubble()},Gf=Mi,qf=function(t){return this.node?da(this.node,t)?this.node:this.fragment&&this.fragment.find?this.fragment.find(t):void 0:null},$f=function(t,e){e._test(this,!0)&&e.live&&(this.liveQueries||(this.liveQueries=[])).push(e),this.fragment&&this.fragment.findAll(t,e)},Kf=function(t,e){this.fragment&&this.fragment.findAllComponents(t,e)},Jf=function(t){return this.fragment?this.fragment.findComponent(t):void 0},Yf=Si,Qf=Ai,Xf=Di,tm=/^true|on|yes|1$/i,em=/^[0-9]+$/,nm=function(t,e){var n,i,o;return o=e.a||{},i={},n=o.twoway,void 0!==n&&(i.twoway=0===n||tm.test(n)),n=o.lazy,void 0!==n&&(0!==n&&em.test(n)?i.lazy=parseInt(n):i.lazy=0===n||tm.test(n)),i},im=Oi;Ff="altGlyph altGlyphDef altGlyphItem animateColor animateMotion animateTransform clipPath feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence foreignObject glyphRef linearGradient radialGradient textPath vkern".split(" "),jf="attributeName attributeType baseFrequency baseProfile calcMode clipPathUnits contentScriptType contentStyleType diffuseConstant edgeMode externalResourcesRequired filterRes filterUnits glyphRef gradientTransform gradientUnits kernelMatrix kernelUnitLength keyPoints keySplines keyTimes lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY repeatCount repeatDur requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox viewTarget xChannelSelector yChannelSelector zoomAndPan".split(" "),Zf=function(t){for(var e={},n=t.length;n--;)e[t[n].toLowerCase()]=t[n];return e},Wf=Zf(Ff.concat(jf));var om=function(t){var e=t.toLowerCase();return Wf[e]||e},rm=function(t,e){var n,i;if(n=e.indexOf(":"),-1===n||(i=e.substr(0,n),"xmlns"===i))t.name=t.element.namespace!==ia.html?om(e):e;else if(e=e.substring(n+1),t.name=om(e),t.namespace=ia[i.toLowerCase()],t.namespacePrefix=i,!t.namespace)throw'Unknown namespace ("'+i+'")'},sm=Ri,am=Ii,hm=Bi,lm=zi,um={"accept-charset":"acceptCharset",accesskey:"accessKey",bgcolor:"bgColor","class":"className",codebase:"codeBase",colspan:"colSpan",contenteditable:"contentEditable",datetime:"dateTime",
dirname:"dirName","for":"htmlFor","http-equiv":"httpEquiv",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",pubdate:"pubDate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"},cm=Ui,dm=Fi,pm=ji,fm=Zi,mm=Wi,gm=Vi,vm=Hi,_m=Gi,ym=qi,wm=$i,bm=Ki,xm=Ji,Lm=Yi,Pm=Qi,Em=Xi,km=function(t){this.init(t)};km.prototype={bubble:im,init:am,rebind:hm,render:lm,toString:cm,unbind:dm,update:Em};var Cm,Tm=km,Mm=function(t,e){var n,i,o=[];for(n in e)"twoway"!==n&&"lazy"!==n&&e.hasOwnProperty(n)&&(i=new Tm({element:t,name:n,value:e[n],root:t.root}),o[n]=i,"value"!==n&&o.push(i));return(i=o.value)&&o.push(i),o};"undefined"!=typeof document&&(Cm=ca("div"));var Sm=function(t,e){this.element=t,this.root=t.root,this.parentFragment=t.parentFragment,this.attributes=[],this.fragment=new _y({root:t.root,owner:this,template:[e]})};Sm.prototype={bubble:function(){this.node&&this.update(),this.element.bubble()},rebind:function(t,e){this.fragment.rebind(t,e)},render:function(t){this.node=t,this.isSvg=t.namespaceURI===ia.svg,this.update()},unbind:function(){this.fragment.unbind()},update:function(){var t,e,n=this;t=this.fragment.toString(),e=to(t,this.isSvg),this.attributes.filter(function(t){return eo(e,t)}).forEach(function(t){n.node.removeAttribute(t.name)}),e.forEach(function(t){n.node.setAttribute(t.name,t.value)}),this.attributes=e},toString:function(){return this.fragment.toString()}};var Am=Sm,Dm=function(t,e){return e?e.map(function(e){return new Am(t,e)}):[]},Om=function(t){var e,n,i,o;if(this.element=t,this.root=t.root,this.attribute=t.attributes[this.name||"value"],e=this.attribute.interpolator,e.twowayBinding=this,n=e.keypath){if("}"===n.str.slice(-1))return g("Two-way binding does not work with expressions (`%s` on <%s>)",e.resolver.uniqueString,t.name,{ractive:this.root}),!1;if(n.isSpecial)return g("Two-way binding does not work with %s",e.resolver.ref,{ractive:this.root}),!1}else{var r=e.template.r?"'"+e.template.r+"' reference":"expression";m("The %s being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity",r,{ractive:this.root}),e.resolver.forceResolution(),n=e.keypath}this.attribute.isTwoway=!0,this.keypath=n,i=this.root.viewmodel.get(n),void 0===i&&this.getInitialValue&&(i=this.getInitialValue(),void 0!==i&&this.root.viewmodel.set(n,i)),(o=no(t))&&(this.resetValue=i,o.formBindings.push(this))};Om.prototype={handleChange:function(){var t=this;mh.start(this.root),this.attribute.locked=!0,this.root.viewmodel.set(this.keypath,this.getValue()),mh.scheduleTask(function(){return t.attribute.locked=!1}),mh.end()},rebound:function(){var t,e,n;e=this.keypath,n=this.attribute.interpolator.keypath,e!==n&&(B(this.root._twowayBindings[e.str],this),this.keypath=n,t=this.root._twowayBindings[n.str]||(this.root._twowayBindings[n.str]=[]),t.push(this))},unbind:function(){}},Om.extend=function(t){var e,n=this;return e=function(t){Om.call(this,t),this.init&&this.init()},e.prototype=wa(n.prototype),i(e.prototype,t),e.extend=Om.extend,e};var Rm,Im=Om,Bm=io;Rm=Im.extend({getInitialValue:function(){return""},getValue:function(){return this.element.node.value},render:function(){var t,e=this.element.node,n=!1;this.rendered=!0,t=this.root.lazy,this.element.lazy===!0?t=!0:this.element.lazy===!1?t=!1:h(this.element.lazy)?(t=!1,n=+this.element.lazy):h(t||"")&&(n=+t,t=!1,this.element.lazy=n),this.handler=n?ro:Bm,e.addEventListener("change",Bm,!1),t||(e.addEventListener("input",this.handler,!1),e.attachEvent&&e.addEventListener("keyup",this.handler,!1)),e.addEventListener("blur",oo,!1)},unrender:function(){var t=this.element.node;this.rendered=!1,t.removeEventListener("change",Bm,!1),t.removeEventListener("input",this.handler,!1),t.removeEventListener("keyup",this.handler,!1),t.removeEventListener("blur",oo,!1)}});var zm=Rm,Um=zm.extend({getInitialValue:function(){return this.element.fragment?this.element.fragment.toString():""},getValue:function(){return this.element.node.innerHTML}}),Nm=Um,Fm=so,jm={},Zm=Im.extend({name:"checked",init:function(){this.siblings=Fm(this.root._guid,"radio",this.element.getAttribute("name")),this.siblings.push(this)},render:function(){var t=this.element.node;t.addEventListener("change",Bm,!1),t.attachEvent&&t.addEventListener("click",Bm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",Bm,!1),t.removeEventListener("click",Bm,!1)},handleChange:function(){mh.start(this.root),this.siblings.forEach(function(t){t.root.viewmodel.set(t.keypath,t.getValue())}),mh.end()},getValue:function(){return this.element.node.checked},unbind:function(){B(this.siblings,this)}}),Wm=Zm,Vm=Im.extend({name:"name",init:function(){this.siblings=Fm(this.root._guid,"radioname",this.keypath.str),this.siblings.push(this),this.radioName=!0},getInitialValue:function(){return this.element.getAttribute("checked")?this.element.getAttribute("value"):void 0},render:function(){var t=this.element.node;t.name="{{"+this.keypath.str+"}}",t.checked=this.root.viewmodel.get(this.keypath)==this.element.getAttribute("value"),t.addEventListener("change",Bm,!1),t.attachEvent&&t.addEventListener("click",Bm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",Bm,!1),t.removeEventListener("click",Bm,!1)},getValue:function(){var t=this.element.node;return t._ractive?t._ractive.value:t.value},handleChange:function(){this.element.node.checked&&Im.prototype.handleChange.call(this)},rebound:function(t,e){var n;Im.prototype.rebound.call(this,t,e),(n=this.element.node)&&(n.name="{{"+this.keypath.str+"}}")},unbind:function(){B(this.siblings,this)}}),Hm=Vm,Gm=Im.extend({name:"name",getInitialValue:function(){return this.noInitialValue=!0,[]},init:function(){var t,e;this.checkboxName=!0,this.siblings=Fm(this.root._guid,"checkboxes",this.keypath.str),this.siblings.push(this),this.noInitialValue&&(this.siblings.noInitialValue=!0),this.siblings.noInitialValue&&this.element.getAttribute("checked")&&(t=this.root.viewmodel.get(this.keypath),e=this.element.getAttribute("value"),t.push(e))},unbind:function(){B(this.siblings,this)},render:function(){var t,e,n=this.element.node;t=this.root.viewmodel.get(this.keypath),e=this.element.getAttribute("value"),r(t)?this.isChecked=D(t,e):this.isChecked=t==e,n.name="{{"+this.keypath.str+"}}",n.checked=this.isChecked,n.addEventListener("change",Bm,!1),n.attachEvent&&n.addEventListener("click",Bm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",Bm,!1),t.removeEventListener("click",Bm,!1)},changed:function(){var t=!!this.isChecked;return this.isChecked=this.element.node.checked,this.isChecked===t},handleChange:function(){this.isChecked=this.element.node.checked,Im.prototype.handleChange.call(this)},getValue:function(){return this.siblings.filter(ao).map(ho)}}),qm=Gm,$m=Im.extend({name:"checked",render:function(){var t=this.element.node;t.addEventListener("change",Bm,!1),t.attachEvent&&t.addEventListener("click",Bm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",Bm,!1),t.removeEventListener("click",Bm,!1)},getValue:function(){return this.element.node.checked}}),Km=$m,Jm=Im.extend({getInitialValue:function(){var t,e,n,i,o=this.element.options;if(void 0===this.element.getAttribute("value")&&(e=t=o.length,t)){for(;e--;)if(o[e].getAttribute("selected")){n=o[e].getAttribute("value"),i=!0;break}if(!i)for(;++e<t;)if(!o[e].getAttribute("disabled")){n=o[e].getAttribute("value");break}return void 0!==n&&(this.element.attributes.value.value=n),n}},render:function(){this.element.node.addEventListener("change",Bm,!1)},unrender:function(){this.element.node.removeEventListener("change",Bm,!1)},setValue:function(t){this.root.viewmodel.set(this.keypath,t)},getValue:function(){var t,e,n,i,o;for(t=this.element.node.options,n=t.length,e=0;n>e;e+=1)if(i=t[e],t[e].selected)return o=i._ractive?i._ractive.value:i.value},forceUpdate:function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,mh.scheduleTask(function(){return t.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,e))}}),Ym=Jm,Qm=Ym.extend({getInitialValue:function(){return this.element.options.filter(function(t){return t.getAttribute("selected")}).map(function(t){return t.getAttribute("value")})},render:function(){var t;this.element.node.addEventListener("change",Bm,!1),t=this.root.viewmodel.get(this.keypath),void 0===t&&this.handleChange()},unrender:function(){this.element.node.removeEventListener("change",Bm,!1)},setValue:function(){throw new Error("TODO not implemented yet")},getValue:function(){var t,e,n,i,o,r;for(t=[],e=this.element.node.options,i=e.length,n=0;i>n;n+=1)o=e[n],o.selected&&(r=o._ractive?o._ractive.value:o.value,t.push(r));return t},handleChange:function(){var t,e,n;return t=this.attribute,e=t.value,n=this.getValue(),void 0!==e&&O(n,e)||Ym.prototype.handleChange.call(this),this},forceUpdate:function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,mh.scheduleTask(function(){return t.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,e))},updateModel:function(){void 0!==this.attribute.value&&this.attribute.value.length||this.root.viewmodel.set(this.keypath,this.initialValue)}}),Xm=Qm,tg=Im.extend({render:function(){this.element.node.addEventListener("change",Bm,!1)},unrender:function(){this.element.node.removeEventListener("change",Bm,!1)},getValue:function(){return this.element.node.files}}),eg=tg,ng=zm.extend({getInitialValue:function(){},getValue:function(){var t=parseFloat(this.element.node.value);return isNaN(t)?void 0:t}}),ig=lo,og=co,rg=po,sg=fo,ag=mo,hg=/^event(?:\.(.+))?/,lg=yo,ug=wo,cg={},dg={touchstart:!0,touchmove:!0,touchend:!0,touchcancel:!0,touchleave:!0},pg=xo,fg=Lo,mg=Po,gg=Eo,vg=ko,_g=function(t,e,n){this.init(t,e,n)};_g.prototype={bubble:og,fire:rg,getAction:sg,init:ag,listen:ug,rebind:pg,render:fg,resolve:mg,unbind:gg,unrender:vg};var yg=_g,wg=function(t,e){var n,i,o,r,s=[];for(i in e)if(e.hasOwnProperty(i))for(o=i.split("-"),n=o.length;n--;)r=new yg(t,o[n],e[i]),s.push(r);return s},bg=function(t,e){var n,i,o,r=this;this.element=t,this.root=n=t.root,i=e.n||e,("string"==typeof i||(o=new _y({template:i,root:n,owner:t}),i=o.toString(),o.unbind(),""!==i))&&(e.a?this.params=e.a:e.d&&(this.fragment=new _y({template:e.d,root:n,owner:t}),this.params=this.fragment.getArgsList(),this.fragment.bubble=function(){this.dirtyArgs=this.dirtyValue=!0,r.params=this.getArgsList(),r.ready&&r.update()}),this.fn=v("decorators",n,i),this.fn||c(Ia(i,"decorator")))};bg.prototype={init:function(){var t,e,n;if(t=this.element.node,this.params?(n=[t].concat(this.params),e=this.fn.apply(this.root,n)):e=this.fn.call(this.root,t),!e||!e.teardown)throw new Error("Decorator definition must return an object with a teardown method");this.actual=e,this.ready=!0},update:function(){this.actual.update?this.actual.update.apply(this.root,this.params):(this.actual.teardown(!0),this.init())},rebind:function(t,e){this.fragment&&this.fragment.rebind(t,e)},teardown:function(t){this.torndown=!0,this.ready&&this.actual.teardown(),!t&&this.fragment&&this.fragment.unbind()}};var xg,Lg,Pg,Eg=bg,kg=Oo,Cg=Ro,Tg=Fo,Mg=function(t){return t.replace(/-([a-zA-Z])/g,function(t,e){return e.toUpperCase()})};Xs?(Lg={},Pg=ca("div").style,xg=function(t){var e,n,i;if(t=Mg(t),!Lg[t])if(void 0!==Pg[t])Lg[t]=t;else for(i=t.charAt(0).toUpperCase()+t.substring(1),e=ra.length;e--;)if(n=ra[e],void 0!==Pg[n+i]){Lg[t]=n+i;break}return Lg[t]}):xg=null;var Sg,Ag,Dg=xg;Xs?(Ag=window.getComputedStyle||La.getComputedStyle,Sg=function(t){var e,n,i,o,s;if(e=Ag(this.node),"string"==typeof t)return s=e[Dg(t)],"0px"===s&&(s=0),s;if(!r(t))throw new Error("Transition$getStyle must be passed a string, or an array of strings representing CSS properties");for(n={},i=t.length;i--;)o=t[i],s=e[Dg(o)],"0px"===s&&(s=0),n[o]=s;return n}):Sg=null;var Og=Sg,Rg=function(t,e){var n;if("string"==typeof t)this.node.style[Dg(t)]=e;else for(n in t)t.hasOwnProperty(n)&&(this.node.style[Dg(n)]=t[n]);return this},Ig=function(t){var e;this.duration=t.duration,this.step=t.step,this.complete=t.complete,"string"==typeof t.easing?(e=t.root.easing[t.easing],e||(g(Ia(t.easing,"easing")),e=jo)):e="function"==typeof t.easing?t.easing:jo,this.easing=e,this.start=Xa(),this.end=this.start+this.duration,this.running=!0,_h.add(this)};Ig.prototype={tick:function(t){var e,n;return this.running?t>this.end?(this.step&&this.step(1),this.complete&&this.complete(1),!1):(e=t-this.start,n=this.easing(e/this.duration),this.step&&this.step(n),!0):!1},stop:function(){this.abort&&this.abort(),this.running=!1}};var Bg,zg,Ug,Ng,Fg,jg,Zg,Wg,Vg=Ig,Hg=new RegExp("^-(?:"+ra.join("|")+")-"),Gg=function(t){return t.replace(Hg,"")},qg=new RegExp("^(?:"+ra.join("|")+")([A-Z])"),$g=function(t){var e;return t?(qg.test(t)&&(t="-"+t),e=t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})):""},Kg={},Jg={};Xs?(zg=ca("div").style,function(){void 0!==zg.transition?(Ug="transition",Ng="transitionend",Fg=!0):void 0!==zg.webkitTransition?(Ug="webkitTransition",Ng="webkitTransitionEnd",Fg=!0):Fg=!1}(),Ug&&(jg=Ug+"Duration",Zg=Ug+"Property",Wg=Ug+"TimingFunction"),Bg=function(t,e,n,i,o){setTimeout(function(){var r,s,a,h,l;h=function(){s&&a&&(t.root.fire(t.name+":end",t.node,t.isIntro),o())},r=(t.node.namespaceURI||"")+t.node.tagName,t.node.style[Zg]=i.map(Dg).map($g).join(","),t.node.style[Wg]=$g(n.easing||"linear"),t.node.style[jg]=n.duration/1e3+"s",l=function(e){var n;n=i.indexOf(Mg(Gg(e.propertyName))),-1!==n&&i.splice(n,1),i.length||(t.node.removeEventListener(Ng,l,!1),a=!0,h())},t.node.addEventListener(Ng,l,!1),setTimeout(function(){for(var o,u,c,d,p,f=i.length,g=[];f--;)d=i[f],o=r+d,Fg&&!Jg[o]&&(t.node.style[Dg(d)]=e[d],Kg[o]||(u=t.getStyle(d),Kg[o]=t.getStyle(d)!=e[d],Jg[o]=!Kg[o],Jg[o]&&(t.node.style[Dg(d)]=u))),(!Fg||Jg[o])&&(void 0===u&&(u=t.getStyle(d)),c=i.indexOf(d),-1===c?m("Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!",{node:t.node}):i.splice(c,1),p=/[^\d]*$/.exec(e[d])[0],g.push({name:Dg(d),interpolator:za(parseFloat(u),parseFloat(e[d])),suffix:p}));g.length?new Vg({root:t.root,duration:n.duration,easing:Mg(n.easing||""),step:function(e){var n,i;for(i=g.length;i--;)n=g[i],t.node.style[n.name]=n.interpolator(e)+n.suffix},complete:function(){s=!0,h()}}):s=!0,i.length||(t.node.removeEventListener(Ng,l,!1),a=!0,h())},0)},n.delay||0)}):Bg=null;var Yg,Qg,Xg,tv,ev,nv=Bg;if("undefined"!=typeof document){if(Yg="hidden",ev={},Yg in document)Xg="";else for(tv=ra.length;tv--;)Qg=ra[tv],Yg=Qg+"Hidden",Yg in document&&(Xg=Qg);void 0!==Xg?(document.addEventListener(Xg+"visibilitychange",Zo),Zo()):("onfocusout"in document?(document.addEventListener("focusout",Wo),document.addEventListener("focusin",Vo)):(window.addEventListener("pagehide",Wo),window.addEventListener("blur",Wo),window.addEventListener("pageshow",Vo),window.addEventListener("focus",Vo)),ev.hidden=!1)}var iv,ov,rv,sv=ev;Xs?(ov=window.getComputedStyle||La.getComputedStyle,iv=function(t,e,n){var i,o=this;if(4===arguments.length)throw new Error("t.animateStyle() returns a promise - use .then() instead of passing a callback");if(sv.hidden)return this.setStyle(t,e),rv||(rv=sh.resolve());"string"==typeof t?(i={},i[t]=e):(i=t,n=e),n||(g('The "%s" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340',this.name),n=this);var r=new sh(function(t){var e,r,s,a,h,l,u;if(!n.duration)return o.setStyle(i),void t();for(e=Object.keys(i),r=[],s=ov(o.node),h={},l=e.length;l--;)u=e[l],a=s[Dg(u)],"0px"===a&&(a=0),a!=i[u]&&(r.push(u),o.node.style[Dg(u)]=a);return r.length?void nv(o,i,n,r,t):void t()});return r}):iv=null;var av=iv,hv=function(t,e){return"number"==typeof t?t={duration:t}:"string"==typeof t?t="slow"===t?{duration:600}:"fast"===t?{duration:200}:{duration:400}:t||(t={}),o({},t,e)},lv=Ho,uv=function(t,e,n){this.init(t,e,n)};uv.prototype={init:Tg,start:lv,getStyle:Og,setStyle:Rg,animateStyle:av,processParams:hv};var cv,dv,pv=uv,fv=qo;cv=function(){var t=this.node,e=this.fragment.toString(!1);if(window&&window.appearsToBeIELessEqual8&&(t.type="text/css"),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}},dv=function(){this.node.type&&"text/javascript"!==this.node.type||m("Script tag was updated. This does not cause the code to be re-evaluated!",{ractive:this.root}),this.node.text=this.fragment.toString(!1)};var mv=function(){var t,e;return this.template.y?"<!DOCTYPE"+this.template.dd+">":(t="<"+this.template.e,t+=this.attributes.map(Xo).join("")+this.conditionalAttributes.map(Xo).join(""),"option"===this.name&&Yo(this)&&(t+=" selected"),"input"===this.name&&Qo(this)&&(t+=" checked"),t+=">","textarea"===this.name&&void 0!==this.getAttribute("value")?t+=ke(this.getAttribute("value")):void 0!==this.getAttribute("contenteditable")&&(t+=this.getAttribute("value")||""),this.fragment&&(e="script"!==this.name&&"style"!==this.name,t+=this.fragment.toString(e)),yc.test(this.template.e)||(t+="</"+this.template.e+">"),t)},gv=tr,vv=er,_v=function(t){this.init(t)};_v.prototype={bubble:Hf,detach:Gf,find:qf,findAll:$f,findAllComponents:Kf,findComponent:Jf,findNextNode:Yf,firstNode:Qf,getAttribute:Xf,init:kg,rebind:Cg,render:fv,toString:mv,unbind:gv,unrender:vv};var yv=_v,wv=/^\s*$/,bv=/^\s*/,xv=function(t){var e,n,i,o;return e=t.split("\n"),n=e[0],void 0!==n&&wv.test(n)&&e.shift(),i=I(e),void 0!==i&&wv.test(i)&&e.pop(),o=e.reduce(ir,null),o&&(t=e.map(function(t){return t.replace(o,"")}).join("\n")),t},Lv=or,Pv=function(t,e){var n;return e?n=t.split("\n").map(function(t,n){return n?e+t:t}).join("\n"):t},Ev='Could not find template for partial "%s"',kv=function(t){var e,n;e=this.parentFragment=t.parentFragment,this.root=e.root,this.type=tu,this.index=t.index,this.name=t.template.r,this.rendered=!1,this.fragment=this.fragmentToRender=this.fragmentToUnrender=null,of.init(this,t),this.keypath||((n=Lv(this.root,this.name,e))?(Rp.call(this),this.isNamed=!0,this.setTemplate(n)):g(Ev,this.name))};kv.prototype={bubble:function(){this.parentFragment.bubble()},detach:function(){return this.fragment.detach()},find:function(t){return this.fragment.find(t)},findAll:function(t,e){return this.fragment.findAll(t,e)},findComponent:function(t){return this.fragment.findComponent(t)},findAllComponents:function(t,e){return this.fragment.findAllComponents(t,e)},firstNode:function(){return this.fragment.firstNode()},findNextNode:function(){return this.parentFragment.findNextNode(this)},getPartialName:function(){return this.isNamed&&this.name?this.name:void 0===this.value?this.name:this.value},getValue:function(){return this.fragment.getValue()},rebind:function(t,e){this.isNamed||nf.call(this,t,e),this.fragment&&this.fragment.rebind(t,e)},render:function(){return this.docFrag=document.createDocumentFragment(),this.update(),this.rendered=!0,this.docFrag},resolve:of.resolve,setValue:function(t){var e;(void 0===t||t!==this.value)&&(void 0!==t&&(e=Lv(this.root,""+t,this.parentFragment)),!e&&this.name&&(e=Lv(this.root,this.name,this.parentFragment))&&(Rp.call(this),this.isNamed=!0),e||g(Ev,this.name,{ractive:this.root}),this.value=t,this.setTemplate(e||[]),this.bubble(),this.rendered&&mh.addView(this))},setTemplate:function(t){this.fragment&&(this.fragment.unbind(),this.rendered&&(this.fragmentToUnrender=this.fragment)),this.fragment=new _y({template:t,root:this.root,owner:this,pElement:this.parentFragment.pElement}),this.fragmentToRender=this.fragment},toString:function(t){var e,n,i,o;return e=this.fragment.toString(t),n=this.parentFragment.items[this.index-1],n&&n.type===ql?(i=n.text.split("\n").pop(),(o=/^\s+$/.exec(i))?Pv(e,o[0]):e):e},unbind:function(){this.isNamed||Rp.call(this),this.fragment&&this.fragment.unbind()},unrender:function(t){this.rendered&&(this.fragment&&this.fragment.unrender(t),this.rendered=!1)},update:function(){var t,e;this.fragmentToUnrender&&(this.fragmentToUnrender.unrender(!0),this.fragmentToUnrender=null),this.fragmentToRender&&(this.docFrag.appendChild(this.fragmentToRender.render()),this.fragmentToRender=null),this.rendered&&(t=this.parentFragment.getNode(),e=this.parentFragment.findNextNode(this),t.insertBefore(this.docFrag,e))}};var Cv,Tv,Mv,Sv=kv,Av=lr,Dv=ur,Ov=new nh("detach"),Rv=cr,Iv=dr,Bv=pr,zv=fr,Uv=mr,Nv=gr,Fv=function(t,e,n,i){var o=t.root,r=t.keypath;i?o.viewmodel.smartUpdate(r,e,i):o.viewmodel.mark(r)},jv=[],Zv=["pop","push","reverse","shift","sort","splice","unshift"];Zv.forEach(function(t){var e=function(){for(var e=arguments.length,n=Array(e),i=0;e>i;i++)n[i]=arguments[i];var o,r,s,a;for(o=ml(this,t,n),r=Array.prototype[t].apply(this,arguments),mh.start(),this._ractive.setting=!0,a=this._ractive.wrappers.length;a--;)s=this._ractive.wrappers[a],mh.addRactive(s.root),Fv(s,this,t,o);return mh.end(),this._ractive.setting=!1,r};ba(jv,t,{value:e})}),Cv={},Cv.__proto__?(Tv=function(t){t.__proto__=jv},Mv=function(t){t.__proto__=Array.prototype}):(Tv=function(t){var e,n;for(e=Zv.length;e--;)n=Zv[e],ba(t,n,{value:jv[n],configurable:!0})},Mv=function(t){var e;for(e=Zv.length;e--;)delete t[Zv[e]]}),Tv.unpatch=Mv;var Wv,Vv,Hv,Gv=Tv;Wv={filter:function(t){return r(t)&&(!t._ractive||!t._ractive.setting)},wrap:function(t,e,n){return new Vv(t,e,n)}},Vv=function(t,e,n){this.root=t,this.value=e,this.keypath=P(n),e._ractive||(ba(e,"_ractive",{value:{wrappers:[],instances:[],setting:!1},configurable:!0}),Gv(e)),e._ractive.instances[t._guid]||(e._ractive.instances[t._guid]=0,e._ractive.instances.push(t)),e._ractive.instances[t._guid]+=1,e._ractive.wrappers.push(this)},Vv.prototype={get:function(){return this.value},teardown:function(){var t,e,n,i,o;if(t=this.value,e=t._ractive,n=e.wrappers,i=e.instances,e.setting)return!1;if(o=n.indexOf(this),-1===o)throw new Error(Hv);if(n.splice(o,1),n.length){if(i[this.root._guid]-=1,!i[this.root._guid]){if(o=i.indexOf(this.root),-1===o)throw new Error(Hv);i.splice(o,1)}}else delete t._ractive,Gv.unpatch(this.value)}},Hv="Something went wrong in a rather interesting way";var qv,$v,Kv=Wv,Jv=/^\s*[0-9]+\s*$/,Yv=function(t){return Jv.test(t)?[]:{}};try{Object.defineProperty({},"test",{value:0}),qv={filter:function(t,e,n){var i,o;return e?(e=P(e),(i=n.viewmodel.wrapped[e.parent.str])&&!i.magic?!1:(o=n.viewmodel.get(e.parent),r(o)&&/^[0-9]+$/.test(e.lastKey)?!1:o&&("object"==typeof o||"function"==typeof o))):!1},wrap:function(t,e,n){return new $v(t,e,n)}},$v=function(t,e,n){var i,o,r;return n=P(n),this.magic=!0,this.ractive=t,this.keypath=n,this.value=e,this.prop=n.lastKey,i=n.parent,this.obj=i.isRoot?t.viewmodel.data:t.viewmodel.get(i),o=this.originalDescriptor=Object.getOwnPropertyDescriptor(this.obj,this.prop),o&&o.set&&(r=o.set._ractiveWrappers)?void(-1===r.indexOf(this)&&r.push(this)):void vr(this,e,o)},$v.prototype={get:function(){return this.value},reset:function(t){return this.updating?void 0:(this.updating=!0,this.obj[this.prop]=t,mh.addRactive(this.ractive),this.ractive.viewmodel.mark(this.keypath,{keepExistingWrapper:!0}),this.updating=!1,!0)},set:function(t,e){this.updating||(this.obj[this.prop]||(this.updating=!0,this.obj[this.prop]=Yv(t),this.updating=!1),this.obj[this.prop][t]=e)},teardown:function(){var t,e,n,i,o;return this.updating?!1:(t=Object.getOwnPropertyDescriptor(this.obj,this.prop),e=t&&t.set,void(e&&(i=e._ractiveWrappers,o=i.indexOf(this),-1!==o&&i.splice(o,1),i.length||(n=this.obj[this.prop],Object.defineProperty(this.obj,this.prop,this.originalDescriptor||{writable:!0,enumerable:!0,configurable:!0}),this.obj[this.prop]=n))))}}}catch(Pa){qv=!1}var Qv,Xv,t_=qv;t_&&(Qv={filter:function(t,e,n){return t_.filter(t,e,n)&&Kv.filter(t)},wrap:function(t,e,n){return new Xv(t,e,n)}},Xv=function(t,e,n){this.value=e,this.magic=!0,this.magicWrapper=t_.wrap(t,e,n),this.arrayWrapper=Kv.wrap(t,e,n)},Xv.prototype={get:function(){return this.value},teardown:function(){this.arrayWrapper.teardown(),this.magicWrapper.teardown()},reset:function(t){return this.magicWrapper.reset(t)}});var e_=Qv,n_=_r,i_={},o_=br,r_=xr,s_=Er,a_=Sr,h_=Ar,l_=function(t,e){this.computation=t,this.viewmodel=t.viewmodel,this.ref=e,this.root=this.viewmodel.ractive,this.parentFragment=this.root.component&&this.root.component.parentFragment};l_.prototype={resolve:function(t){this.computation.softDeps.push(t),this.computation.unresolvedDeps[t.str]=null,this.viewmodel.register(t,this.computation,"computed")}};var u_=l_,c_=function(t,e){this.key=t,this.getter=e.getter,this.setter=e.setter,this.hardDeps=e.deps||[],this.softDeps=[],this.unresolvedDeps={},this.depValues={},this._dirty=this._firstRun=!0};c_.prototype={constructor:c_,init:function(t){var e,n=this;this.viewmodel=t,this.bypass=!0,e=t.get(this.key),t.clearCache(this.key.str),this.bypass=!1,this.setter&&void 0!==e&&this.set(e),this.hardDeps&&this.hardDeps.forEach(function(e){return t.register(e,n,"computed")})},invalidate:function(){this._dirty=!0},get:function(){var t,e,n=this,i=!1;if(this.getting){var o="The "+this.key.str+" computation indirectly called itself. This probably indicates a bug in the computation. It is commonly caused by `array.sort(...)` - if that's the case, clone the array first with `array.slice().sort(...)`";return f(o),this.value}if(this.getting=!0,this._dirty){if(this._firstRun||!this.hardDeps.length&&!this.softDeps.length?i=!0:[this.hardDeps,this.softDeps].forEach(function(t){var e,o,r;if(!i)for(r=t.length;r--;)if(e=t[r],o=n.viewmodel.get(e),!a(o,n.depValues[e.str]))return n.depValues[e.str]=o,void(i=!0)}),i){this.viewmodel.capture();try{this.value=this.getter()}catch(r){m('Failed to compute "%s"',this.key.str),d(r.stack||r),this.value=void 0}t=this.viewmodel.release(),e=this.updateDependencies(t),e&&[this.hardDeps,this.softDeps].forEach(function(t){t.forEach(function(t){n.depValues[t.str]=n.viewmodel.get(t)})})}this._dirty=!1}return this.getting=this._firstRun=!1,this.value},set:function(t){if(this.setting)return void(this.value=t);if(!this.setter)throw new Error("Computed properties without setters are read-only. (This may change in a future version of Ractive!)");this.setter(t)},updateDependencies:function(t){var e,n,i,o,r;for(n=this.softDeps,e=n.length;e--;)i=n[e],-1===t.indexOf(i)&&(o=!0,this.viewmodel.unregister(i,this,"computed"));for(e=t.length;e--;)i=t[e],-1!==n.indexOf(i)||this.hardDeps&&-1!==this.hardDeps.indexOf(i)||(o=!0,Dr(this.viewmodel,i)&&!this.unresolvedDeps[i.str]?(r=new u_(this,i.str),t.splice(e,1),this.unresolvedDeps[i.str]=r,mh.addUnresolved(r)):this.viewmodel.register(i,this,"computed"));return o&&(this.softDeps=t.slice()),o}};var d_=c_,p_=Or,f_={FAILED_LOOKUP:!0},m_=Rr,g_={},v_=Br,__=zr,y_=function(t,e){this.localKey=t,this.keypath=e.keypath,this.origin=e.origin,this.deps=[],this.unresolved=[],this.resolved=!1};y_.prototype={forceResolution:function(){this.keypath=this.localKey,this.setup()},get:function(t,e){return this.resolved?this.origin.get(this.map(t),e):void 0},getValue:function(){return this.keypath?this.origin.get(this.keypath):void 0},initViewmodel:function(t){this.local=t,this.setup()},map:function(t){return void 0===typeof this.keypath?this.localKey:t.replace(this.localKey,this.keypath)},register:function(t,e,n){this.deps.push({keypath:t,dep:e,group:n}),this.resolved&&this.origin.register(this.map(t),e,n)},resolve:function(t){void 0!==this.keypath&&this.unbind(!0),this.keypath=t,this.setup()},set:function(t,e){this.resolved||this.forceResolution(),this.origin.set(this.map(t),e)},setup:function(){var t=this;void 0!==this.keypath&&(this.resolved=!0,this.deps.length&&(this.deps.forEach(function(e){var n=t.map(e.keypath);if(t.origin.register(n,e.dep,e.group),e.dep.setValue)e.dep.setValue(t.origin.get(n));else{if(!e.dep.invalidate)throw new Error("An unexpected error occurred. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!");e.dep.invalidate()}}),this.origin.mark(this.keypath)))},setValue:function(t){if(!this.keypath)throw new Error("Mapping does not have keypath, cannot set value. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!");this.origin.set(this.keypath,t)},unbind:function(t){var e=this;t||delete this.local.mappings[this.localKey],this.resolved&&(this.deps.forEach(function(t){e.origin.unregister(e.map(t.keypath),t.dep,t.group)}),this.tracker&&this.origin.unregister(this.keypath,this.tracker))},unregister:function(t,e,n){var i,o;if(this.resolved){for(i=this.deps,o=i.length;o--;)if(i[o].dep===e){i.splice(o,1);break}this.origin.unregister(this.map(t),e,n)}}};var w_=Ur,b_=function(t,e){var n,i,o,r;return n={},i=0,o=t.map(function(t,o){var s,a,h;a=i,h=e.length;do{if(s=e.indexOf(t,a),-1===s)return r=!0,-1;a=s+1}while(n[s]&&h>a);return s===i&&(i+=1),s!==o&&(r=!0),n[s]=!0,s})},x_=Nr,L_={},P_=Zr,E_=Vr,k_=Hr,C_=Gr,T_=$r,M_={implicit:!0},S_={noCascade:!0},A_=Jr,D_=Yr,O_=function(t){var e,n,i=t.adapt,o=t.data,r=t.ractive,s=t.computed,a=t.mappings;this.ractive=r,this.adaptors=i,this.onchange=t.onchange,this.cache={},this.cacheMap=wa(null),this.deps={computed:wa(null),"default":wa(null)},this.depsMap={computed:wa(null),"default":wa(null)},this.patternObservers=[],this.specials=wa(null),this.wrapped=wa(null),this.computations=wa(null),this.captureGroups=[],this.unresolvedImplicitDependencies=[],this.changes=[],this.implicitChanges={},this.noCascade={},this.data=o,this.mappings=wa(null);for(e in a)this.map(P(e),a[e]);if(o)for(e in o)(n=this.mappings[e])&&void 0===n.getValue()&&n.setValue(o[e]);for(e in s)a&&e in a&&c("Cannot map to a computed property ('%s')",e),this.compute(P(e),s[e]);this.ready=!0};O_.prototype={adapt:n_,applyChanges:s_,capture:a_,clearCache:h_,compute:p_,get:m_,init:v_,map:__,mark:w_,merge:x_,register:P_,release:E_,reset:k_,set:C_,smartUpdate:T_,teardown:A_,unregister:D_};var R_=O_;Xr.prototype={constructor:Xr,begin:function(t){this.inProcess[t._guid]=!0},end:function(t){var e=t.parent;e&&this.inProcess[e._guid]?ts(this.queue,e).push(t):es(this,t),delete this.inProcess[t._guid]}};var I_=Xr,B_=ns,z_=/\$\{([^\}]+)\}/g,U_=new nh("construct"),N_=new nh("config"),F_=new I_("init"),j_=0,Z_=["adaptors","components","decorators","easing","events","interpolators","partials","transitions"],W_=ss,V_=cs;cs.prototype={bubble:function(){this.dirty||(this.dirty=!0,mh.addView(this))},update:function(){this.callback(this.fragment.getValue()),this.dirty=!1},rebind:function(t,e){this.fragment.rebind(t,e)},unbind:function(){this.fragment.unbind()}};var H_=function(t,e,n,o,s){var a,h,l,u,c,d,p={},f={},g={},v=[];for(h=t.parentFragment,l=t.root,s=s||{},i(p,s),s.content=o||[],p[""]=s.content,e.defaults.el&&m("The <%s/> component has a default `el` property; it has been disregarded",t.name),u=h;u;){if(u.owner.type===su){c=u.owner.container;break}u=u.parent}return n&&Object.keys(n).forEach(function(e){var i,o,s=n[e];if("string"==typeof s)i=Pd(s),f[e]=i?i.value:s;else if(0===s)f[e]=!0;else{if(!r(s))throw new Error("erm wut");ps(s)?(g[e]={origin:t.root.viewmodel,keypath:void 0},o=ds(t,s[0],function(t){t.isSpecial?d?a.set(e,t.value):(f[e]=t.value,delete g[e]):d?a.viewmodel.mappings[e].resolve(t):g[e].keypath=t})):o=new V_(t,s,function(t){d?a.set(e,t):f[e]=t}),v.push(o)}}),a=wa(e.prototype),W_(a,{el:null,append:!0,data:f,partials:s,magic:l.magic||e.defaults.magic,modifyArrays:l.modifyArrays,adapt:l.adapt},{parent:l,component:t,container:c,mappings:g,inlinePartials:p,cssIds:h.cssIds}),d=!0,t.resolvers=v,a},G_=fs,q_=function(t){var e,n;for(e=t.root;e;)(n=e._liveComponentQueries["_"+t.name])&&n.push(t.instance),e=e.parent},$_=gs,K_=vs,J_=_s,Y_=ys,Q_=ws,X_=new nh("teardown"),ty=xs,ey=function(t,e){this.init(t,e)};ey.prototype={detach:Dv,find:Rv,findAll:Iv,findAllComponents:Bv,findComponent:zv,findNextNode:Uv,firstNode:Nv,init:$_,rebind:K_,render:J_,toString:Y_,unbind:Q_,unrender:ty};var ny=ey,iy=function(t){this.type=eu,this.value=t.template.c;
};iy.prototype={detach:Ap,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createComment(this.value)),this.node},toString:function(){return"<!--"+this.value+"-->"},unrender:function(t){t&&this.node.parentNode.removeChild(this.node)}};var oy=iy,ry=function(t){var e,n;this.type=su,this.container=e=t.parentFragment.root,this.component=n=e.component,this.container=e,this.containerFragment=t.parentFragment,this.parentFragment=n.parentFragment;var i=this.name=t.template.n||"",o=e._inlinePartials[i];o||(m('Could not find template for partial "'+i+'"',{ractive:t.root}),o=[]),this.fragment=new _y({owner:this,root:e.parent,template:o,pElement:this.containerFragment.pElement}),r(n.yielders[i])?n.yielders[i].push(this):n.yielders[i]=[this],mh.scheduleTask(function(){if(n.yielders[i].length>1)throw new Error("A component template can only have one {{yield"+(i?" "+i:"")+"}} declaration at a time")})};ry.prototype={detach:function(){return this.fragment.detach()},find:function(t){return this.fragment.find(t)},findAll:function(t,e){return this.fragment.findAll(t,e)},findComponent:function(t){return this.fragment.findComponent(t)},findAllComponents:function(t,e){return this.fragment.findAllComponents(t,e)},findNextNode:function(){return this.containerFragment.findNextNode(this)},firstNode:function(){return this.fragment.firstNode()},getValue:function(t){return this.fragment.getValue(t)},render:function(){return this.fragment.render()},unbind:function(){this.fragment.unbind()},unrender:function(t){this.fragment.unrender(t),B(this.component.yielders[this.name],this)},rebind:function(t,e){this.fragment.rebind(t,e)},toString:function(){return this.fragment.toString()}};var sy=ry,ay=function(t){this.declaration=t.template.a};ay.prototype={init:Aa,render:Aa,unrender:Aa,teardown:Aa,toString:function(){return"<!DOCTYPE"+this.declaration+">"}};var hy=ay,ly=Ls,uy=Es,cy=ks,dy=Cs,py=Ss,fy=Ds,my=function(t){this.init(t)};my.prototype={bubble:yp,detach:wp,find:bp,findAll:xp,findAllComponents:Lp,findComponent:Pp,findNextNode:Ep,firstNode:kp,getArgsList:Tp,getNode:Mp,getValue:Sp,init:ly,rebind:uy,registerIndexRef:function(t){var e=this.registeredIndexRefs;-1===e.indexOf(t)&&e.push(t)},render:cy,toString:dy,unbind:py,unregisterIndexRef:function(t){var e=this.registeredIndexRefs;e.splice(e.indexOf(t),1)},unrender:fy};var gy,vy,_y=my,yy=Os,wy=["template","partials","components","decorators","events"],by=new nh("reset"),xy=function(t,e){function n(e,i,o){o&&o.partials[t]||e.forEach(function(e){e.type===tu&&e.getPartialName()===t&&i.push(e),e.fragment&&n(e.fragment.items,i,o),r(e.fragments)?n(e.fragments,i,o):r(e.items)?n(e.items,i,o):e.type===ru&&e.instance&&n(e.instance.fragment.items,i,e.instance),e.type===Xl&&(r(e.attributes)&&n(e.attributes,i,o),r(e.conditionalAttributes)&&n(e.conditionalAttributes,i,o))})}var i,o=[];return n(this.fragment.items,o),this.partials[t]=e,i=mh.start(this,!0),o.forEach(function(e){e.value=void 0,e.setValue(t)}),mh.end(),i},Ly=Rs,Py=vl("reverse"),Ey=Is,ky=vl("shift"),Cy=vl("sort"),Ty=vl("splice"),My=zs,Sy=Us,Ay=new nh("teardown"),Dy=Fs,Oy=js,Ry=Zs,Iy=new nh("unrender"),By=vl("unshift"),zy=Ws,Uy=new nh("update"),Ny=Vs,Fy={add:Ja,animate:bh,detach:Lh,find:Eh,findAll:Rh,findAllComponents:Ih,findComponent:Bh,findContainer:zh,findParent:Uh,fire:Zh,get:Wh,insert:Hh,merge:qh,observe:hl,observeOnce:ll,off:dl,on:pl,once:fl,pop:_l,push:yl,render:kl,reset:yy,resetPartial:xy,resetTemplate:Ly,reverse:Py,set:Ey,shift:ky,sort:Cy,splice:Ty,subtract:My,teardown:Sy,toggle:Dy,toHTML:Oy,toHtml:Oy,unrender:Ry,unshift:By,update:zy,updateModel:Ny},jy=function(t,e,n){return n||Gs(t,e)?function(){var n,i="_super"in this,o=this._super;return this._super=e,n=t.apply(this,arguments),i&&(this._super=o),n}:t},Zy=qs,Wy=Ys,Vy=function(t){var e,n,i={};return t&&(e=t._ractive)?(i.ractive=e.root,i.keypath=e.keypath.str,i.index={},(n=Wp(e.proxy.parentFragment))&&(i.index=Wp.resolve(n)),i):i};gy=function(t){return this instanceof gy?void W_(this,t):new gy(t)},vy={DEBUG:{writable:!0,value:!0},DEBUG_PROMISES:{writable:!0,value:!0},extend:{value:Wy},getNodeInfo:{value:Vy},parse:{value:$d},Promise:{value:sh},svg:{value:oa},magic:{value:na},VERSION:{value:"0.7.3"},adaptors:{writable:!0,value:{}},components:{writable:!0,value:{}},decorators:{writable:!0,value:{}},easing:{writable:!0,value:la},events:{writable:!0,value:{}},interpolators:{writable:!0,value:Na},partials:{writable:!0,value:{}},transitions:{writable:!0,value:{}}},xa(gy,vy),gy.prototype=i(Fy,ha),gy.prototype.constructor=gy,gy.defaults=gy.prototype;var Hy="function";if(typeof Date.now!==Hy||typeof String.prototype.trim!==Hy||typeof Object.keys!==Hy||typeof Array.prototype.indexOf!==Hy||typeof Array.prototype.forEach!==Hy||typeof Array.prototype.map!==Hy||typeof Array.prototype.filter!==Hy||"undefined"!=typeof window&&typeof window.addEventListener!==Hy)throw new Error("It looks like you're attempting to use Ractive.js in an older browser. You'll need to use one of the 'legacy builds' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.");var Gy=gy;return Gy}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ractive.events.tap=e()}(this,function(){"use strict";function t(t,n){return new e(t,n)}function e(t,e){this.node=t,this.callback=e,this.preventMousedownEvents=!1,this.bind(t)}function n(t){this.__tap_handler__.mousedown(t)}function i(t){this.__tap_handler__.touchdown(t)}function o(){this.addEventListener("keydown",s,!1),this.addEventListener("blur",r,!1)}function r(){this.removeEventListener("keydown",s,!1),this.removeEventListener("blur",r,!1)}function s(t){32===t.which&&this.__tap_handler__.fire()}var a=5,h=400;return e.prototype={bind:function(t){window.navigator.pointerEnabled?t.addEventListener("pointerdown",n,!1):window.navigator.msPointerEnabled?t.addEventListener("MSPointerDown",n,!1):t.addEventListener("mousedown",n,!1),t.addEventListener("touchstart",i,!1),("BUTTON"===t.tagName||"button"===t.type)&&t.addEventListener("focus",o,!1),t.__tap_handler__=this},fire:function(t,e,n){this.callback({node:this.node,original:t,x:e,y:n})},mousedown:function(t){var e=this;if(!this.preventMousedownEvents&&(void 0===t.which||1===t.which)){var n=t.clientX,i=t.clientY,o=t.pointerId,r=function(t){t.pointerId==o&&(e.fire(t,n,i),l())},s=function(t){t.pointerId==o&&(Math.abs(t.clientX-n)>=a||Math.abs(t.clientY-i)>=a)&&l()},l=function u(){e.node.removeEventListener("MSPointerUp",r,!1),document.removeEventListener("MSPointerMove",s,!1),document.removeEventListener("MSPointerCancel",u,!1),e.node.removeEventListener("pointerup",r,!1),document.removeEventListener("pointermove",s,!1),document.removeEventListener("pointercancel",u,!1),e.node.removeEventListener("click",r,!1),document.removeEventListener("mousemove",s,!1)};window.navigator.pointerEnabled?(this.node.addEventListener("pointerup",r,!1),document.addEventListener("pointermove",s,!1),document.addEventListener("pointercancel",l,!1)):window.navigator.msPointerEnabled?(this.node.addEventListener("MSPointerUp",r,!1),document.addEventListener("MSPointerMove",s,!1),document.addEventListener("MSPointerCancel",l,!1)):(this.node.addEventListener("click",r,!1),document.addEventListener("mousemove",s,!1)),setTimeout(l,h)}},touchdown:function(){var t=this,e=event.touches[0],n=e.clientX,i=e.clientY,o=e.identifier,r=function(e){var r=e.changedTouches[0];return r.identifier!==o?void l():(e.preventDefault(),t.preventMousedownEvents=!0,clearTimeout(t.preventMousedownTimeout),t.preventMousedownTimeout=setTimeout(function(){t.preventMousedownEvents=!1},400),t.fire(e,n,i),void l())},s=function(t){(1!==t.touches.length||t.touches[0].identifier!==o)&&l();var e=t.touches[0];(Math.abs(e.clientX-n)>=a||Math.abs(e.clientY-i)>=a)&&l()},l=function u(){t.node.removeEventListener("touchend",r,!1),window.removeEventListener("touchmove",s,!1),window.removeEventListener("touchcancel",u,!1)};this.node.addEventListener("touchend",r,!1),window.addEventListener("touchmove",s,!1),window.addEventListener("touchcancel",l,!1),setTimeout(l,h)},teardown:function(){var t=this.node;t.removeEventListener("pointerdown",n,!1),t.removeEventListener("MSPointerDown",n,!1),t.removeEventListener("mousedown",n,!1),t.removeEventListener("touchstart",i,!1),t.removeEventListener("focus",o,!1)}},t}),function(){function t(t){function e(e,n,i,o,r,s){for(;r>=0&&s>r;r+=t){var a=o?o[r]:r;i=n(i,e[a],a,e)}return i}return function(n,i,o,r){i=y(i,r,4);var s=!k(n)&&_.keys(n),a=(s||n).length,h=t>0?0:a-1;return arguments.length<3&&(o=n[s?s[h]:h],h+=t),e(n,i,o,s,h,a)}}function e(t){return function(e,n,i){n=w(n,i);for(var o=E(e),r=t>0?0:o-1;r>=0&&o>r;r+=t)if(n(e[r],r,e))return r;return-1}}function n(t,e,n){return function(i,o,r){var s=0,a=E(i);if("number"==typeof r)t>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(n&&r&&a)return r=n(i,o),i[r]===o?r:-1;if(o!==o)return r=e(u.call(i,s,a),_.isNaN),r>=0?r+s:-1;for(r=t>0?s:a-1;r>=0&&a>r;r+=t)if(i[r]===o)return r;return-1}}function i(t,e){var n=A.length,i=t.constructor,o=_.isFunction(i)&&i.prototype||a,r="constructor";for(_.has(t,r)&&!_.contains(e,r)&&e.push(r);n--;)r=A[n],r in t&&t[r]!==o[r]&&!_.contains(e,r)&&e.push(r)}var o=this,r=o._,s=Array.prototype,a=Object.prototype,h=Function.prototype,l=s.push,u=s.slice,c=a.toString,d=a.hasOwnProperty,p=Array.isArray,f=Object.keys,m=h.bind,g=Object.create,v=function(){},_=function(t){return t instanceof _?t:this instanceof _?void(this._wrapped=t):new _(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):o._=_,_.VERSION="1.8.3";var y=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)};case 4:return function(n,i,o,r){return t.call(e,n,i,o,r)}}return function(){return t.apply(e,arguments)}},w=function(t,e,n){return null==t?_.identity:_.isFunction(t)?y(t,e,n):_.isObject(t)?_.matcher(t):_.property(t)};_.iteratee=function(t,e){return w(t,e,1/0)};var b=function(t,e){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var o=1;i>o;o++)for(var r=arguments[o],s=t(r),a=s.length,h=0;a>h;h++){var l=s[h];e&&void 0!==n[l]||(n[l]=r[l])}return n}},x=function(t){if(!_.isObject(t))return{};if(g)return g(t);v.prototype=t;var e=new v;return v.prototype=null,e},L=function(t){return function(e){return null==e?void 0:e[t]}},P=Math.pow(2,53)-1,E=L("length"),k=function(t){var e=E(t);return"number"==typeof e&&e>=0&&P>=e};_.each=_.forEach=function(t,e,n){e=y(e,n);var i,o;if(k(t))for(i=0,o=t.length;o>i;i++)e(t[i],i,t);else{var r=_.keys(t);for(i=0,o=r.length;o>i;i++)e(t[r[i]],r[i],t)}return t},_.map=_.collect=function(t,e,n){e=w(e,n);for(var i=!k(t)&&_.keys(t),o=(i||t).length,r=Array(o),s=0;o>s;s++){var a=i?i[s]:s;r[s]=e(t[a],a,t)}return r},_.reduce=_.foldl=_.inject=t(1),_.reduceRight=_.foldr=t(-1),_.find=_.detect=function(t,e,n){var i;return i=k(t)?_.findIndex(t,e,n):_.findKey(t,e,n),void 0!==i&&-1!==i?t[i]:void 0},_.filter=_.select=function(t,e,n){var i=[];return e=w(e,n),_.each(t,function(t,n,o){e(t,n,o)&&i.push(t)}),i},_.reject=function(t,e,n){return _.filter(t,_.negate(w(e)),n)},_.every=_.all=function(t,e,n){e=w(e,n);for(var i=!k(t)&&_.keys(t),o=(i||t).length,r=0;o>r;r++){var s=i?i[r]:r;if(!e(t[s],s,t))return!1}return!0},_.some=_.any=function(t,e,n){e=w(e,n);for(var i=!k(t)&&_.keys(t),o=(i||t).length,r=0;o>r;r++){var s=i?i[r]:r;if(e(t[s],s,t))return!0}return!1},_.contains=_.includes=_.include=function(t,e,n,i){return k(t)||(t=_.values(t)),("number"!=typeof n||i)&&(n=0),_.indexOf(t,e,n)>=0},_.invoke=function(t,e){var n=u.call(arguments,2),i=_.isFunction(e);return _.map(t,function(t){var o=i?e:t[e];return null==o?o:o.apply(t,n)})},_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matcher(e))},_.findWhere=function(t,e){return _.find(t,_.matcher(e))},_.max=function(t,e,n){var i,o,r=-(1/0),s=-(1/0);if(null==e&&null!=t){t=k(t)?t:_.values(t);for(var a=0,h=t.length;h>a;a++)i=t[a],i>r&&(r=i)}else e=w(e,n),_.each(t,function(t,n,i){o=e(t,n,i),(o>s||o===-(1/0)&&r===-(1/0))&&(r=t,s=o)});return r},_.min=function(t,e,n){var i,o,r=1/0,s=1/0;if(null==e&&null!=t){t=k(t)?t:_.values(t);for(var a=0,h=t.length;h>a;a++)i=t[a],r>i&&(r=i)}else e=w(e,n),_.each(t,function(t,n,i){o=e(t,n,i),(s>o||o===1/0&&r===1/0)&&(r=t,s=o)});return r},_.shuffle=function(t){for(var e,n=k(t)?t:_.values(t),i=n.length,o=Array(i),r=0;i>r;r++)e=_.random(0,r),e!==r&&(o[r]=o[e]),o[e]=n[r];return o},_.sample=function(t,e,n){return null==e||n?(k(t)||(t=_.values(t)),t[_.random(t.length-1)]):_.shuffle(t).slice(0,Math.max(0,e))},_.sortBy=function(t,e,n){return e=w(e,n),_.pluck(_.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var C=function(t){return function(e,n,i){var o={};return n=w(n,i),_.each(e,function(i,r){var s=n(i,r,e);t(o,i,s)}),o}};_.groupBy=C(function(t,e,n){_.has(t,n)?t[n].push(e):t[n]=[e]}),_.indexBy=C(function(t,e,n){t[n]=e}),_.countBy=C(function(t,e,n){_.has(t,n)?t[n]++:t[n]=1}),_.toArray=function(t){return t?_.isArray(t)?u.call(t):k(t)?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:k(t)?t.length:_.keys(t).length},_.partition=function(t,e,n){e=w(e,n);var i=[],o=[];return _.each(t,function(t,n,r){(e(t,n,r)?i:o).push(t)}),[i,o]},_.first=_.head=_.take=function(t,e,n){return null!=t?null==e||n?t[0]:_.initial(t,t.length-e):void 0},_.initial=function(t,e,n){return u.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},_.last=function(t,e,n){return null!=t?null==e||n?t[t.length-1]:_.rest(t,Math.max(0,t.length-e)):void 0},_.rest=_.tail=_.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},_.compact=function(t){return _.filter(t,_.identity)};var T=function(t,e,n,i){for(var o=[],r=0,s=i||0,a=E(t);a>s;s++){var h=t[s];if(k(h)&&(_.isArray(h)||_.isArguments(h))){e||(h=T(h,e,n));var l=0,u=h.length;for(o.length+=u;u>l;)o[r++]=h[l++]}else n||(o[r++]=h)}return o};_.flatten=function(t,e){return T(t,e,!1)},_.without=function(t){return _.difference(t,u.call(arguments,1))},_.uniq=_.unique=function(t,e,n,i){_.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=w(n,i));for(var o=[],r=[],s=0,a=E(t);a>s;s++){var h=t[s],l=n?n(h,s,t):h;e?(s&&r===l||o.push(h),r=l):n?_.contains(r,l)||(r.push(l),o.push(h)):_.contains(o,h)||o.push(h)}return o},_.union=function(){return _.uniq(T(arguments,!0,!0))},_.intersection=function(t){for(var e=[],n=arguments.length,i=0,o=E(t);o>i;i++){var r=t[i];if(!_.contains(e,r)){for(var s=1;n>s&&_.contains(arguments[s],r);s++);s===n&&e.push(r)}}return e},_.difference=function(t){var e=T(arguments,!0,!0,1);return _.filter(t,function(t){return!_.contains(e,t)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(t){for(var e=t&&_.max(t,E).length||0,n=Array(e),i=0;e>i;i++)n[i]=_.pluck(t,i);return n},_.object=function(t,e){for(var n={},i=0,o=E(t);o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},_.findIndex=e(1),_.findLastIndex=e(-1),_.sortedIndex=function(t,e,n,i){n=w(n,i,1);for(var o=n(e),r=0,s=E(t);s>r;){var a=Math.floor((r+s)/2);n(t[a])<o?r=a+1:s=a}return r},_.indexOf=n(1,_.findIndex,_.sortedIndex),_.lastIndexOf=n(-1,_.findLastIndex),_.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=Array(i),r=0;i>r;r++,t+=n)o[r]=t;return o};var M=function(t,e,n,i,o){if(!(i instanceof e))return t.apply(n,o);var r=x(t.prototype),s=t.apply(r,o);return _.isObject(s)?s:r};_.bind=function(t,e){if(m&&t.bind===m)return m.apply(t,u.call(arguments,1));if(!_.isFunction(t))throw new TypeError("Bind must be called on a function");var n=u.call(arguments,2),i=function(){return M(t,i,e,this,n.concat(u.call(arguments)))};return i},_.partial=function(t){var e=u.call(arguments,1),n=function(){for(var i=0,o=e.length,r=Array(o),s=0;o>s;s++)r[s]=e[s]===_?arguments[i++]:e[s];for(;i<arguments.length;)r.push(arguments[i++]);return M(t,n,this,this,r)};return n},_.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)n=arguments[e],t[n]=_.bind(t[n],t);return t},_.memoize=function(t,e){var n=function(i){var o=n.cache,r=""+(e?e.apply(this,arguments):i);return _.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return n.cache={},n},_.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},_.defer=_.partial(_.delay,_,1),_.throttle=function(t,e,n){var i,o,r,s=null,a=0;n||(n={});var h=function(){a=n.leading===!1?0:_.now(),s=null,r=t.apply(i,o),s||(i=o=null)};return function(){var l=_.now();a||n.leading!==!1||(a=l);var u=e-(l-a);return i=this,o=arguments,0>=u||u>e?(s&&(clearTimeout(s),s=null),a=l,r=t.apply(i,o),s||(i=o=null)):s||n.trailing===!1||(s=setTimeout(h,u)),r}},_.debounce=function(t,e,n){var i,o,r,s,a,h=function(){var l=_.now()-s;e>l&&l>=0?i=setTimeout(h,e-l):(i=null,n||(a=t.apply(r,o),i||(r=o=null)))};return function(){r=this,o=arguments,s=_.now();var l=n&&!i;return i||(i=setTimeout(h,e)),l&&(a=t.apply(r,o),r=o=null),a}},_.wrap=function(t,e){return _.partial(e,t)},_.negate=function(t){return function(){return!t.apply(this,arguments)}},_.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},_.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},_.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},_.once=_.partial(_.before,2);var S=!{toString:null}.propertyIsEnumerable("toString"),A=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(t){if(!_.isObject(t))return[];if(f)return f(t);var e=[];for(var n in t)_.has(t,n)&&e.push(n);return S&&i(t,e),e},_.allKeys=function(t){if(!_.isObject(t))return[];var e=[];for(var n in t)e.push(n);return S&&i(t,e),e},_.values=function(t){for(var e=_.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=t[e[o]];return i},_.mapObject=function(t,e,n){e=w(e,n);for(var i,o=_.keys(t),r=o.length,s={},a=0;r>a;a++)i=o[a],s[i]=e(t[i],i,t);return s},_.pairs=function(t){for(var e=_.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=[e[o],t[e[o]]];return i},_.invert=function(t){for(var e={},n=_.keys(t),i=0,o=n.length;o>i;i++)e[t[n[i]]]=n[i];return e},_.functions=_.methods=function(t){var e=[];for(var n in t)_.isFunction(t[n])&&e.push(n);return e.sort()},_.extend=b(_.allKeys),_.extendOwn=_.assign=b(_.keys),_.findKey=function(t,e,n){e=w(e,n);for(var i,o=_.keys(t),r=0,s=o.length;s>r;r++)if(i=o[r],e(t[i],i,t))return i},_.pick=function(t,e,n){var i,o,r={},s=t;if(null==s)return r;_.isFunction(e)?(o=_.allKeys(s),i=y(e,n)):(o=T(arguments,!1,!1,1),i=function(t,e,n){return e in n},s=Object(s));for(var a=0,h=o.length;h>a;a++){var l=o[a],u=s[l];i(u,l,s)&&(r[l]=u)}return r},_.omit=function(t,e,n){if(_.isFunction(e))e=_.negate(e);else{var i=_.map(T(arguments,!1,!1,1),String);e=function(t,e){return!_.contains(i,e)}}return _.pick(t,e,n)},_.defaults=b(_.allKeys,!0),_.create=function(t,e){var n=x(t);return e&&_.extendOwn(n,e),n},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t},_.isMatch=function(t,e){var n=_.keys(e),i=n.length;if(null==t)return!i;for(var o=Object(t),r=0;i>r;r++){var s=n[r];if(e[s]!==o[s]||!(s in o))return!1}return!0};var D=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var o=c.call(t);if(o!==c.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(_.isFunction(s)&&s instanceof s&&_.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var h=n.length;h--;)if(n[h]===t)return i[h]===e;if(n.push(t),i.push(e),r){if(h=t.length,h!==e.length)return!1;for(;h--;)if(!D(t[h],e[h],n,i))return!1}else{var l,u=_.keys(t);if(h=u.length,_.keys(e).length!==h)return!1;for(;h--;)if(l=u[h],!_.has(e,l)||!D(t[l],e[l],n,i))return!1}return n.pop(),i.pop(),!0};_.isEqual=function(t,e){return D(t,e)},_.isEmpty=function(t){return null==t?!0:k(t)&&(_.isArray(t)||_.isString(t)||_.isArguments(t))?0===t.length:0===_.keys(t).length},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=p||function(t){return"[object Array]"===c.call(t)},_.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){_["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}}),_.isArguments(arguments)||(_.isArguments=function(t){return _.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(t){return"function"==typeof t||!1}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!==+t},_.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===c.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){return null!=t&&d.call(t,e)},_.noConflict=function(){return o._=r,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.noop=function(){},_.property=L,_.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},_.matcher=_.matches=function(t){return t=_.extendOwn({},t),function(e){return _.isMatch(e,t)}},_.times=function(t,e,n){var i=Array(Math.max(0,t));e=y(e,n,1);for(var o=0;t>o;o++)i[o]=e(o);return i},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},R=_.invert(O),I=function(t){var e=function(e){return t[e]},n="(?:"+_.keys(t).join("|")+")",i=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(o,e):t}};_.escape=I(O),_.unescape=I(R),_.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),_.isFunction(i)?i.call(t):i};var B=0;_.uniqueId=function(t){var e=++B+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,F=function(t){return"\\"+U[t]};_.template=function(t,e,n){!e&&n&&(e=n),e=_.defaults({},e,_.templateSettings);var i=RegExp([(e.escape||z).source,(e.interpolate||z).source,(e.evaluate||z).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(i,function(e,n,i,s,a){return r+=t.slice(o,a).replace(N,F),o=a+e.length,n?r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(a){throw a.source=r,a}var h=function(t){return s.call(this,t,_)},l=e.variable||"obj";return h.source="function("+l+"){\n"+r+"}",h},_.chain=function(t){var e=_(t);return e._chain=!0,e};var j=function(t,e){return t._chain?_(e).chain():e};_.mixin=function(t){_.each(_.functions(t),function(e){var n=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),j(this,n.apply(_,t))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];_.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],j(this,n)}}),_.each(["concat","join","slice"],function(t){var e=s[t];_.prototype[t]=function(){return j(this,e.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),!function(t,e,n){var i=t.L,o={};o.version="0.7.7","object"==typeof module&&"object"==typeof module.exports?module.exports=o:"function"==typeof define&&define.amd&&define(o),o.noConflict=function(){return t.L=i,this},t.L=o,o.Util={extend:function(t){var e,n,i,o,r=Array.prototype.slice.call(arguments,1);for(n=0,i=r.length;i>n;n++){o=r[n]||{};for(e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}return t},bind:function(t,e){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,n||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(n){return n[e]=n[e]||++t,n[e]}}(),invokeEach:function(t,e,n){var i,o;if("object"==typeof t){o=Array.prototype.slice.call(arguments,3);for(i in t)e.apply(n,[i,t[i]].concat(o));return!0}return!1},limitExecByInterval:function(t,e,n){var i,o;return function r(){var s=arguments;return i?void(o=!0):(i=!0,setTimeout(function(){i=!1,o&&(r.apply(n,s),o=!1)},e),void t.apply(n,s))}},falseFn:function(){return!1},formatNum:function(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return o.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=o.extend({},t.options,e),t.options},getParamString:function(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,i){var o=e[i];if(o===n)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var n,i,o=["webkit","moz","o","ms"];for(n=0;n<o.length&&!i;n++)i=t[o[n]+e];return i}function n(e){var n=+new Date,o=Math.max(0,16-(n-i));return i=n+o,t.setTimeout(e,o)}var i=0,r=t.requestAnimationFrame||e("RequestAnimationFrame")||n,s=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};o.Util.requestAnimFrame=function(e,i,s,a){return e=o.bind(e,i),s&&r===n?void e():r.call(t,e,a)},o.Util.cancelAnimFrame=function(e){e&&s.call(t,e)}}(),o.extend=o.Util.extend,o.bind=o.Util.bind,o.stamp=o.Util.stamp,o.setOptions=o.Util.setOptions,o.Class=function(){},o.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;i.constructor=e,e.prototype=i;for(var r in this)this.hasOwnProperty(r)&&"prototype"!==r&&(e[r]=this[r]);t.statics&&(o.extend(e,t.statics),delete t.statics),t.includes&&(o.Util.extend.apply(null,[i].concat(t.includes)),delete t.includes),t.options&&i.options&&(t.options=o.extend({},i.options,t.options)),o.extend(i,t),i._initHooks=[];var s=this;return e.__super__=s.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){s.prototype.callInitHooks&&s.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;e>t;t++)i._initHooks[t].call(this)}},e},o.Class.include=function(t){o.extend(this.prototype,t)},o.Class.mergeOptions=function(t){o.extend(this.prototype.options,t)},o.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var r="_leaflet_events";o.Mixin={},o.Mixin.Events={addEventListener:function(t,e,n){if(o.Util.invokeEach(t,this.addEventListener,this,e,n))return this;var i,s,a,h,l,u,c,d=this[r]=this[r]||{},p=n&&n!==this&&o.stamp(n);for(t=o.Util.splitWords(t),i=0,s=t.length;s>i;i++)a={action:e,context:n||this},h=t[i],p?(l=h+"_idx",u=l+"_len",c=d[l]=d[l]||{},c[p]||(c[p]=[],d[u]=(d[u]||0)+1),c[p].push(a)):(d[h]=d[h]||[],d[h].push(a));return this},hasEventListeners:function(t){var e=this[r];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,n){if(!this[r])return this;if(!t)return this.clearAllEventListeners();if(o.Util.invokeEach(t,this.removeEventListener,this,e,n))return this;var i,s,a,h,l,u,c,d,p,f=this[r],m=n&&n!==this&&o.stamp(n);for(t=o.Util.splitWords(t),i=0,s=t.length;s>i;i++)if(a=t[i],u=a+"_idx",c=u+"_len",d=f[u],e){if(h=m&&d?d[m]:f[a]){for(l=h.length-1;l>=0;l--)h[l].action!==e||n&&h[l].context!==n||(p=h.splice(l,1),p[0].action=o.Util.falseFn);n&&d&&0===h.length&&(delete d[m],f[c]--)}}else delete f[a],delete f[u],delete f[c];return this},clearAllEventListeners:function(){return delete this[r],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var n,i,s,a,h,l=o.Util.extend({},e,{type:t,target:this}),u=this[r];if(u[t])for(n=u[t].slice(),i=0,s=n.length;s>i;i++)n[i].action.call(n[i].context,l);a=u[t+"_idx"];for(h in a)if(n=a[h].slice())for(i=0,s=n.length;s>i;i++)n[i].action.call(n[i].context,l);return this},addOneTimeEventListener:function(t,e,n){if(o.Util.invokeEach(t,this.addOneTimeEventListener,this,e,n))return this;var i=o.bind(function(){this.removeEventListener(t,e,n).removeEventListener(t,i,n)},this);return this.addEventListener(t,e,n).addEventListener(t,i,n)}},o.Mixin.Events.on=o.Mixin.Events.addEventListener,o.Mixin.Events.off=o.Mixin.Events.removeEventListener,o.Mixin.Events.once=o.Mixin.Events.addOneTimeEventListener,o.Mixin.Events.fire=o.Mixin.Events.fireEvent,function(){var i="ActiveXObject"in t,r=i&&!e.addEventListener,s=navigator.userAgent.toLowerCase(),a=-1!==s.indexOf("webkit"),h=-1!==s.indexOf("chrome"),l=-1!==s.indexOf("phantom"),u=-1!==s.indexOf("android"),c=-1!==s.search("android [23]"),d=-1!==s.indexOf("gecko"),p=typeof orientation!=n+"",f=!t.PointerEvent&&t.MSPointerEvent,m=t.PointerEvent&&t.navigator.pointerEnabled||f,g="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,v=e.documentElement,_=i&&"transition"in v.style,y="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!c,w="MozPerspective"in v.style,b="OTransition"in v.style,x=!t.L_DISABLE_3D&&(_||y||w||b)&&!l,L=!t.L_NO_TOUCH&&!l&&(m||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch);o.Browser={ie:i,ielt9:r,webkit:a,gecko:d&&!a&&!t.opera&&!i,android:u,android23:c,chrome:h,ie3d:_,webkit3d:y,gecko3d:w,opera3d:b,any3d:x,mobile:p,mobileWebkit:p&&a,mobileWebkit3d:p&&y,mobileOpera:p&&t.opera,touch:L,msPointer:f,pointer:m,retina:g}}(),o.Point=function(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e},o.Point.prototype={clone:function(){return new o.Point(this.x,this.y)},add:function(t){return this.clone()._add(o.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(o.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){
return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=o.point(t);var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return t=o.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=o.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+o.Util.formatNum(this.x)+", "+o.Util.formatNum(this.y)+")"}},o.point=function(t,e,i){return t instanceof o.Point?t:o.Util.isArray(t)?new o.Point(t[0],t[1]):t===n||null===t?t:new o.Point(t,e,i)},o.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},o.Bounds.prototype={extend:function(t){return t=o.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new o.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new o.Point(this.min.x,this.max.y)},getTopRight:function(){return new o.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return t="number"==typeof t[0]||t instanceof o.Point?o.point(t):o.bounds(t),t instanceof o.Bounds?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=o.bounds(t);var e=this.min,n=this.max,i=t.min,r=t.max,s=r.x>=e.x&&i.x<=n.x,a=r.y>=e.y&&i.y<=n.y;return s&&a},isValid:function(){return!(!this.min||!this.max)}},o.bounds=function(t,e){return!t||t instanceof o.Bounds?t:new o.Bounds(t,e)},o.Transformation=function(t,e,n,i){this._a=t,this._b=e,this._c=n,this._d=i},o.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new o.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},o.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,n){var i=t.style[n];if(!i&&t.currentStyle&&(i=t.currentStyle[n]),(!i||"auto"===i)&&e.defaultView){var o=e.defaultView.getComputedStyle(t,null);i=o?o[n]:null}return"auto"===i?null:i},getViewportOffset:function(t){var n,i=0,r=0,s=t,a=e.body,h=e.documentElement;do{if(i+=s.offsetTop||0,r+=s.offsetLeft||0,i+=parseInt(o.DomUtil.getStyle(s,"borderTopWidth"),10)||0,r+=parseInt(o.DomUtil.getStyle(s,"borderLeftWidth"),10)||0,n=o.DomUtil.getStyle(s,"position"),s.offsetParent===a&&"absolute"===n)break;if("fixed"===n){i+=a.scrollTop||h.scrollTop||0,r+=a.scrollLeft||h.scrollLeft||0;break}if("relative"===n&&!s.offsetLeft){var l=o.DomUtil.getStyle(s,"width"),u=o.DomUtil.getStyle(s,"max-width"),c=s.getBoundingClientRect();("none"!==l||"none"!==u)&&(r+=c.left+s.clientLeft),i+=c.top+(a.scrollTop||h.scrollTop||0);break}s=s.offsetParent}while(s);s=t;do{if(s===a)break;i-=s.scrollTop||0,r-=s.scrollLeft||0,s=s.parentNode}while(s);return new o.Point(r,i)},documentIsLtr:function(){return o.DomUtil._docIsLtrCached||(o.DomUtil._docIsLtrCached=!0,o.DomUtil._docIsLtr="ltr"===o.DomUtil.getStyle(e.body,"direction")),o.DomUtil._docIsLtr},create:function(t,n,i){var o=e.createElement(t);return o.className=n,i&&i.appendChild(o),o},hasClass:function(t,e){if(t.classList!==n)return t.classList.contains(e);var i=o.DomUtil._getClass(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(t.classList!==n)for(var i=o.Util.splitWords(e),r=0,s=i.length;s>r;r++)t.classList.add(i[r]);else if(!o.DomUtil.hasClass(t,e)){var a=o.DomUtil._getClass(t);o.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==n?t.classList.remove(e):o.DomUtil._setClass(t,o.Util.trim((" "+o.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===n?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===n?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(o){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}},testProp:function(t){for(var n=e.documentElement.style,i=0;i<t.length;i++)if(t[i]in n)return t[i];return!1},getTranslateString:function(t){var e=o.Browser.webkit3d,n="translate"+(e?"3d":"")+"(",i=(e?",0":"")+")";return n+t.x+"px,"+t.y+"px"+i},getScaleString:function(t,e){var n=o.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),i=" scale("+t+") ";return n+i},setPosition:function(t,e,n){t._leaflet_pos=e,!n&&o.Browser.any3d?t.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},o.DomUtil.TRANSFORM=o.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),o.DomUtil.TRANSITION=o.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),o.DomUtil.TRANSITION_END="webkitTransition"===o.DomUtil.TRANSITION||"OTransition"===o.DomUtil.TRANSITION?o.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in e)o.extend(o.DomUtil,{disableTextSelection:function(){o.DomEvent.on(t,"selectstart",o.DomEvent.preventDefault)},enableTextSelection:function(){o.DomEvent.off(t,"selectstart",o.DomEvent.preventDefault)}});else{var n=o.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);o.extend(o.DomUtil,{disableTextSelection:function(){if(n){var t=e.documentElement.style;this._userSelect=t[n],t[n]="none"}},enableTextSelection:function(){n&&(e.documentElement.style[n]=this._userSelect,delete this._userSelect)}})}o.extend(o.DomUtil,{disableImageDrag:function(){o.DomEvent.on(t,"dragstart",o.DomEvent.preventDefault)},enableImageDrag:function(){o.DomEvent.off(t,"dragstart",o.DomEvent.preventDefault)}})}(),o.LatLng=function(t,e,i){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,i!==n&&(this.alt=parseFloat(i))},o.extend(o.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),o.LatLng.prototype={equals:function(t){if(!t)return!1;t=o.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=o.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+o.Util.formatNum(this.lat,t)+", "+o.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=o.latLng(t);var e=6378137,n=o.LatLng.DEG_TO_RAD,i=(t.lat-this.lat)*n,r=(t.lng-this.lng)*n,s=this.lat*n,a=t.lat*n,h=Math.sin(i/2),l=Math.sin(r/2),u=h*h+l*l*Math.cos(s)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))},wrap:function(t,e){var n=this.lng;return t=t||-180,e=e||180,n=(n+e)%(e-t)+(t>n||n===e?e:t),new o.LatLng(this.lat,n)}},o.latLng=function(t,e){return t instanceof o.LatLng?t:o.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new o.LatLng(t[0],t[1],t[2]):null:t===n||null===t?t:"object"==typeof t&&"lat"in t?new o.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===n?null:new o.LatLng(t,e)},o.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},o.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=o.latLng(t);return t=null!==e?e:o.latLngBounds(t),t instanceof o.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new o.LatLng(t.lat,t.lng),this._northEast=new o.LatLng(t.lat,t.lng)):t instanceof o.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,r=Math.abs(e.lng-n.lng)*t;return new o.LatLngBounds(new o.LatLng(e.lat-i,e.lng-r),new o.LatLng(n.lat+i,n.lng+r))},getCenter:function(){return new o.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new o.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new o.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof o.LatLng?o.latLng(t):o.latLngBounds(t);var e,n,i=this._southWest,r=this._northEast;return t instanceof o.LatLngBounds?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=r.lat&&e.lng>=i.lng&&n.lng<=r.lng},intersects:function(t){t=o.latLngBounds(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),r=t.getNorthEast(),s=r.lat>=e.lat&&i.lat<=n.lat,a=r.lng>=e.lng&&i.lng<=n.lng;return s&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=o.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},o.latLngBounds=function(t,e){return!t||t instanceof o.LatLngBounds?t:new o.LatLngBounds(t,e)},o.Projection={},o.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=o.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),r=t.lng*e,s=i*e;return s=Math.log(Math.tan(Math.PI/4+s/2)),new o.Point(r,s)},unproject:function(t){var e=o.LatLng.RAD_TO_DEG,n=t.x*e,i=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new o.LatLng(i,n)}},o.Projection.LonLat={project:function(t){return new o.Point(t.lng,t.lat)},unproject:function(t){return new o.LatLng(t.y,t.x)}},o.CRS={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return o.point(e,e)}},o.CRS.Simple=o.extend({},o.CRS,{projection:o.Projection.LonLat,transformation:new o.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),o.CRS.EPSG3857=o.extend({},o.CRS,{code:"EPSG:3857",projection:o.Projection.SphericalMercator,transformation:new o.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),n=6378137;return e.multiplyBy(n)}}),o.CRS.EPSG900913=o.extend({},o.CRS.EPSG3857,{code:"EPSG:900913"}),o.CRS.EPSG4326=o.extend({},o.CRS,{code:"EPSG:4326",projection:o.Projection.LonLat,transformation:new o.Transformation(1/360,.5,-1/360,.5)}),o.Map=o.Class.extend({includes:o.Mixin.Events,options:{crs:o.CRS.EPSG3857,fadeAnimation:o.DomUtil.TRANSITION&&!o.Browser.android23,trackResize:!0,markerZoomAnimation:o.DomUtil.TRANSITION&&o.Browser.any3d},initialize:function(t,e){e=o.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=o.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==n&&this.setView(o.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===n?this.getZoom():e,this._resetView(o.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),r=this.getSize().divideBy(2),s=t instanceof o.Point?t:this.latLngToContainerPoint(t),a=s.subtract(r).multiplyBy(1-1/i),h=this.containerPointToLatLng(r.add(a));return this.setView(h,e,{zoom:n})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():o.latLngBounds(t);var n=o.point(e.paddingTopLeft||e.padding||[0,0]),i=o.point(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,n.add(i));r=e.maxZoom?Math.min(e.maxZoom,r):r;var s=i.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),r),h=this.project(t.getNorthEast(),r),l=this.unproject(a.add(h).divideBy(2).add(s),r);return this.setView(l,r,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(o.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=o.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,t);return n.equals(i)?this:this.panTo(i,e)},addLayer:function(t){var e=o.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&o.TileLayer&&t instanceof o.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=o.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&o.TileLayer&&t instanceof o.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?o.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=o.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),r=n.divideBy(2).round(),s=i.subtract(r);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=n}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new o.LatLngBounds(e,n)},getMinZoom:function(){return this.options.minZoom===n?this._layersMinZoom===n?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===n?this._layersMaxZoom===n?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=o.latLngBounds(t);var i,r=this.getMinZoom()-(e?1:0),s=this.getMaxZoom(),a=this.getSize(),h=t.getNorthWest(),l=t.getSouthEast(),u=!0;n=o.point(n||[0,0]);do r++,i=this.project(l,r).subtract(this.project(h,r)).add(n),u=e?i.x<a.x||i.y<a.y:a.contains(i);while(u&&s>=r);return u&&e?null:e?r:r-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new o.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new o.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===n?this._zoom:e,this.options.crs.latLngToPoint(o.latLng(t),e)},unproject:function(t,e){return e=e===n?this._zoom:e,this.options.crs.pointToLatLng(o.point(t),e)},layerPointToLatLng:function(t){var e=o.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(o.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return o.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return o.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(o.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(o.latLng(t)))},mouseEventToContainerPoint:function(t){return o.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=o.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;o.DomUtil.addClass(t,"leaflet-container"+(o.Browser.touch?" leaflet-touch":"")+(o.Browser.retina?" leaflet-retina":"")+(o.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=o.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(o.DomUtil.addClass(t.markerPane,e),o.DomUtil.addClass(t.shadowPane,e),o.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return o.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?o.Util.isArray(t)?t:[t]:[];for(var e=0,n=t.length;n>e;e++)this.addLayer(t[e])},_resetView:function(t,e,n,i){var r=this._zoom!==e;i||(this.fire("movestart"),r&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),n?this._initialTopLeftPoint._add(this._getMapPanePos()):o.DomUtil.setPosition(this._mapPane,new o.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var s=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),s&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(r||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(t){o.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,i=-(1/0),o=this._getZoomSpan();for(t in this._zoomBoundLayers){var r=this._zoomBoundLayers[t];isNaN(r.options.minZoom)||(e=Math.min(e,r.options.minZoom)),isNaN(r.options.maxZoom)||(i=Math.max(i,r.options.maxZoom))}t===n?this._layersMaxZoom=this._layersMinZoom=n:(this._layersMaxZoom=i,this._layersMinZoom=e),o!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(o.DomEvent){e=e||"on",o.DomEvent[e](this._container,"click",this._onMouseClick,this);var n,i,r=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(n=0,i=r.length;i>n;n++)o.DomEvent[e](this._container,r[n],this._fireMouseEvent,this);this.options.trackResize&&o.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){o.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=o.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||o.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!o.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&o.DomEvent.preventDefault(t);var n=this.mouseEventToContainerPoint(t),i=this.containerPointToLayerPoint(n),r=this.layerPointToLatLng(i);this.fire(e,{latlng:r,layerPoint:i,containerPoint:n,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return o.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewTopLeftPoint(n,e).add(this._getMapPanePos());return this.project(t,e)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),r=this.getSize().divideBy(2),s=new o.Bounds(i.subtract(r),i.add(r)),a=this._getBoundsOffset(s,n,e);return this.unproject(i.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new o.Bounds(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=this.project(e.getNorthWest(),n).subtract(t.min),r=this.project(e.getSouthEast(),n).subtract(t.max),s=this._rebound(i.x,-r.x),a=this._rebound(i.y,-r.y);return new o.Point(s,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom();return Math.max(e,Math.min(n,t))}}),o.map=function(t,e){return new o.Map(t,e)},o.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=o.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),r=this.R_MAJOR,s=this.R_MINOR,a=t.lng*e*r,h=i*e,l=s/r,u=Math.sqrt(1-l*l),c=u*Math.sin(h);c=Math.pow((1-c)/(1+c),.5*u);var d=Math.tan(.5*(.5*Math.PI-h))/c;return h=-r*Math.log(d),new o.Point(a,h)},unproject:function(t){for(var e,n=o.LatLng.RAD_TO_DEG,i=this.R_MAJOR,r=this.R_MINOR,s=t.x*n/i,a=r/i,h=Math.sqrt(1-a*a),l=Math.exp(-t.y/i),u=Math.PI/2-2*Math.atan(l),c=15,d=1e-7,p=c,f=.1;Math.abs(f)>d&&--p>0;)e=h*Math.sin(u),f=Math.PI/2-2*Math.atan(l*Math.pow((1-e)/(1+e),.5*h))-u,u+=f;return new o.LatLng(u*n,s)}},o.CRS.EPSG3395=o.extend({},o.CRS,{code:"EPSG:3395",projection:o.Projection.Mercator,transformation:function(){var t=o.Projection.Mercator,e=t.R_MAJOR,n=.5/(Math.PI*e);return new o.Transformation(n,.5,-n,.5)}()}),o.TileLayer=o.Class.extend({includes:o.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:o.Browser.mobile,updateWhenIdle:o.Browser.mobile},initialize:function(t,e){e=o.setOptions(this,e),e.detectRetina&&o.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=o.latLngBounds(e.bounds)),this._url=t;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=o.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==n&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var n,i,o,r=t.children,s=-e(1/0,-(1/0));for(i=0,o=r.length;o>i;i++)r[i]!==this._container&&(n=parseInt(r[i].style.zIndex,10),isNaN(n)||(s=e(s,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(s)?s:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(o.Browser.ielt9)for(t in e)o.DomUtil.setOpacity(e[t],this.options.opacity);else o.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=o.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=o.DomUtil.create("div",e,this._container),this._tileContainer=o.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&e>n&&(i=Math.round(t.getZoomScale(e)/t.getZoomScale(n)*i)),i},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),n=t.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var r=o.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(r),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(r)}}},_addTilesFromCenterOut:function(t){var n,i,r,s=[],a=t.getCenter();for(n=t.min.y;n<=t.max.y;n++)for(i=t.min.x;i<=t.max.x;i++)r=new o.Point(i,n),this._tileShouldBeLoaded(r)&&s.push(r);var h=s.length;if(0!==h){s.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var l=e.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=h,i=0;h>i;i++)this._addTile(s[i],l);this._tileContainer.appendChild(l)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var n=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=n.x)||t.y<0||t.y>=n.y)return!1}if(e.bounds){var i=this._getTileSize(),o=t.multiplyBy(i),r=o.add([i,i]),s=this._map.unproject(o),a=this._map.unproject(r);if(e.continuousWorld||e.noWrap||(s=s.wrap(),a=a.wrap()),!e.bounds.intersects([s,a]))return!1}return!0},_removeOtherTiles:function(t){var e,n,i,o;for(o in this._tiles)e=o.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),(n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(o.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),o.Browser.android||(e.onload=null,e.src=o.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var n=this._getTilePos(t),i=this._getTile();o.DomUtil.setPosition(i,n,o.Browser.chrome),this._tiles[t.x+":"+t.y]=i,this._loadTile(i,t),i.parentNode!==this._tileContainer&&e.appendChild(i)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),n=this._getTileSize();return t.multiplyBy(n).subtract(e)},getTileUrl:function(t){return o.Util.template(this._url,o.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=o.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=o.Util.falseFn,o.Browser.ielt9&&this.options.opacity!==n&&o.DomUtil.setOpacity(t,this.options.opacity),o.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&o.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),
this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(o.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==o.Util.emptyImageUrl&&(o.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),o.tileLayer=function(t,e){return new o.TileLayer(t,e)},o.TileLayer.WMS=o.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var n=o.extend({},this.defaultWmsParams),i=e.tileSize||this.options.tileSize;e.detectRetina&&o.Browser.retina?n.width=n.height=2*i:n.width=n.height=i;for(var r in e)this.options.hasOwnProperty(r)||"crs"===r||(n[r]=e[r]);this.wmsParams=n,o.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,o.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,n=this.options.tileSize,i=t.multiplyBy(n),r=i.add([n,n]),s=this._crs.project(e.unproject(i,t.z)),a=this._crs.project(e.unproject(r,t.z)),h=this._wmsVersion>=1.3&&this._crs===o.CRS.EPSG4326?[a.y,s.x,s.y,a.x].join(","):[s.x,a.y,a.x,s.y].join(","),l=o.Util.template(this._url,{s:this._getSubdomain(t)});return l+o.Util.getParamString(this.wmsParams,l,!0)+"&BBOX="+h},setParams:function(t,e){return o.extend(this.wmsParams,t),e||this.redraw(),this}}),o.tileLayer.wms=function(t,e){return new o.TileLayer.WMS(t,e)},o.TileLayer.Canvas=o.TileLayer.extend({options:{async:!1},initialize:function(t){o.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=o.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=o.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),o.tileLayer.canvas=function(t){return new o.TileLayer.Canvas(t)},o.ImageOverlay=o.Class.extend({includes:o.Mixin.Events,options:{opacity:1},initialize:function(t,e,n){this._url=t,this._bounds=o.latLngBounds(e),o.setOptions(this,n)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&o.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=o.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&o.Browser.any3d?o.DomUtil.addClass(this._image,"leaflet-zoom-animated"):o.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),o.extend(this._image,{galleryimg:"no",onselectstart:o.Util.falseFn,onmousemove:o.Util.falseFn,onload:o.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,n=this._image,i=e.getZoomScale(t.zoom),r=this._bounds.getNorthWest(),s=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(r,t.zoom,t.center),h=e._latLngToNewLayerPoint(s,t.zoom,t.center)._subtract(a),l=a._add(h._multiplyBy(.5*(1-1/i)));n.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(l)+" scale("+i+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);o.DomUtil.setPosition(t,e),t.style.width=n.x+"px",t.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){o.DomUtil.setOpacity(this._image,this.options.opacity)}}),o.imageOverlay=function(t,e,n){return new o.ImageOverlay(t,e,n)},o.Icon=o.Class.extend({options:{className:""},initialize:function(t){o.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i;return i=e&&"IMG"===e.tagName?this._createImg(n,e):this._createImg(n),this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n,i=this.options,r=o.point(i[e+"Size"]);n="shadow"===e?o.point(i.shadowAnchor||i.iconAnchor):o.point(i.iconAnchor),!n&&r&&(n=r.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+i.className,n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,n){return n=n||e.createElement("img"),n.src=t,n},_getIconUrl:function(t){return o.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),o.icon=function(t){return new o.Icon(t)},o.Icon.Default=o.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];o.Browser.retina&&"icon"===t&&(t+="-2x");var n=o.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+".png"}}),o.Icon.Default.imagePath=function(){var t,n,i,o,r,s=e.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,n=s.length;n>t;t++)if(i=s[t].src,o=i.match(a))return r=i.split(a)[0],(r?r+"/":"")+"images"}(),o.Marker=o.Class.extend({includes:o.Mixin.Events,options:{icon:new o.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation,i=n?"leaflet-zoom-animated":"leaflet-zoom-hide",r=t.icon.createIcon(this._icon),s=!1;r!==this._icon&&(this._icon&&this._removeIcon(),s=!0,t.title&&(r.title=t.title),t.alt&&(r.alt=t.alt)),o.DomUtil.addClass(r,i),t.keyboard&&(r.tabIndex="0"),this._icon=r,this._initInteraction(),t.riseOnHover&&o.DomEvent.on(r,"mouseover",this._bringToFront,this).on(r,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),h=!1;a!==this._shadow&&(this._removeShadow(),h=!0),a&&o.DomUtil.addClass(a,i),this._shadow=a,t.opacity<1&&this._updateOpacity();var l=this._map._panes;s&&l.markerPane.appendChild(this._icon),a&&h&&l.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&o.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){o.DomUtil.setPosition(this._icon,t),this._shadow&&o.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];o.DomUtil.addClass(t,"leaflet-clickable"),o.DomEvent.on(t,"click",this._onMouseClick,this),o.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)o.DomEvent.on(t,e[n],this._fireMouseEvent,this);o.Handler.MarkerDrag&&(this.dragging=new o.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&o.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&o.DomEvent.preventDefault(t),"mousedown"!==t.type?o.DomEvent.stopPropagation(t):o.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){o.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&o.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),o.marker=function(t,e){return new o.Marker(t,e)},o.DivIcon=o.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var n=t&&"DIV"===t.tagName?t:e.createElement("div"),i=this.options;return i.html!==!1?n.innerHTML=i.html:n.innerHTML="",i.bgPos&&(n.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(n,"icon"),n},createShadow:function(){return null}}),o.divIcon=function(t){return new o.DivIcon(t)},o.Map.mergeOptions({closePopupOnClick:!0}),o.Popup=o.Class.extend({includes:o.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){o.setOptions(this,t),this._source=e,this._animated=o.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&o.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&o.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),o.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&o.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",n=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=o.DomUtil.create("div",n);this.options.closeButton&&(t=this._closeButton=o.DomUtil.create("a",e+"-close-button",i),t.href="#close",t.innerHTML="&#215;",o.DomEvent.disableClickPropagation(t),o.DomEvent.on(t,"click",this._onCloseButtonClick,this));var r=this._wrapper=o.DomUtil.create("div",e+"-content-wrapper",i);o.DomEvent.disableClickPropagation(r),this._contentNode=o.DomUtil.create("div",e+"-content",r),o.DomEvent.disableScrollPropagation(this._contentNode),o.DomEvent.on(r,"contextmenu",o.DomEvent.stopPropagation),this._tipContainer=o.DomUtil.create("div",e+"-tip-container",i),this._tip=o.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,r=this.options.maxHeight,s="leaflet-popup-scrolled";r&&i>r?(e.height=r+"px",o.DomUtil.addClass(t,s)):o.DomUtil.removeClass(t,s),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=o.point(this.options.offset);e&&o.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);o.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,n=this._containerWidth,i=new o.Point(this._containerLeft,-e-this._containerBottom);this._animated&&i._add(o.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(i),s=o.point(this.options.autoPanPadding),a=o.point(this.options.autoPanPaddingTopLeft||s),h=o.point(this.options.autoPanPaddingBottomRight||s),l=t.getSize(),u=0,c=0;r.x+n+h.x>l.x&&(u=r.x+n-l.x+h.x),r.x-u-a.x<0&&(u=r.x-a.x),r.y+e+h.y>l.y&&(c=r.y+e-l.y+h.y),r.y-c-a.y<0&&(c=r.y-a.y),(u||c)&&t.fire("autopanstart").panBy([u,c])}},_onCloseButtonClick:function(t){this._close(),o.DomEvent.stop(t)}}),o.popup=function(t,e){return new o.Popup(t,e)},o.Map.include({openPopup:function(t,e,n){if(this.closePopup(),!(t instanceof o.Popup)){var i=t;t=new o.Popup(n).setLatLng(e).setContent(i)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),o.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var n=o.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(o.Popup.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=o.extend({offset:n},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof o.Popup?(o.setOptions(t,e),this._popup=t,t._source=this):this._popup=new o.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),o.LayerGroup=o.Class.extend({initialize:function(t){this._layers={};var e,n;if(t)for(e=0,n=t.length;n>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)n=this._layers[e],n[t]&&n[t].apply(n,i);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return o.stamp(t)}}),o.layerGroup=function(t){return new o.LayerGroup(t)},o.FeatureGroup=o.LayerGroup.extend({includes:o.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(o.FeatureGroup.EVENTS,this._propagateEvent,this),o.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(o.FeatureGroup.EVENTS,this._propagateEvent,this),o.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new o.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof o.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=o.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),o.featureGroup=function(t){return new o.FeatureGroup(t)},o.Path=o.Class.extend({includes:[o.Mixin.Events],statics:{CLIP_PADDING:function(){var e=o.Browser.mobile?1280:2e3,n=(e/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,n))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){o.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,o.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return o.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),o.Map.include({_updatePathViewport:function(){var t=o.Path.CLIP_PADDING,e=this.getSize(),n=o.DomUtil.getPosition(this._mapPane),i=n.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),r=i.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new o.Bounds(i,r)}}),o.Path.SVG_NS="http://www.w3.org/2000/svg",o.Browser.svg=!(!e.createElementNS||!e.createElementNS(o.Path.SVG_NS,"svg").createSVGRect),o.Path=o.Path.extend({statics:{SVG:o.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,n=t.firstChild;return e&&n!==e&&t.insertBefore(e,n),this},getPathString:function(){},_createElement:function(t){return e.createElementNS(o.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&o.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(o.Browser.svg||!o.Browser.vml)&&o.DomUtil.addClass(this._path,"leaflet-clickable"),o.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)o.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,n=e.mouseEventToContainerPoint(t),i=e.containerPointToLayerPoint(n),r=e.layerPointToLatLng(i);this.fire(t.type,{latlng:r,layerPoint:i,containerPoint:n,originalEvent:t}),"contextmenu"===t.type&&o.DomEvent.preventDefault(t),"mousemove"!==t.type&&o.DomEvent.stopPropagation(t)}}}),o.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=o.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&o.Browser.any3d?(o.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):o.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),n=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max,i=n.x-e.x,r=n.y-e.y,s=this._pathRoot,a=this._panes.overlayPane;o.Browser.mobileWebkit&&a.removeChild(s),o.DomUtil.setPosition(s,e),s.setAttribute("width",i),s.setAttribute("height",r),s.setAttribute("viewBox",[e.x,e.y,i,r].join(" ")),o.Browser.mobileWebkit&&a.appendChild(s)}}}),o.Path.include({bindPopup:function(t,e){return t instanceof o.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new o.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),o.Browser.vml=!o.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var n=t.firstChild;return n.style.behavior="url(#default#VML)",n&&"object"==typeof n.adj}catch(i){return!1}}(),o.Path=o.Browser.svg||!o.Browser.vml?o.Path:o.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");o.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&o.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",i.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,n.dashArray?t.dashStyle=o.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):t.dashStyle="",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(i.removeChild(t),this._stroke=null),n.fill?(e||(e=this._fill=this._createElement("fill"),i.appendChild(e)),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(i.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),o.Map.include(o.Browser.svg||!o.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=e.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),o.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),o.Path=o.Path.SVG&&!t.L_PREFER_CANVAS||!o.Browser.canvas?o.Path:o.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return o.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!o.Path._updateRequest&&(o.Path._updateRequest=o.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){o.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,n,i,r,s;for(this._ctx.beginPath(),t=0,n=this._parts.length;n>t;t++){for(e=0,i=this._parts[t].length;i>e;e++)r=this._parts[t][e],s=(0===e?"move":"line")+"To",this._ctx[s](r.x,r.y);this instanceof o.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),o.Map.include(o.Path.SVG&&!t.L_PREFER_CANVAS||!o.Browser.canvas?{}:{_initPathRoot:function(){var t,n=this._pathRoot;n||(n=this._pathRoot=e.createElement("canvas"),n.style.position="absolute",t=this._canvasCtx=n.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(n),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max.subtract(e),i=this._pathRoot;o.DomUtil.setPosition(i,e),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-e.x,-e.y)}}}),o.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),t=this._simplifyDP(t,n)},pointToSegmentDistance:function(t,e,n){return Math.sqrt(this._sqClosestPointOnSegment(t,e,n,!0))},closestPointOnSegment:function(t,e,n){return this._sqClosestPointOnSegment(t,e,n)},_simplifyDP:function(t,e){var i=t.length,o=typeof Uint8Array!=n+""?Uint8Array:Array,r=new o(i);r[0]=r[i-1]=1,this._simplifyDPStep(t,r,e,0,i-1);var s,a=[];for(s=0;i>s;s++)r[s]&&a.push(t[s]);return a;
},_simplifyDPStep:function(t,e,n,i,o){var r,s,a,h=0;for(s=i+1;o-1>=s;s++)a=this._sqClosestPointOnSegment(t[s],t[i],t[o],!0),a>h&&(r=s,h=a);h>n&&(e[r]=1,this._simplifyDPStep(t,e,n,i,r),this._simplifyDPStep(t,e,n,r,o))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,o=0,r=t.length;r>i;i++)this._sqDist(t[i],t[o])>e&&(n.push(t[i]),o=i);return r-1>o&&n.push(t[r-1]),n},clipSegment:function(t,e,n,i){var o,r,s,a=i?this._lastCode:this._getBitCode(t,n),h=this._getBitCode(e,n);for(this._lastCode=h;;){if(!(a|h))return[t,e];if(a&h)return!1;o=a||h,r=this._getEdgeIntersection(t,e,o,n),s=this._getBitCode(r,n),o===a?(t=r,a=s):(e=r,h=s)}},_getEdgeIntersection:function(t,e,n,i){var r=e.x-t.x,s=e.y-t.y,a=i.min,h=i.max;return 8&n?new o.Point(t.x+r*(h.y-t.y)/s,h.y):4&n?new o.Point(t.x+r*(a.y-t.y)/s,a.y):2&n?new o.Point(h.x,t.y+s*(h.x-t.x)/r):1&n?new o.Point(a.x,t.y+s*(a.x-t.x)/r):void 0},_getBitCode:function(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_sqClosestPointOnSegment:function(t,e,n,i){var r,s=e.x,a=e.y,h=n.x-s,l=n.y-a,u=h*h+l*l;return u>0&&(r=((t.x-s)*h+(t.y-a)*l)/u,r>1?(s=n.x,a=n.y):r>0&&(s+=h*r,a+=l*r)),h=t.x-s,l=t.y-a,i?h*h+l*l:new o.Point(s,a)}},o.Polyline=o.Path.extend({initialize:function(t,e){o.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,n="";e>t;t++)n+=this._getPathPartStr(this._parts[t]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(o.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,n,i=1/0,r=this._parts,s=null,a=0,h=r.length;h>a;a++)for(var l=r[a],u=1,c=l.length;c>u;u++){e=l[u-1],n=l[u];var d=o.LineUtil._sqClosestPointOnSegment(t,e,n,!0);i>d&&(i=d,s=o.LineUtil._sqClosestPointOnSegment(t,e,n))}return s&&(s.distance=Math.sqrt(i)),s},getBounds:function(){return new o.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var n,i,r=e?t:[];for(n=0,i=t.length;i>n;n++){if(o.Util.isArray(t[n])&&"number"!=typeof t[n][0])return;r[n]=o.latLng(t[n])}return r},_initEvents:function(){o.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,n=o.Path.VML,i=0,r=t.length,s="";r>i;i++)e=t[i],n&&e._round(),s+=(i?"L":"M")+e.x+" "+e.y;return s},_clipPoints:function(){var t,e,n,i=this._originalPoints,r=i.length;if(this.options.noClip)return void(this._parts=[i]);this._parts=[];var s=this._parts,a=this._map._pathViewport,h=o.LineUtil;for(t=0,e=0;r-1>t;t++)n=h.clipSegment(i[t],i[t+1],a,t),n&&(s[e]=s[e]||[],s[e].push(n[0]),(n[1]!==i[t+1]||t===r-2)&&(s[e].push(n[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=o.LineUtil,n=0,i=t.length;i>n;n++)t[n]=e.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),o.Path.prototype._updatePath.call(this))}}),o.polyline=function(t,e){return new o.Polyline(t,e)},o.PolyUtil={},o.PolyUtil.clipPolygon=function(t,e){var n,i,r,s,a,h,l,u,c,d=[1,4,2,8],p=o.LineUtil;for(i=0,l=t.length;l>i;i++)t[i]._code=p._getBitCode(t[i],e);for(s=0;4>s;s++){for(u=d[s],n=[],i=0,l=t.length,r=l-1;l>i;r=i++)a=t[i],h=t[r],a._code&u?h._code&u||(c=p._getEdgeIntersection(h,a,u,e),c._code=p._getBitCode(c,e),n.push(c)):(h._code&u&&(c=p._getEdgeIntersection(h,a,u,e),c._code=p._getBitCode(c,e),n.push(c)),n.push(a));t=n}return t},o.Polygon=o.Polyline.extend({options:{fill:!0},initialize:function(t,e){o.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,n,i;if(t&&o.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,n=this._holes.length;n>e;e++)i=this._holes[e]=this._convertLatLngs(this._holes[e]),i[0].equals(i[i.length-1])&&i.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(o.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,n,i;for(t=0,n=this._holes.length;n>t;t++)for(this._holePoints[t]=[],e=0,i=this._holes[t].length;i>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&o.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):o.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;i>n;n++){var r=o.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);r.length&&e.push(r)}this._parts=e}},_getPathPartStr:function(t){var e=o.Polyline.prototype._getPathPartStr.call(this,t);return e+(o.Browser.svg?"z":"x")}}),o.polygon=function(t,e){return new o.Polygon(t,e)},function(){function t(t){return o.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var n=0,i=e.length;for(this.eachLayer(function(t){i>n?t.setLatLngs(e[n++]):this.removeLayer(t)},this);i>n;)this.addLayer(new t(e[n++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}o.MultiPolyline=t(o.Polyline),o.MultiPolygon=t(o.Polygon),o.multiPolyline=function(t,e){return new o.MultiPolyline(t,e)},o.multiPolygon=function(t,e){return new o.MultiPolygon(t,e)}}(),o.Rectangle=o.Polygon.extend({initialize:function(t,e){o.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=o.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),o.rectangle=function(t,e){return new o.Rectangle(t,e)},o.Circle=o.Path.extend({initialize:function(t,e,n){o.Path.prototype.initialize.call(this,n),this._latlng=o.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=o.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,n=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,n=this._latlng;return new o.LatLngBounds([n.lat-e,n.lng-t],[n.lat+e,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":o.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(o.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,n=this._point;return n.x-e>t.max.x||n.y-e>t.max.y||n.x+e<t.min.x||n.y+e<t.min.y}}),o.circle=function(t,e,n){return new o.Circle(t,e,n)},o.CircleMarker=o.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){o.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){o.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return o.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),o.circleMarker=function(t,e){return new o.CircleMarker(t,e)},o.Polyline.include(o.Path.CANVAS?{_containsPoint:function(t,e){var n,i,r,s,a,h,l,u=this.options.weight/2;for(o.Browser.touch&&(u+=10),n=0,s=this._parts.length;s>n;n++)for(l=this._parts[n],i=0,a=l.length,r=a-1;a>i;r=i++)if((e||0!==i)&&(h=o.LineUtil.pointToSegmentDistance(t,l[r],l[i]),u>=h))return!0;return!1}}:{}),o.Polygon.include(o.Path.CANVAS?{_containsPoint:function(t){var e,n,i,r,s,a,h,l,u=!1;if(o.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(r=0,h=this._parts.length;h>r;r++)for(e=this._parts[r],s=0,l=e.length,a=l-1;l>s;a=s++)n=e[s],i=e[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(u=!u);return u}}:{}),o.Circle.include(o.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,n=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+n}}:{}),o.CircleMarker.include(o.Path.CANVAS?{_updateStyle:function(){o.Path.prototype._updateStyle.call(this)}}:{}),o.GeoJSON=o.FeatureGroup.extend({initialize:function(t,e){o.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,r=o.Util.isArray(t)?t:t.features;if(r){for(e=0,n=r.length;n>e;e++)i=r[e],(i.geometries||i.geometry||i.features||i.coordinates)&&this.addData(r[e]);return this}var s=this.options;if(!s.filter||s.filter(t)){var a=o.GeoJSON.geometryToLayer(t,s.pointToLayer,s.coordsToLatLng,s);return a.feature=o.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),s.onEachFeature&&s.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(o.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),o.extend(o.GeoJSON,{geometryToLayer:function(t,e,n,i){var r,s,a,h,l="Feature"===t.type?t.geometry:t,u=l.coordinates,c=[];switch(n=n||this.coordsToLatLng,l.type){case"Point":return r=n(u),e?e(t,r):new o.Marker(r);case"MultiPoint":for(a=0,h=u.length;h>a;a++)r=n(u[a]),c.push(e?e(t,r):new o.Marker(r));return new o.FeatureGroup(c);case"LineString":return s=this.coordsToLatLngs(u,0,n),new o.Polyline(s,i);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return s=this.coordsToLatLngs(u,1,n),new o.Polygon(s,i);case"MultiLineString":return s=this.coordsToLatLngs(u,1,n),new o.MultiPolyline(s,i);case"MultiPolygon":return s=this.coordsToLatLngs(u,2,n),new o.MultiPolygon(s,i);case"GeometryCollection":for(a=0,h=l.geometries.length;h>a;a++)c.push(this.geometryToLayer({geometry:l.geometries[a],type:"Feature",properties:t.properties},e,n,i));return new o.FeatureGroup(c);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new o.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,n){var i,o,r,s=[];for(o=0,r=t.length;r>o;o++)i=e?this.coordsToLatLngs(t[o],e-1,n):(n||this.coordsToLatLng)(t[o]),s.push(i);return s},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==n&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push(o.GeoJSON.latLngToCoords(t[n]));return e},getFeature:function(t,e){return t.feature?o.extend({},t.feature,{geometry:e}):o.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var s={toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"Point",coordinates:o.GeoJSON.latLngToCoords(this.getLatLng())})}};o.Marker.include(s),o.Circle.include(s),o.CircleMarker.include(s),o.Polyline.include({toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"LineString",coordinates:o.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),o.Polygon.include({toGeoJSON:function(){var t,e,n,i=[o.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)n=o.GeoJSON.latLngsToCoords(this._holes[t]),n.push(n[0]),i.push(n);return o.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),o.GeoJSON.getFeature(this,{type:t,coordinates:e})}}o.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),o.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),o.LayerGroup.include({toGeoJSON:function(){var e,n=this.feature&&this.feature.geometry,i=[];if(n&&"MultiPoint"===n.type)return t("MultiPoint").call(this);var r=n&&"GeometryCollection"===n.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),i.push(r?e.geometry:o.GeoJSON.asFeature(e)))}),r?o.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),o.geoJson=function(t,e){return new o.GeoJSON(t,e)},o.DomEvent={addListener:function(t,e,n,i){var r,s,a,h=o.stamp(n),l="_leaflet_"+e+h;return t[l]?this:(r=function(e){return n.call(i||t,e||o.DomEvent._getEvent())},o.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,r,h):(o.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,r,h),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",r,!1),t.addEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?(s=r,a="mouseenter"===e?"mouseover":"mouseout",r=function(e){return o.DomEvent._checkMouse(t,e)?s(e):void 0},t.addEventListener(a,r,!1)):"click"===e&&o.Browser.android?(s=r,r=function(t){return o.DomEvent._filterClick(t,s)},t.addEventListener(e,r,!1)):t.addEventListener(e,r,!1):"attachEvent"in t&&t.attachEvent("on"+e,r),t[l]=r,this))},removeListener:function(t,e,n){var i=o.stamp(n),r="_leaflet_"+e+i,s=t[r];return s?(o.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,i):o.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,i):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):t.removeEventListener(e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[r]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,o.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=o.DomEvent.stopPropagation;return o.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=o.DomEvent.stopPropagation,n=o.Draggable.START.length-1;n>=0;n--)o.DomEvent.on(t,o.Draggable.START[n],e);return o.DomEvent.on(t,"click",o.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return o.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new o.Point(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new o.Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){o.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(i){return!1}return n!==t},_getEvent:function(){var e=t.event;if(!e)for(var n=arguments.callee.caller;n&&(e=n.arguments[0],!e||t.Event!==e.constructor);)n=n.caller;return e},_filterClick:function(t,e){var n=t.timeStamp||t.originalEvent.timeStamp,i=o.DomEvent._lastClick&&n-o.DomEvent._lastClick;return i&&i>100&&500>i||t.target._simulatedClick&&!t._simulated?void o.DomEvent.stop(t):(o.DomEvent._lastClick=n,e(t))}},o.DomEvent.on=o.DomEvent.addListener,o.DomEvent.off=o.DomEvent.removeListener,o.Draggable=o.Class.extend({includes:o.Mixin.Events,statics:{START:o.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=o.Draggable.START.length-1;t>=0;t--)o.DomEvent.on(this._dragStartTarget,o.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=o.Draggable.START.length-1;t>=0;t--)o.DomEvent.off(this._dragStartTarget,o.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(o.DomEvent.stopPropagation(t),!o.Draggable._disabled&&(o.DomUtil.disableImageDrag(),o.DomUtil.disableTextSelection(),!this._moving))){var n=t.touches?t.touches[0]:t;this._startPoint=new o.Point(n.clientX,n.clientY),this._startPos=this._newPos=o.DomUtil.getPosition(this._element),o.DomEvent.on(e,o.Draggable.MOVE[t.type],this._onMove,this).on(e,o.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var n=t.touches&&1===t.touches.length?t.touches[0]:t,i=new o.Point(n.clientX,n.clientY),r=i.subtract(this._startPoint);(r.x||r.y)&&(o.Browser.touch&&Math.abs(r.x)+Math.abs(r.y)<3||(o.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=o.DomUtil.getPosition(this._element).subtract(r),o.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,o.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,o.Util.cancelAnimFrame(this._animRequest),this._animRequest=o.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),o.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){o.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(o.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in o.Draggable.MOVE)o.DomEvent.off(e,o.Draggable.MOVE[t],this._onMove).off(e,o.Draggable.END[t],this._onUp);o.DomUtil.enableImageDrag(),o.DomUtil.enableTextSelection(),this._moved&&this._moving&&(o.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),o.Handler=o.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),o.Map.mergeOptions({dragging:!0,inertia:!o.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:o.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),o.Map.Drag=o.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new o.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,r=(i+e+n)%t-e-n,s=Math.abs(o+n)<Math.abs(r+n)?o:r;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,i=+new Date-this._lastTime,r=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),r)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+i-this._times[0])/1e3,h=n.easeLinearity,l=s.multiplyBy(h/a),u=l.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,u),d=l.multiplyBy(c/u),p=c/(n.inertiaDeceleration*h),f=d.multiplyBy(-p/2).round();f.x&&f.y?(f=e._limitOffset(f,e.options.maxBounds),o.Util.requestAnimFrame(function(){e.panBy(f,{duration:p,easeLinearity:h,noMoveStart:!0})})):e.fire("moveend")}}}),o.Map.addInitHook("addHandler","dragging",o.Map.Drag),o.Map.mergeOptions({doubleClickZoom:!0}),o.Map.DoubleClickZoom=o.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),o.Map.addInitHook("addHandler","doubleClickZoom",o.Map.DoubleClickZoom),o.Map.mergeOptions({scrollWheelZoom:!0}),o.Map.ScrollWheelZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),o.DomEvent.on(this._map._container,"MozMousePixelScroll",o.DomEvent.preventDefault),this._delta=0},removeHooks:function(){o.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),o.DomEvent.off(this._map._container,"MozMousePixelScroll",o.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=o.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o.bind(this._performZoom,this),n),o.DomEvent.preventDefault(t),o.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,n=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(n+e)-n,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(n+e):t.setZoomAround(this._lastMousePos,n+e))}}),o.Map.addInitHook("addHandler","scrollWheelZoom",o.Map.ScrollWheelZoom),o.extend(o.DomEvent,{_touchstart:o.Browser.msPointer?"MSPointerDown":o.Browser.pointer?"pointerdown":"touchstart",_touchend:o.Browser.msPointer?"MSPointerUp":o.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,n,i){function r(t){var e;if(o.Browser.pointer?(f.push(t.pointerId),e=f.length):e=t.touches.length,!(e>1)){var n=Date.now(),i=n-(a||n);h=t.touches?t.touches[0]:t,l=i>0&&u>=i,a=n}}function s(t){if(o.Browser.pointer){var e=f.indexOf(t.pointerId);if(-1===e)return;f.splice(e,1)}if(l){if(o.Browser.pointer){var i,r={};for(var s in h)i=h[s],"function"==typeof i?r[s]=i.bind(h):r[s]=i;h=r}h.type="dblclick",n(h),a=null}}var a,h,l=!1,u=250,c="_leaflet_",d=this._touchstart,p=this._touchend,f=[];t[c+d+i]=r,t[c+p+i]=s;var m=o.Browser.pointer?e.documentElement:t;return t.addEventListener(d,r,!1),m.addEventListener(p,s,!1),o.Browser.pointer&&m.addEventListener(o.DomEvent.POINTER_CANCEL,s,!1),this},removeDoubleTapListener:function(t,n){var i="_leaflet_";return t.removeEventListener(this._touchstart,t[i+this._touchstart+n],!1),(o.Browser.pointer?e.documentElement:t).removeEventListener(this._touchend,t[i+this._touchend+n],!1),o.Browser.pointer&&e.documentElement.removeEventListener(o.DomEvent.POINTER_CANCEL,t[i+this._touchend+n],!1),this}}),o.extend(o.DomEvent,{POINTER_DOWN:o.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:o.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:o.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:o.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,n,i){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,n,i);case"touchend":return this.addPointerListenerEnd(t,e,n,i);case"touchmove":return this.addPointerListenerMove(t,e,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,n,i,r){var s="_leaflet_",a=this._pointers,h=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&o.DomEvent.preventDefault(t);for(var e=!1,n=0;n<a.length;n++)if(a[n].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],i(t)};if(t[s+"touchstart"+r]=h,t.addEventListener(this.POINTER_DOWN,h,!1),!this._pointerDocumentListener){var l=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};e.documentElement.addEventListener(this.POINTER_UP,l,!1),e.documentElement.addEventListener(this.POINTER_CANCEL,l,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,n,i){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s[e]=t;break}t.touches=s.slice(),t.changedTouches=[t],n(t)}}var r="_leaflet_",s=this._pointers;return t[r+"touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,n,i){var o="_leaflet_",r=this._pointers,s=function(t){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r.splice(e,1);break}t.touches=r.slice(),t.changedTouches=[t],n(t)};return t[o+"touchend"+i]=s,t.addEventListener(this.POINTER_UP,s,!1),t.addEventListener(this.POINTER_CANCEL,s,!1),this},removePointerListener:function(t,e,n){var i="_leaflet_",o=t[i+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,o,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,o,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,o,!1),t.removeEventListener(this.POINTER_CANCEL,o,!1)}return this}}),o.Map.mergeOptions({touchZoom:o.Browser.touch&&!o.Browser.android23,bounceAtZoomLimits:!0}),o.Map.TouchZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var n=this._map;if(t.touches&&2===t.touches.length&&!n._animatingZoom&&!this._zooming){var i=n.mouseEventToLayerPoint(t.touches[0]),r=n.mouseEventToLayerPoint(t.touches[1]),s=n._getCenterLayerPoint();this._startCenter=i.add(r)._divideBy(2),this._startDist=i.distanceTo(r),this._moved=!1,this._zooming=!0,this._centerOffset=s.subtract(this._startCenter),n._panAnim&&n._panAnim.stop(),o.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),o.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(o.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),o.Util.cancelAnimFrame(this._animRequest),this._animRequest=o.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),o.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getScaleZoom(this._scale);t._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,o.DomUtil.removeClass(t._mapPane,"leaflet-touching"),o.Util.cancelAnimFrame(this._animRequest),o.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd);var n=this._getScaleOrigin(),i=t.layerPointToLatLng(n),r=t.getZoom(),s=t.getScaleZoom(this._scale)-r,a=s>0?Math.ceil(s):Math.floor(s),h=t._limitZoom(r+a),l=t.getZoomScale(h)/this._scale;t._animateZoom(i,h,n,l)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),o.Map.addInitHook("addHandler","touchZoom",o.Map.TouchZoom),o.Map.mergeOptions({tap:!0,tapTolerance:15}),o.Map.Tap=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(o.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var n=t.touches[0],i=n.target;this._startPos=this._newPos=new o.Point(n.clientX,n.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&o.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(o.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",n))},this),1e3),o.DomEvent.on(e,"touchmove",this._onMove,this).on(e,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),o.DomEvent.off(e,"touchmove",this._onMove,this).off(e,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var n=t.changedTouches[0],i=n.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&o.DomUtil.removeClass(i,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",n)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new o.Point(e.clientX,e.clientY)},_simulateEvent:function(n,i){var o=e.createEvent("MouseEvents");o._simulated=!0,i.target._simulatedClick=!0,o.initMouseEvent(n,!0,!0,t,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(o)}}),o.Browser.touch&&!o.Browser.pointer&&o.Map.addInitHook("addHandler","tap",o.Map.Tap),o.Map.mergeOptions({boxZoom:!0}),o.Map.BoxZoom=o.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){o.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){o.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(o.DomUtil.disableTextSelection(),o.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void o.DomEvent.on(e,"mousemove",this._onMouseMove,this).on(e,"mouseup",this._onMouseUp,this).on(e,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=o.DomUtil.create("div","leaflet-zoom-box",this._pane),o.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(t),r=i.subtract(e),s=new o.Point(Math.min(i.x,e.x),Math.min(i.y,e.y));o.DomUtil.setPosition(n,s),this._moved=!0,n.style.width=Math.max(0,Math.abs(r.x)-4)+"px",n.style.height=Math.max(0,Math.abs(r.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),
this._container.style.cursor=""),o.DomUtil.enableTextSelection(),o.DomUtil.enableImageDrag(),o.DomEvent.off(e,"mousemove",this._onMouseMove).off(e,"mouseup",this._onMouseUp).off(e,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,n=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(n)){var i=new o.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(n));e.fitBounds(i),e.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),o.Map.addInitHook("addHandler","boxZoom",o.Map.BoxZoom),o.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),o.Map.Keyboard=o.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),o.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;o.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var n=e.body,i=e.documentElement,o=n.scrollTop||i.scrollTop,r=n.scrollLeft||i.scrollLeft;this._map._container.focus(),t.scrollTo(r,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;n>e;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;n>e;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;n>e;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;n>e;e++)i[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;n>e;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;n>e;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){o.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){o.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[e]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(e in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[e])}o.DomEvent.stop(t)}}),o.Map.addInitHook("addHandler","keyboard",o.Map.Keyboard),o.Handler.MarkerDrag=o.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new o.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),o.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),o.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,n=o.DomUtil.getPosition(t._icon),i=t._map.layerPointToLatLng(n);e&&o.DomUtil.setPosition(e,n),t._latlng=i,t.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),o.Control=o.Class.extend({options:{position:"topright"},initialize:function(t){o.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return o.DomUtil.addClass(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),n=t._controlCorners[e];return n.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),o.control=function(t){return new o.Control(t)},o.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,r){var s=n+t+" "+n+r;e[t+r]=o.DomUtil.create("div",s,i)}var e=this._controlCorners={},n="leaflet-",i=this._controlContainer=o.DomUtil.create("div",n+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),o.Control.Zoom=o.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=o.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,n,i,r,s){var a=o.DomUtil.create("a",n,i);a.innerHTML=t,a.href="#",a.title=e;var h=o.DomEvent.stopPropagation;return o.DomEvent.on(a,"click",h).on(a,"mousedown",h).on(a,"dblclick",h).on(a,"click",o.DomEvent.preventDefault).on(a,"click",r,s).on(a,"click",this._refocusOnMap,s),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";o.DomUtil.removeClass(this._zoomInButton,e),o.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&o.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&o.DomUtil.addClass(this._zoomInButton,e)}}),o.Map.mergeOptions({zoomControl:!0}),o.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new o.Control.Zoom,this.addControl(this.zoomControl))}),o.control.zoom=function(t){return new o.Control.Zoom(t)},o.Control.Attribution=o.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){o.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=o.DomUtil.create("div","leaflet-control-attribution"),o.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),o.Map.mergeOptions({attributionControl:!0}),o.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new o.Control.Attribution).addTo(this))}),o.control.attribution=function(t){return new o.Control.Attribution(t)},o.Control.Scale=o.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",n=o.DomUtil.create("div",e),i=this.options;return this._addScales(i,e,n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=o.DomUtil.create("div",e+"-line",n)),t.imperial&&(this._iScale=o.DomUtil.create("div",e+"-line",n))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180),i=n*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize(),r=this.options,s=0;o.x>0&&(s=i*(r.maxWidth/o.x)),this._updateScales(r,s)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,n,i,o=3.2808399*t,r=this._iScale;o>5280?(e=o/5280,n=this._getRoundNum(e),r.style.width=this._getScaleWidth(n/e)+"px",r.innerHTML=n+" mi"):(i=this._getRoundNum(o),r.style.width=this._getScaleWidth(i/o)+"px",r.innerHTML=i+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}}),o.control.scale=function(t){return new o.Control.Scale(t)},o.Control.Layers=o.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,n){o.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var i in t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=o.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=o.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),o.Browser.touch?o.DomEvent.on(e,"click",o.DomEvent.stopPropagation):o.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var n=this._form=o.DomUtil.create("form",t+"-list");if(this.options.collapsed){o.Browser.android||o.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var i=this._layersLink=o.DomUtil.create("a",t+"-toggle",e);i.href="#",i.title="Layers",o.Browser.touch?o.DomEvent.on(i,"click",o.DomEvent.stop).on(i,"click",this._expand,this):o.DomEvent.on(i,"focus",this._expand,this),o.DomEvent.on(n,"click",function(){setTimeout(o.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=o.DomUtil.create("div",t+"-base",n),this._separator=o.DomUtil.create("div",t+"-separator",n),this._overlaysList=o.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_addLayer:function(t,e,n){var i=o.stamp(t);this._layers[i]={layer:t,name:e,overlay:n},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,n=!1,i=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),i=i||e.overlay,n=n||!e.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(t){var e=this._layers[o.stamp(t.layer)];if(e){this._handlingClick||this._update();var n=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)}},_createRadioElement:function(t,n){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';n&&(i+=' checked="checked"'),i+="/>";var o=e.createElement("div");return o.innerHTML=i,o.firstChild},_addItem:function(t){var n,i=e.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?(n=e.createElement("input"),n.type="checkbox",n.className="leaflet-control-layers-selector",n.defaultChecked=r):n=this._createRadioElement("leaflet-base-layers",r),n.layerId=o.stamp(t.layer),o.DomEvent.on(n,"click",this._onInputClick,this);var s=e.createElement("span");s.innerHTML=" "+t.name,i.appendChild(n),i.appendChild(s);var a=t.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(i),i},_onInputClick:function(){var t,e,n,i=this._form.getElementsByTagName("input"),o=i.length;for(this._handlingClick=!0,t=0;o>t;t++)e=i[t],n=this._layers[e.layerId],e.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!e.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){o.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),o.control.layers=function(t,e,n){return new o.Control.Layers(t,e,n)},o.PosAnimation=o.Class.extend({includes:o.Mixin.Events,run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[o.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",o.DomEvent.on(t,o.DomUtil.TRANSITION_END,this._onTransitionEnd,this),o.DomUtil.setPosition(t,e),o.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(o.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(o.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),o.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,n,i,r=this._el,s=t.getComputedStyle(r);if(o.Browser.any3d){if(i=s[o.DomUtil.TRANSFORM].match(this._transformRe),!i)return;e=parseFloat(i[1]),n=parseFloat(i[2])}else e=parseFloat(s.left),n=parseFloat(s.top);return new o.Point(e,n,!0)},_onTransitionEnd:function(){o.DomEvent.off(this._el,o.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[o.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),o.Map.include({setView:function(t,e,i){if(e=e===n?this._zoom:this._limitZoom(e),t=this._limitCenter(o.latLng(t),e,this.options.maxBounds),i=i||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==n&&(i.zoom=o.extend({animate:i.animate},i.zoom),i.pan=o.extend({animate:i.animate},i.pan));var r=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(r)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=o.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new o.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){o.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){o.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(n)?(this.panBy(n,e),!0):!1}}),o.PosAnimation=o.DomUtil.TRANSITION?o.PosAnimation:o.PosAnimation.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=o.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=o.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));o.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){o.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),o.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),o.DomUtil.TRANSITION&&o.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&o.DomUtil.TRANSITION&&o.Browser.any3d&&!o.Browser.android23&&!o.Browser.mobileOpera,this._zoomAnimated&&o.DomEvent.on(this._mapPane,o.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),o.Map.include(o.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i),r=this._getCenterLayerPoint()._add(o);return n.animate===!0||this.getSize().contains(o)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,r,i,null,!0),!0):!1},_animateZoom:function(t,e,n,i,r,s,a){a||(this._animatingZoom=!0),o.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,o.Draggable&&(o.Draggable._disabled=!0),o.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:n,scale:i,delta:r,backwards:s}),setTimeout(o.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,o.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),o.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),o.Draggable&&(o.Draggable._disabled=!1)},this))}}:{}),o.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,n=o.DomUtil.TRANSFORM,i=t.delta?o.DomUtil.getTranslateString(t.delta):e.style[n],r=o.DomUtil.getScaleString(t.scale,t.origin);e.style[n]=t.backwards?r+" "+i:i+" "+r},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),o.Util.falseFn(e.offsetWidth);var n=this._map.getZoom();(n>this.options.maxZoom||n<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[o.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,n=this._getLoadedTilesPercentage(e),i=this._getLoadedTilesPercentage(t);return e&&n>.5&&.5>i?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[o.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,n,i=t.getElementsByTagName("img"),o=0;for(e=0,n=i.length;n>e;e++)i[e].complete&&o++;return o/n},_stopLoadingImages:function(t){var e,n,i,r=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,n=r.length;n>e;e++)i=r[e],i.complete||(i.onload=o.Util.falseFn,i.onerror=o.Util.falseFn,i.src=o.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),o.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=o.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o.bind(this._handleGeolocationResponse,this),n=o.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,n=t.coords.longitude,i=new o.LatLng(e,n),r=180*t.coords.accuracy/40075017,s=r/Math.cos(o.LatLng.DEG_TO_RAD*e),a=o.latLngBounds([e-r,n-s],[e+r,n+s]),h=this._locateOptions;if(h.setView){var l=Math.min(this.getBoundsZoom(a),h.maxZoom);this.setView(i,l)}var u={latlng:i,bounds:a,timestamp:t.timestamp};for(var c in t.coords)"number"==typeof t.coords[c]&&(u[c]=t.coords[c]);this.fire("locationfound",u)}})}(window,document),function(t,e){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports&&(module.exports=t(require("leaflet"))),"undefined"!=typeof e&&e.L&&(e.L.Control.MiniMap=t(L),e.L.control.minimap=function(t,n){return new e.L.Control.MiniMap(t,n)})}(function(t){var e=t.Control.extend({options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"}},initialize:function(e,n){t.Util.setOptions(this,n),this.options.aimingRectOptions.clickable=!1,this.options.shadowRectOptions.clickable=!1,this._layer=e},onAdd:function(e){return this._mainMap=e,this._container=t.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",t.DomEvent.disableClickPropagation(this._container),t.DomEvent.on(this._container,"mousewheel",t.DomEvent.stopPropagation),this._miniMap=new t.Map(this._container,{attributionControl:!1,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:!this._isZoomLevelFixed(),scrollWheelZoom:!this._isZoomLevelFixed(),doubleClickZoom:!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:e.options.crs}),this._miniMap.addLayer(this._layer),this._mainMapMoving=!1,this._miniMapMoving=!1,this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._miniMap.whenReady(t.Util.bind(function(){this._aimingRect=t.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap),this._shadowRect=t.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._miniMap.on("movestart",this._onMiniMapMoveStarted,this),this._miniMap.on("move",this._onMiniMapMoving,this),this._miniMap.on("moveend",this._onMiniMapMoved,this)},this)),this._container},addTo:function(e){return t.Control.prototype.addTo.call(this,e),this._miniMap.setView(this._mainMap.getCenter(),this._decideZoom(!0)),this._setDisplay(this._decideMinimized()),this},onRemove:function(t){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._miniMap.off("moveend",this._onMiniMapMoved,this),this._miniMap.removeLayer(this._layer)},changeLayer:function(t){this._miniMap.removeLayer(this._layer),this._layer=t,this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._createButton("",this.options.strings.hideText,"leaflet-control-minimap-toggle-display leaflet-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_createButton:function(e,n,i,o,r,s){var a=t.DomUtil.create("a",i,o);a.innerHTML=e,a.href="#",a.title=n;var h=t.DomEvent.stopPropagation;return t.DomEvent.on(a,"click",h).on(a,"mousedown",h).on(a,"dblclick",h).on(a,"click",t.DomEvent.preventDefault).on(a,"click",r,s),a},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?(this._restore(),this._toggleDisplayButton.title=this.options.strings.hideText):(this._minimize(),this._toggleDisplayButton.title=this.options.strings.showText)},_setDisplay:function(t){t!=this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position):this._container.style.display="none",this._minimized=!0},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,"")):this._container.style.display="block",this._minimized=!1},_onMainMapMoved:function(t){this._miniMapMoving?this._miniMapMoving=!1:(this._mainMapMoving=!0,this._miniMap.setView(this._mainMap.getCenter(),this._decideZoom(!0)),this._setDisplay(this._decideMinimized())),this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(t){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(t){var e=this._aimingRect.getBounds(),n=this._miniMap.latLngToContainerPoint(e.getSouthWest()),i=this._miniMap.latLngToContainerPoint(e.getNorthEast());this._lastAimingRectPosition={sw:n,ne:i}},_onMiniMapMoving:function(e){!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new t.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onMiniMapMoved:function(t){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var t=this.options.zoomLevelFixed;return this._isDefined(t)&&this._isInteger(t)},_decideZoom:function(t){if(this._isZoomLevelFixed())return t?this.options.zoomLevelFixed:this._mainMap.getZoom();if(t)return this._mainMap.getZoom()+this.options.zoomLevelOffset;var e,n=this._miniMap.getZoom()-this._mainMap.getZoom(),i=this._miniMap.getZoom()-this.options.zoomLevelOffset;return n>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(e=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):e=this._mainMap.getZoom():e=i,this._lastMiniMapZoom=this._miniMap.getZoom(),e},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?this._mainMap.getBounds().contains(this._miniMap.getBounds())?!0:!1:this._minimized},_isInteger:function(t){return"number"==typeof t},_isDefined:function(t){return"undefined"!=typeof t}});return t.Map.mergeOptions({miniMapControl:!1}),t.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new e).addTo(this))}),e},window),function(t,e,n){"use strict";function i(t,e,n){var i,o=t.runtimeStyle&&t.runtimeStyle[e],r=t.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(n)&&/^-?\d/.test(n)&&(i=r.left,o&&(t.runtimeStyle.left=t.currentStyle.left),r.left="fontSize"===e?"1em":n||0,n=r.pixelLeft+"px",r.left=i,o&&(t.runtimeStyle.left=o)),/^(thin|medium|thick)$/i.test(n)?n:Math.round(parseFloat(n))+"px"}function o(t){return parseInt(t,10)}function r(t,e,o,r){if(t=(t||"").split(","),t=t[r||0]||t[0]||"auto",t=c.Util.trimText(t).split(" "),"backgroundSize"!==o||t[0]&&!t[0].match(/cover|contain|auto/)){if(t[0]=-1===t[0].indexOf("%")?i(e,o+"X",t[0]):t[0],t[1]===n){if("backgroundSize"===o)return t[1]="auto",t;t[1]=t[0]}t[1]=-1===t[1].indexOf("%")?i(e,o+"Y",t[1]):t[1]}else;return t}function s(t,e,n,i,o,r){var s,a,h,l,u=c.Util.getCSS(e,t,o);if(1===u.length&&(l=u[0],u=[],u[0]=l,u[1]=l),-1!==u[0].toString().indexOf("%"))h=parseFloat(u[0])/100,a=n.width*h,"backgroundSize"!==t&&(a-=(r||i).width*h);else if("backgroundSize"===t)if("auto"===u[0])a=i.width;else if(/contain|cover/.test(u[0])){var d=c.Util.resizeBounds(i.width,i.height,n.width,n.height,u[0]);a=d.width,s=d.height}else a=parseInt(u[0],10);else a=parseInt(u[0],10);return"auto"===u[1]?s=a/i.width*i.height:-1!==u[1].toString().indexOf("%")?(h=parseFloat(u[1])/100,s=n.height*h,"backgroundSize"!==t&&(s-=(r||i).height*h)):s=parseInt(u[1],10),[a,s]}function a(t,e){var n=[];return{storage:n,width:t,height:e,clip:function(){n.push({type:"function",name:"clip",arguments:arguments})},translate:function(){n.push({type:"function",name:"translate",arguments:arguments})},fill:function(){n.push({type:"function",name:"fill",arguments:arguments})},save:function(){n.push({type:"function",name:"save",arguments:arguments})},restore:function(){n.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){n.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){n.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var t=[];return n.push({type:"function",name:"drawShape",arguments:t}),{moveTo:function(){t.push({name:"moveTo",arguments:arguments})},lineTo:function(){t.push({name:"lineTo",arguments:arguments})},arcTo:function(){t.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){t.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){t.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){n.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){n.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(t,e){return n.push({type:"variable",name:t,arguments:e}),e}}}function h(t){return{zindex:t,children:[]}}var l,u,c={};c.Util={},c.Util.log=function(e){c.logging&&t.console&&t.console.log&&t.console.log(e)},c.Util.trimText=function(t){return function(e){return t?t.apply(e):((e||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),c.Util.asFloat=function(t){return parseFloat(t)},function(){var t=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,e=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;
c.Util.parseTextShadows=function(n){if(!n||"none"===n)return[];for(var i=n.match(t),o=[],r=0;i&&r<i.length;r++){var s=i[r].match(e);o.push({color:s[0],offsetX:s[1]?s[1].replace("px",""):0,offsetY:s[2]?s[2].replace("px",""):0,blur:s[3]?s[3].replace("px",""):0})}return o}}(),c.Util.parseBackgroundImage=function(t){var e,n,i,o,r,s,a,h,l=" \r\n	",u=[],c=0,d=0,p=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&h.push(n),"-"===e.substr(0,1)&&(o=e.indexOf("-",1)+1)>0&&(i=e.substr(0,o),e=e.substr(o)),u.push({prefix:i,method:e.toLowerCase(),value:r,args:h})),h=[],e=i=n=r=""};p();for(var f=0,m=t.length;m>f;f++)if(s=t[f],!(0===c&&l.indexOf(s)>-1)){switch(s){case'"':a?a===s&&(a=null):a=s;break;case"(":if(a)break;if(0===c){c=1,r+=s;continue}d++;break;case")":if(a)break;if(1===c){if(0===d){c=0,r+=s,p();continue}d--}break;case",":if(a)break;if(0===c){p();continue}if(1===c&&0===d&&!e.match(/^url$/i)){h.push(n),n="",r+=s;continue}}r+=s,0===c?e+=s:n+=s}return p(),u},c.Util.Bounds=function(t){var e,n={};return t.getBoundingClientRect&&(e=t.getBoundingClientRect(),n.top=Math.floor(e.top),n.bottom=Math.floor(e.bottom||e.top+e.height),n.left=Math.floor(e.left),n.width=Math.floor(t.offsetWidth),n.height=Math.floor(t.offsetHeight)),n},c.Util.OffsetBounds=function(t){var e=t.offsetParent?c.Util.OffsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},c.Util.getCSS=function(t,n,i){l!==t&&(u=e.defaultView.getComputedStyle(t,null));var s=u[n];if(/^background(Size|Position)$/.test(n))return r(s,t,n,i);if(/border(Top|Bottom)(Left|Right)Radius/.test(n)){var a=s.split(" ");return a.length<=1&&(a[1]=a[0]),a.map(o)}return s},c.Util.resizeBounds=function(t,e,n,i,o){var r,s,a=n/i,h=t/e;return o&&"auto"!==o?h>a^"contain"===o?(s=i,r=i*h):(r=n,s=n/h):(r=n,s=i),{width:r,height:s}},c.Util.BackgroundPosition=function(t,e,n,i,o){var r=s("backgroundPosition",t,e,n,i,o);return{left:r[0],top:r[1]}},c.Util.BackgroundSize=function(t,e,n,i){var o=s("backgroundSize",t,e,n,i);return{width:o[0],height:o[1]}},c.Util.Extend=function(t,e){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},c.Util.Children=function(t){var e;try{e=t.nodeName&&"IFRAME"===t.nodeName.toUpperCase()?t.contentDocument||t.contentWindow.document:function(t){var e=[];return null!==t&&!function(t,e){var i=t.length,o=0;if("number"==typeof e.length)for(var r=e.length;r>o;o++)t[i++]=e[o];else for(;e[o]!==n;)t[i++]=e[o++];return t.length=i,t}(e,t),e}(t.childNodes)}catch(i){c.Util.log("html2canvas.Util.Children failed with exception: "+i.message),e=[]}return e},c.Util.isTransparent=function(t){return"transparent"===t||"rgba(0, 0, 0, 0)"===t},c.Util.Font=function(){var t={};return function(e,i,o){if(t[e+"-"+i]!==n)return t[e+"-"+i];var r,s,a,h=o.createElement("div"),l=o.createElement("img"),u=o.createElement("span"),c="Hidden Text";return h.style.visibility="hidden",h.style.fontFamily=e,h.style.fontSize=i,h.style.margin=0,h.style.padding=0,o.body.appendChild(h),l.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",l.width=1,l.height=1,l.style.margin=0,l.style.padding=0,l.style.verticalAlign="baseline",u.style.fontFamily=e,u.style.fontSize=i,u.style.margin=0,u.style.padding=0,u.appendChild(o.createTextNode(c)),h.appendChild(u),h.appendChild(l),r=l.offsetTop-u.offsetTop+1,h.removeChild(u),h.appendChild(o.createTextNode(c)),h.style.lineHeight="normal",l.style.verticalAlign="super",s=l.offsetTop-h.offsetTop+1,a={baseline:r,lineWidth:1,middle:s},t[e+"-"+i]=a,o.body.removeChild(h),a}}(),function(){function t(t){return function(e){try{t.addColorStop(e.stop,e.color)}catch(i){n.log(["failed to add color stop: ",i,"; tried to add: ",e])}}}var n=c.Util,i={};c.Generate=i;var o=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];i.parseGradient=function(t,e){var n,i,r,s,a,h,l,u,c,d,p,f,m=o.length;for(i=0;m>i&&!(r=t.match(o[i]));i+=1);if(r)switch(r[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(n={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},a=r[2].match(/\w+/g))for(h=a.length,i=0;h>i;i+=1)switch(a[i]){case"top":n.y0=0,n.y1=e.height;break;case"right":n.x0=e.width,n.x1=0;break;case"bottom":n.y0=e.height,n.y1=0;break;case"left":n.x0=0,n.x1=e.width}if(null===n.x0&&null===n.x1&&(n.x0=n.x1=e.width/2),null===n.y0&&null===n.y1&&(n.y0=n.y1=e.height/2),a=r[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(h=a.length,l=1/Math.max(h-1,1),i=0;h>i;i+=1)u=a[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),u[2]?(s=parseFloat(u[2]),s/="%"===u[3]?100:e.width):s=i*l,n.colorStops.push({color:u[1],stop:s});break;case"-webkit-gradient":if(n={type:"radial"===r[2]?"circle":r[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},a=r[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),a&&(n.x0=a[1]*e.width/100,n.y0=a[2]*e.height/100,n.x1=a[3]*e.width/100,n.y1=a[4]*e.height/100),a=r[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(h=a.length,i=0;h>i;i+=1)u=a[i].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),s=parseFloat(u[2]),"from"===u[1]&&(s=0),"to"===u[1]&&(s=1),n.colorStops.push({color:u[3],stop:s});break;case"-moz-linear-gradient":if(n={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},a=r[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),a&&(n.x0=a[1]*e.width/100,n.y0=a[2]*e.height/100,n.x1=e.width-n.x0,n.y1=e.height-n.y0),a=r[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(h=a.length,l=1/Math.max(h-1,1),i=0;h>i;i+=1)u=a[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),u[2]?(s=parseFloat(u[2]),u[3]&&(s/=100)):s=i*l,n.colorStops.push({color:u[1],stop:s});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(n={type:"circle",x0:0,y0:0,x1:e.width,y1:e.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},a=r[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),a&&(n.cx=a[1]*e.width/100,n.cy=a[2]*e.height/100),a=r[3].match(/\w+/),u=r[4].match(/[a-z\-]*/),a&&u)switch(u[0]){case"farthest-corner":case"cover":case"":c=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),d=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),p=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),f=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.max(c,d,p,f);break;case"closest-corner":c=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),d=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),p=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),f=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.min(c,d,p,f);break;case"farthest-side":"circle"===a[0]?n.rx=n.ry=Math.max(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=a[0],n.rx=Math.max(n.cx,n.x1-n.cx),n.ry=Math.max(n.cy,n.y1-n.cy));break;case"closest-side":case"contain":"circle"===a[0]?n.rx=n.ry=Math.min(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=a[0],n.rx=Math.min(n.cx,n.x1-n.cx),n.ry=Math.min(n.cy,n.y1-n.cy))}if(a=r[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(h=a.length,l=1/Math.max(h-1,1),i=0;h>i;i+=1)u=a[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),u[2]?(s=parseFloat(u[2]),s/="%"===u[3]?100:e.width):s=i*l,n.colorStops.push({color:u[1],stop:s})}return n},i.Gradient=function(n,i){if(0!==i.width&&0!==i.height){var o,r,s=e.createElement("canvas"),a=s.getContext("2d");if(s.width=i.width,s.height=i.height,o=c.Generate.parseGradient(n,i))switch(o.type){case"linear":r=a.createLinearGradient(o.x0,o.y0,o.x1,o.y1),o.colorStops.forEach(t(r)),a.fillStyle=r,a.fillRect(0,0,i.width,i.height);break;case"circle":r=a.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.rx),o.colorStops.forEach(t(r)),a.fillStyle=r,a.fillRect(0,0,i.width,i.height);break;case"ellipse":var h=e.createElement("canvas"),l=h.getContext("2d"),u=Math.max(o.rx,o.ry),d=2*u;h.width=h.height=d,r=l.createRadialGradient(o.rx,o.ry,0,o.rx,o.ry,u),o.colorStops.forEach(t(r)),l.fillStyle=r,l.fillRect(0,0,d,d),a.fillStyle=o.colorStops[o.colorStops.length-1].color,a.fillRect(0,0,s.width,s.height),a.drawImage(h,o.cx-o.rx,o.cy-o.ry,2*o.rx,2*o.ry)}return s}},i.ListAlpha=function(t){var e,n="";do e=t%26,n=String.fromCharCode(e+64)+n,t/=26;while(26*t>26);return n},i.ListRoman=function(t){var e,n=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],i=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],o="",r=n.length;if(0>=t||t>=4e3)return t;for(e=0;r>e;e+=1)for(;t>=i[e];)t-=i[e],o+=n[e];return o}}(),c.Parse=function(i,o){function r(){return Math.max(Math.max(ut.body.scrollWidth,ut.documentElement.scrollWidth),Math.max(ut.body.offsetWidth,ut.documentElement.offsetWidth),Math.max(ut.body.clientWidth,ut.documentElement.clientWidth))}function s(){return Math.max(Math.max(ut.body.scrollHeight,ut.documentElement.scrollHeight),Math.max(ut.body.offsetHeight,ut.documentElement.offsetHeight),Math.max(ut.body.clientHeight,ut.documentElement.clientHeight))}function l(t,e){var n=parseInt(mt(t,e),10);return isNaN(n)?0:n}function u(t,e,n,i,o,r){"transparent"!==r&&(t.setVariable("fillStyle",r),t.fillRect(e,n,i,o),lt+=1)}function d(t,e,n){return t.length>0?e+n.toUpperCase():void 0}function p(t,e){switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,d);case"uppercase":return t.toUpperCase();default:return t}}function f(t){return/^(normal|none|0px)$/.test(t)}function m(t,e,n,i){null!==t&&ct.trimText(t).length>0&&(i.fillText(t,e,n),lt+=1)}function g(t,e,n,i){var o=!1,r=mt(e,"fontWeight"),s=mt(e,"fontFamily"),a=mt(e,"fontSize"),h=ct.parseTextShadows(mt(e,"textShadow"));switch(parseInt(r,10)){case 401:r="bold";break;case 400:r="normal"}return t.setVariable("fillStyle",i),t.setVariable("font",[mt(e,"fontStyle"),mt(e,"fontVariant"),r,a,s].join(" ")),t.setVariable("textAlign",o?"right":"left"),h.length&&(t.setVariable("shadowColor",h[0].color),t.setVariable("shadowOffsetX",h[0].offsetX),t.setVariable("shadowOffsetY",h[0].offsetY),t.setVariable("shadowBlur",h[0].blur)),"none"!==n?ct.Font(s,a,ut):void 0}function v(t,e,n,i,o){switch(e){case"underline":u(t,n.left,Math.round(n.top+i.baseline+i.lineWidth),n.width,1,o);break;case"overline":u(t,n.left,Math.round(n.top),n.width,1,o);break;case"line-through":u(t,n.left,Math.ceil(n.top+i.middle+i.lineWidth),n.width,1,o)}}function _(t,e,n,i,o){var r;if(dt.rangeBounds&&!o)("none"!==n||0!==ct.trimText(e).length)&&(r=y(e,t.node,t.textOffset)),t.textOffset+=e.length;else if(t.node&&"string"==typeof t.node.nodeValue){var s=i?t.node.splitText(e.length):null;r=w(t.node,o),t.node=s}return r}function y(t,e,n){var i=ut.createRange();return i.setStart(e,n),i.setEnd(e,n+t.length),i.getBoundingClientRect()}function w(t,e){var n=t.parentNode,i=ut.createElement("wrapper"),o=t.cloneNode(!0);i.appendChild(t.cloneNode(!0)),n.replaceChild(i,t);var r=e?ct.OffsetBounds(i):ct.Bounds(i);return n.replaceChild(o,i),r}function b(t,e,n){var i,r,s=n.ctx,a=mt(t,"color"),h=mt(t,"textDecoration"),l=mt(t,"textAlign"),u={node:e,textOffset:0};ct.trimText(e.nodeValue).length>0&&(e.nodeValue=p(e.nodeValue,mt(t,"textTransform")),l=l.replace(["-webkit-auto"],["auto"]),r=!o.letterRendering&&/^(left|right|justify|auto)$/.test(l)&&f(mt(t,"letterSpacing"))?e.nodeValue.split(/(\b| )/):e.nodeValue.split(""),i=g(s,t,h,a),o.chinese&&r.forEach(function(t,e){/.*[\u4E00-\u9FA5].*$/.test(t)&&(t=t.split(""),t.unshift(e,1),r.splice.apply(r,t))}),r.forEach(function(t,e){var o=_(u,t,h,e<r.length-1,n.transform.matrix);o&&(m(t,o.left,o.bottom,s),v(s,h,o,i,a))}))}function x(t,e){var n,i,o=ut.createElement("boundelement");return o.style.display="inline",n=t.style.listStyleType,t.style.listStyleType="none",o.appendChild(ut.createTextNode(e)),t.insertBefore(o,t.firstChild),i=ct.Bounds(o),t.removeChild(o),t.style.listStyleType=n,i}function L(t){var e=-1,n=1,i=t.parentNode.childNodes;if(t.parentNode){for(;i[++e]!==t;)1===i[e].nodeType&&n++;return n}return-1}function P(t,e){var n,i=L(t);switch(e){case"decimal":n=i;break;case"decimal-leading-zero":n=1===i.toString().length?i="0"+i.toString():i.toString();break;case"upper-roman":n=c.Generate.ListRoman(i);break;case"lower-roman":n=c.Generate.ListRoman(i).toLowerCase();break;case"lower-alpha":n=c.Generate.ListAlpha(i).toLowerCase();break;case"upper-alpha":n=c.Generate.ListAlpha(i)}return n+". "}function E(t,e,n){var i,o,r,s=e.ctx,a=mt(t,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(a)){if(o=P(t,a),r=x(t,o),g(s,t,"none",mt(t,"color")),"inside"!==mt(t,"listStylePosition"))return;s.setVariable("textAlign","left"),i=n.left,m(o,i,r.bottom,s)}}function k(t){var e=i[t];return e&&e.succeeded===!0?e.img:!1}function C(t,e){var n=Math.max(t.left,e.left),i=Math.max(t.top,e.top),o=Math.min(t.left+t.width,e.left+e.width),r=Math.min(t.top+t.height,e.top+e.height);return{left:n,top:i,width:o-n,height:r-i}}function T(t,e,n){var i,o="static"!==e.cssPosition,r=o?mt(t,"zIndex"):"auto",s=mt(t,"opacity"),a="none"!==mt(t,"cssFloat");e.zIndex=i=h(r),i.isPositioned=o,i.isFloated=a,i.opacity=s,i.ownStacking="auto"!==r||1>s,n&&n.zIndex.children.push(e)}function M(t,e,n,i,o){var r=l(e,"paddingLeft"),s=l(e,"paddingTop"),a=l(e,"paddingRight"),h=l(e,"paddingBottom");j(t,n,0,0,n.width,n.height,i.left+r+o[3].width,i.top+s+o[0].width,i.width-(o[1].width+o[3].width+r+a),i.height-(o[0].width+o[2].width+s+h))}function S(t){return["Top","Right","Bottom","Left"].map(function(e){return{width:l(t,"border"+e+"Width"),color:mt(t,"border"+e+"Color")}})}function A(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){return mt(t,"border"+e+"Radius")})}function D(t,e,n,i){var o=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:t,startControl:e,endControl:n,end:i,subdivide:function(r){var s=o(t,e,r),a=o(e,n,r),h=o(n,i,r),l=o(s,a,r),u=o(a,h,r),c=o(l,u,r);return[D(t,s,l,c),D(c,u,h,i)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,n.x,n.y,i.x,i.y])},curveToReversed:function(i){i.push(["bezierCurve",n.x,n.y,e.x,e.y,t.x,t.y])}}}function O(t,e,n,i,o,r,s){e[0]>0||e[1]>0?(t.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(t),i[1].curveTo(t)):t.push(["line",r,s]),(n[0]>0||n[1]>0)&&t.push(["line",o[0].start.x,o[0].start.y])}function R(t,e,n,i,o,r,s){var a=[];return e[0]>0||e[1]>0?(a.push(["line",i[1].start.x,i[1].start.y]),i[1].curveTo(a)):a.push(["line",t.c1[0],t.c1[1]]),n[0]>0||n[1]>0?(a.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(a),a.push(["line",s[0].end.x,s[0].end.y]),s[0].curveToReversed(a)):(a.push(["line",t.c2[0],t.c2[1]]),a.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(a.push(["line",o[1].end.x,o[1].end.y]),o[1].curveToReversed(a)):a.push(["line",t.c4[0],t.c4[1]]),a}function I(t,e,n){var i=t.left,o=t.top,r=t.width,s=t.height,a=e[0][0],h=e[0][1],l=e[1][0],u=e[1][1],c=e[2][0],d=e[2][1],p=e[3][0],f=e[3][1],m=r-l,g=s-d,v=r-c,_=s-f;return{topLeftOuter:_t(i,o,a,h).topLeft.subdivide(.5),topLeftInner:_t(i+n[3].width,o+n[0].width,Math.max(0,a-n[3].width),Math.max(0,h-n[0].width)).topLeft.subdivide(.5),topRightOuter:_t(i+m,o,l,u).topRight.subdivide(.5),topRightInner:_t(i+Math.min(m,r+n[3].width),o+n[0].width,m>r+n[3].width?0:l-n[3].width,u-n[0].width).topRight.subdivide(.5),bottomRightOuter:_t(i+v,o+g,c,d).bottomRight.subdivide(.5),bottomRightInner:_t(i+Math.min(v,r+n[3].width),o+Math.min(g,s+n[0].width),Math.max(0,c-n[1].width),Math.max(0,d-n[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:_t(i,o+_,p,f).bottomLeft.subdivide(.5),bottomLeftInner:_t(i+n[3].width,o+_,Math.max(0,p-n[3].width),Math.max(0,f-n[2].width)).bottomLeft.subdivide(.5)}}function B(t,e,n,i,o){var r=mt(t,"backgroundClip"),s=[];switch(r){case"content-box":case"padding-box":O(s,i[0],i[1],e.topLeftInner,e.topRightInner,o.left+n[3].width,o.top+n[0].width),O(s,i[1],i[2],e.topRightInner,e.bottomRightInner,o.left+o.width-n[1].width,o.top+n[0].width),O(s,i[2],i[3],e.bottomRightInner,e.bottomLeftInner,o.left+o.width-n[1].width,o.top+o.height-n[2].width),O(s,i[3],i[0],e.bottomLeftInner,e.topLeftInner,o.left+n[3].width,o.top+o.height-n[2].width);break;default:O(s,i[0],i[1],e.topLeftOuter,e.topRightOuter,o.left,o.top),O(s,i[1],i[2],e.topRightOuter,e.bottomRightOuter,o.left+o.width,o.top),O(s,i[2],i[3],e.bottomRightOuter,e.bottomLeftOuter,o.left+o.width,o.top+o.height),O(s,i[3],i[0],e.bottomLeftOuter,e.topLeftOuter,o.left,o.top+o.height)}return s}function z(t,e,n){var i,o,r,s,a,h,l=e.left,u=e.top,c=e.width,d=e.height,p=A(t),f=I(e,p,n),m={clip:B(t,f,n,p,e),borders:[]};for(i=0;4>i;i++)if(n[i].width>0){switch(o=l,r=u,s=c,a=d-n[2].width,i){case 0:a=n[0].width,h=R({c1:[o,r],c2:[o+s,r],c3:[o+s-n[1].width,r+a],c4:[o+n[3].width,r+a]},p[0],p[1],f.topLeftOuter,f.topLeftInner,f.topRightOuter,f.topRightInner);break;case 1:o=l+c-n[1].width,s=n[1].width,h=R({c1:[o+s,r],c2:[o+s,r+a+n[2].width],c3:[o,r+a],c4:[o,r+n[0].width]},p[1],p[2],f.topRightOuter,f.topRightInner,f.bottomRightOuter,f.bottomRightInner);break;case 2:r=r+d-n[2].width,a=n[2].width,h=R({c1:[o+s,r+a],c2:[o,r+a],c3:[o+n[3].width,r],c4:[o+s-n[3].width,r]},p[2],p[3],f.bottomRightOuter,f.bottomRightInner,f.bottomLeftOuter,f.bottomLeftInner);break;case 3:s=n[3].width,h=R({c1:[o,r+a+n[2].width],c2:[o,r],c3:[o+s,r+n[0].width],c4:[o+s,r+a]},p[3],p[0],f.bottomLeftOuter,f.bottomLeftInner,f.topLeftOuter,f.topLeftInner)}m.borders.push({args:h,color:n[i].color})}return m}function U(t,e){var n=t.drawShape();return e.forEach(function(t,e){n[0===e?"moveTo":t[0]+"To"].apply(null,t.slice(1))}),n}function N(t,e,n){"transparent"!==n&&(t.setVariable("fillStyle",n),U(t,e),t.fill(),lt+=1)}function F(t,e,n){var i,o,r=ut.createElement("valuewrap"),s=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];s.forEach(function(e){try{r.style[e]=mt(t,e)}catch(n){ct.log("html2canvas: Parse: Exception caught in renderFormValue: "+n.message)}}),r.style.borderColor="black",r.style.borderStyle="solid",r.style.display="block",r.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(t.type)||"SELECT"===t.nodeName)&&(r.style.lineHeight=mt(t,"height")),r.style.top=e.top+"px",r.style.left=e.left+"px",i="SELECT"===t.nodeName?(t.options[t.selectedIndex]||0).text:t.value,i||(i=t.placeholder),o=ut.createTextNode(i),r.appendChild(o),ft.appendChild(r),b(t,o,n),ft.removeChild(r)}function j(t){t.drawImage.apply(t,Array.prototype.slice.call(arguments,1)),lt+=1}function Z(n,i){var o=t.getComputedStyle(n,i);if(o&&o.content&&"none"!==o.content&&"-moz-alt-content"!==o.content&&"none"!==o.display){var r=o.content+"",s=r.substr(0,1);s===r.substr(r.length-1)&&s.match(/'|"/)&&(r=r.substr(1,r.length-2));var a="url"===r.substr(0,3),h=e.createElement(a?"img":"span");return h.className=gt+"-before "+gt+"-after",Object.keys(o).filter(W).forEach(function(t){try{h.style[t]=o[t]}catch(e){ct.log(["Tried to assign readonly property ",t,"Error:",e])}}),a?h.src=ct.parseBackgroundImage(r)[0].args[0]:h.innerHTML=r,h}}function W(e){return isNaN(t.parseInt(e,10))}function V(t,e){var n=Z(t,":before"),i=Z(t,":after");(n||i)&&(n&&(t.className+=" "+gt+"-before",t.parentNode.insertBefore(n,t),rt(n,e,!0),t.parentNode.removeChild(n),t.className=t.className.replace(gt+"-before","").trim()),i&&(t.className+=" "+gt+"-after",t.appendChild(i),rt(i,e,!0),t.removeChild(i),t.className=t.className.replace(gt+"-after","").trim()))}function H(t,e,n,i){var o=Math.round(i.left+n.left),r=Math.round(i.top+n.top);t.createPattern(e),t.translate(o,r),t.fill(),t.translate(-o,-r)}function G(t,e,n,i,o,r,s,a){var h=[];h.push(["line",Math.round(o),Math.round(r)]),h.push(["line",Math.round(o+s),Math.round(r)]),h.push(["line",Math.round(o+s),Math.round(a+r)]),h.push(["line",Math.round(o),Math.round(a+r)]),U(t,h),t.save(),t.clip(),H(t,e,n,i),t.restore()}function q(t,e,n){u(t,e.left,e.top,e.width,e.height,n)}function $(t,e,n,i,o){var r=ct.BackgroundSize(t,e,i,o),s=ct.BackgroundPosition(t,e,i,o,r),a=mt(t,"backgroundRepeat").split(",").map(ct.trimText);switch(i=J(i,r),a=a[o]||a[0]){case"repeat-x":G(n,i,s,e,e.left,e.top+s.top,99999,i.height);break;case"repeat-y":G(n,i,s,e,e.left+s.left,e.top,i.width,99999);break;case"no-repeat":G(n,i,s,e,e.left+s.left,e.top+s.top,i.width,i.height);break;default:H(n,i,s,{top:e.top,left:e.left,width:i.width,height:i.height})}}function K(t,e,n){for(var i,o=mt(t,"backgroundImage"),r=ct.parseBackgroundImage(o),s=r.length;s--;)if(o=r[s],o.args&&0!==o.args.length){var a="url"===o.method?o.args[0]:o.value;i=k(a),i?$(t,e,n,i,s):ct.log("html2canvas: Error loading background:",o)}}function J(t,e){if(t.width===e.width&&t.height===e.height)return t;var n,i=ut.createElement("canvas");return i.width=e.width,i.height=e.height,n=i.getContext("2d"),j(n,t,0,0,t.width,t.height,0,0,e.width,e.height),i}function Y(t,e,n){return t.setVariable("globalAlpha",mt(e,"opacity")*(n?n.opacity:1))}function Q(t){return t.replace("px","")}function X(t,e){var n=mt(t,"transform")||mt(t,"-webkit-transform")||mt(t,"-moz-transform")||mt(t,"-ms-transform")||mt(t,"-o-transform"),i=mt(t,"transform-origin")||mt(t,"-webkit-transform-origin")||mt(t,"-moz-transform-origin")||mt(t,"-ms-transform-origin")||mt(t,"-o-transform-origin")||"0px 0px";i=i.split(" ").map(Q).map(ct.asFloat);var o;if(n&&"none"!==n){var r=n.match(yt);if(r)switch(r[1]){case"matrix":o=r[2].split(",").map(ct.trimText).map(ct.asFloat)}}return{origin:i,matrix:o}}function tt(t,e,n,i){var h=a(e?n.width:r(),e?n.height:s()),l={ctx:h,opacity:Y(h,t,e),cssPosition:mt(t,"position"),borders:S(t),transform:i,clip:e&&e.clip?ct.Extend({},e.clip):null};return T(t,l,e),o.useOverflow===!0&&/(hidden|scroll|auto)/.test(mt(t,"overflow"))===!0&&/(BODY)/i.test(t.nodeName)===!1&&(l.clip=l.clip?C(l.clip,n):n),l}function et(t,e,n){var i={left:e.left+t[3].width,top:e.top+t[0].width,width:e.width-(t[1].width+t[3].width),height:e.height-(t[0].width+t[2].width)};return n&&(i=C(i,n)),i}function nt(t,e){var n=e.matrix?ct.OffsetBounds(t):ct.Bounds(t);return e.origin[0]+=n.left,e.origin[1]+=n.top,n}function it(t,e,n,i){var o,r=X(t,e),s=nt(t,r),a=tt(t,e,s,r),h=a.borders,l=a.ctx,u=et(h,s,a.clip),c=z(t,s,h),d=pt.test(t.nodeName)?"#efefef":mt(t,"backgroundColor");switch(U(l,c.clip),l.save(),l.clip(),u.height>0&&u.width>0&&!i?(q(l,s,d),K(t,u,l)):i&&(a.backgroundColor=d),l.restore(),c.borders.forEach(function(t){N(l,t.args,t.color)}),n||V(t,a),t.nodeName){case"IMG":(o=k(t.getAttribute("src")))?M(l,t,o,s,h):ct.log("html2canvas: Error loading <img>:"+t.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(t.type)&&(t.value||t.placeholder||"").length>0&&F(t,s,a);break;case"TEXTAREA":(t.value||t.placeholder||"").length>0&&F(t,s,a);break;case"SELECT":(t.options||t.placeholder||"").length>0&&F(t,s,a);break;case"LI":E(t,a,u);break;case"CANVAS":M(l,t,t,s,h)}return a}function ot(t){return"none"!==mt(t,"display")&&"hidden"!==mt(t,"visibility")&&!t.hasAttribute("data-html2canvas-ignore")}function rt(t,e,n){ot(t)&&(e=it(t,e,n,!1)||e,pt.test(t.nodeName)||st(t,e,n))}function st(t,e,n){ct.Children(t).forEach(function(i){i.nodeType===i.ELEMENT_NODE?rt(i,e,n):i.nodeType===i.TEXT_NODE&&b(t,i,e)})}function at(){var t=mt(e.documentElement,"backgroundColor"),n=ct.isTransparent(t)&&ht===e.body,i=it(ht,null,!1,n);return st(ht,i),n&&(t=i.backgroundColor),ft.removeChild(vt),{backgroundColor:t,stack:i}}t.scroll(0,0);var ht=o.elements===n?e.body:o.elements[0],lt=0,ut=ht.ownerDocument,ct=c.Util,dt=ct.Support(o,ut),pt=new RegExp("("+o.ignoreElements+")"),ft=ut.body,mt=ct.getCSS,gt="___html2canvas___pseudoelement",vt=ut.createElement("style");vt.innerHTML="."+gt+'-before:before { content: "" !important; display: none !important; }.'+gt+'-after:after { content: "" !important; display: none !important; }',ft.appendChild(vt),i=i||{};var _t=function(t){return function(e,n,i,o){var r=i*t,s=o*t,a=e+i,h=n+o;return{topLeft:D({x:e,y:h},{x:e,y:h-s},{x:a-r,y:n},{x:a,y:n}),topRight:D({x:e,y:n},{x:e+r,y:n},{x:a,y:h-s},{x:a,y:h}),bottomRight:D({x:a,y:n},{x:a,y:n+s},{x:e+r,y:h},{x:e,y:h}),bottomLeft:D({x:a,y:h},{x:a-r,y:h},{x:e,y:n+s},{x:e,y:n})}}}(4*((Math.sqrt(2)-1)/3)),yt=/(matrix)\((.+)\)/;return at()},c.Preload=function(i){function o(t){k.href=t,k.href=k.href;var e=k.protocol+k.host;return e===m}function r(){w.log("html2canvas: start: images: "+y.numLoaded+" / "+y.numTotal+" (failed: "+y.numFailed+")"),!y.firstRun&&y.numLoaded>=y.numTotal&&(w.log("Finished loading images: # "+y.numTotal+" (failed: "+y.numFailed+")"),"function"==typeof i.complete&&i.complete(y))}function s(e,o,s){var a,h,l=i.proxy;k.href=e,e=k.href,a="html2canvas_"+b++,s.callbackname=a,l+=l.indexOf("?")>-1?"&":"?",l+="url="+encodeURIComponent(e)+"&callback="+a,h=L.createElement("script"),t[a]=function(e){"error:"===e.substring(0,6)?(s.succeeded=!1,y.numLoaded++,y.numFailed++,r()):(f(o,s),o.src=e),t[a]=n;try{delete t[a]}catch(i){}h.parentNode.removeChild(h),h=null,delete s.script,delete s.callbackname},h.setAttribute("type","text/javascript"),h.setAttribute("src",l),s.script=h,t.document.body.appendChild(h)}function a(e,n){var i=t.getComputedStyle(e,n),o=i.content;"url"===o.substr(0,3)&&g.loadImage(c.Util.parseBackgroundImage(o)[0].args[0]),d(i.backgroundImage,e)}function h(t){a(t,":before"),a(t,":after")}function l(t,e){var i=c.Generate.Gradient(t,e);i!==n&&(y[t]={img:i,succeeded:!0},y.numTotal++,y.numLoaded++,r())}function u(t){return t&&t.method&&t.args&&t.args.length>0}function d(t,e){var i;c.Util.parseBackgroundImage(t).filter(u).forEach(function(t){"url"===t.method?g.loadImage(t.args[0]):t.method.match(/\-?gradient$/)&&(i===n&&(i=c.Util.Bounds(e)),l(t.value,i))})}function p(t){var e=!1;try{w.Children(t).forEach(p)}catch(i){}try{e=t.nodeType}catch(o){e=!1,w.log("html2canvas: failed to access some element's nodeType - Exception: "+o.message)}if(1===e||e===n){h(t);try{d(w.getCSS(t,"backgroundImage"),t)}catch(i){w.log("html2canvas: failed to get background-image - Exception: "+i.message)}d(t)}}function f(e,o){e.onload=function(){o.timer!==n&&t.clearTimeout(o.timer),y.numLoaded++,o.succeeded=!0,e.onerror=e.onload=null,r()},e.onerror=function(){if("anonymous"===e.crossOrigin&&(t.clearTimeout(o.timer),i.proxy)){var n=e.src;return e=new Image,o.img=e,e.src=n,void s(e.src,e,o)}y.numLoaded++,y.numFailed++,o.succeeded=!1,e.onerror=e.onload=null,r()}}var m,g,v,_,y={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},w=c.Util,b=0,x=i.elements[0]||e.body,L=x.ownerDocument,P=x.getElementsByTagName("img"),E=P.length,k=L.createElement("a"),C=function(t){return t.crossOrigin!==n}(new Image);for(k.href=t.location.href,m=k.protocol+k.host,g={loadImage:function(t){var e,r;t&&y[t]===n&&(e=new Image,t.match(/data:image\/.*;base64,/i)?(e.src=t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),r=y[t]={img:e},y.numTotal++,f(e,r)):o(t)||i.allowTaint===!0?(r=y[t]={img:e},y.numTotal++,f(e,r),e.src=t):C&&!i.allowTaint&&i.useCORS?(e.crossOrigin="anonymous",r=y[t]={img:e},y.numTotal++,f(e,r),e.src=t):i.proxy&&(r=y[t]={img:e},y.numTotal++,s(t,e,r)))},cleanupDOM:function(o){var s,a;if(!y.cleanupDone){o&&"string"==typeof o?w.log("html2canvas: Cleanup because: "+o):w.log("html2canvas: Cleanup after timeout: "+i.timeout+" ms.");for(a in y)if(y.hasOwnProperty(a)&&(s=y[a],"object"==typeof s&&s.callbackname&&s.succeeded===n)){t[s.callbackname]=n;try{delete t[s.callbackname]}catch(h){}s.script&&s.script.parentNode&&(s.script.setAttribute("src","about:blank"),s.script.parentNode.removeChild(s.script)),y.numLoaded++,y.numFailed++,w.log("html2canvas: Cleaned up failed img: '"+a+"' Steps: "+y.numLoaded+" / "+y.numTotal)}t.stop!==n?t.stop():e.execCommand!==n&&e.execCommand("Stop",!1),e.close!==n&&e.close(),y.cleanupDone=!0,o&&"string"==typeof o||r()}},renderingDone:function(){_&&t.clearTimeout(_)}},i.timeout>0&&(_=t.setTimeout(g.cleanupDOM,i.timeout)),w.log("html2canvas: Preload starts: finding background-images"),y.firstRun=!0,p(x),w.log("html2canvas: Preload: Finding images"),v=0;E>v;v+=1)g.loadImage(P[v].getAttribute("src"));return y.firstRun=!1,w.log("html2canvas: Preload: Done."),y.numTotal===y.numLoaded&&r(),g},c.Renderer=function(t,i){function o(t){function e(t){Object.keys(t).sort().forEach(function(n){var i=[],r=[],s=[],a=[];t[n].forEach(function(t){t.node.zIndex.isPositioned||t.node.zIndex.opacity<1?s.push(t):t.node.zIndex.isFloated?r.push(t):i.push(t)}),function h(t){t.forEach(function(t){a.push(t),t.children&&h(t.children)})}(i.concat(r,s)),a.forEach(function(t){t.context?e(t.context):o.push(t.node)})})}var i,o=[];return i=function(t){function e(t,i,o){var r="auto"===i.zIndex.zindex?0:Number(i.zIndex.zindex),s=t,a=i.zIndex.isPositioned,h=i.zIndex.isFloated,l={node:i},u=o;i.zIndex.ownStacking?(s=l.context={"!":[{node:i,children:[]}]},u=n):(a||h)&&(u=l.children=[]),0===r&&o?o.push(l):(t[r]||(t[r]=[]),t[r].push(l)),i.zIndex.children.forEach(function(t){e(s,t,u)})}var i={};return e(i,t),i}(t),e(i),o}function r(t){var e;if("string"==typeof i.renderer&&c.Renderer[t]!==n)e=c.Renderer[t](i);else{if("function"!=typeof t)throw new Error("Unknown renderer");e=t(i)}if("function"!=typeof e)throw new Error("Invalid renderer defined");return e}return r(i.renderer)(t,i,e,o(t.stack),c)},c.Util.Support=function(t,e){function i(){var t=new Image,i=e.createElement("canvas"),o=i.getContext===n?!1:i.getContext("2d");if(o===!1)return!1;i.width=i.height=10,t.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{o.drawImage(t,0,0),i.toDataURL()}catch(r){return!1}return c.Util.log("html2canvas: Parse: SVG powered rendering available"),!0}function o(){var t,n,i,o,r=!1;return e.createRange&&(t=e.createRange(),t.getBoundingClientRect&&(n=e.createElement("boundtest"),n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n),i=t.getBoundingClientRect(),o=i.height,123===o&&(r=!0),e.body.removeChild(n))),r}return{rangeBounds:o(),svgRendering:t.svgRendering&&i()}},t.html2canvas=function(e,n){e=e.length?e:[e];var i,o,r={logging:!1,elements:e,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return r=c.Util.Extend(n,r),c.logging=r.logging,r.complete=function(t){("function"!=typeof r.onpreloaded||r.onpreloaded(t)!==!1)&&(i=c.Parse(t,r),("function"!=typeof r.onparsed||r.onparsed(i)!==!1)&&(o=c.Renderer(i,r),"function"==typeof r.onrendered&&r.onrendered(o)))},t.setTimeout(function(){c.Preload(r)},0),{render:function(t,e){return c.Renderer(t,c.Util.Extend(e,r))},parse:function(t,e){return c.Parse(t,c.Util.Extend(e,r))},preload:function(t){return c.Preload(c.Util.Extend(t,r))},log:c.Util.log}},t.html2canvas.log=c.Util.log,t.html2canvas.Renderer={Canvas:n},c.Renderer.Canvas=function(t){function i(t,e){t.beginPath(),e.forEach(function(e){t[e.name].apply(t,e.arguments)}),t.closePath()}function o(t){if(-1===a.indexOf(t.arguments[0].src)){l.drawImage(t.arguments[0],0,0);try{l.getImageData(0,0,1,1)}catch(e){
return h=s.createElement("canvas"),l=h.getContext("2d"),!1}a.push(t.arguments[0].src)}return!0}function r(e,n){switch(n.type){case"variable":e[n.name]=n.arguments;break;case"function":switch(n.name){case"createPattern":if(n.arguments[0].width>0&&n.arguments[0].height>0)try{e.fillStyle=e.createPattern(n.arguments[0],"repeat")}catch(r){u.log("html2canvas: Renderer: Error creating pattern",r.message)}break;case"drawShape":i(e,n.arguments);break;case"drawImage":n.arguments[8]>0&&n.arguments[7]>0&&(!t.taintTest||t.taintTest&&o(n))&&e.drawImage.apply(e,n.arguments);break;default:e[n.name].apply(e,n.arguments)}}}t=t||{};var s=e,a=[],h=e.createElement("canvas"),l=h.getContext("2d"),u=c.Util,d=t.canvas||s.createElement("canvas");return function(t,e,i,o,s){var a,h,l,c=d.getContext("2d"),p=t.stack;return d.width=d.style.width=e.width||p.ctx.width,d.height=d.style.height=e.height||p.ctx.height,l=c.fillStyle,c.fillStyle=u.isTransparent(p.backgroundColor)&&e.background!==n?e.background:t.backgroundColor,c.fillRect(0,0,d.width,d.height),c.fillStyle=l,o.forEach(function(t){c.textBaseline="bottom",c.save(),t.transform.matrix&&(c.translate(t.transform.origin[0],t.transform.origin[1]),c.transform.apply(c,t.transform.matrix),c.translate(-t.transform.origin[0],-t.transform.origin[1])),t.clip&&(c.beginPath(),c.rect(t.clip.left,t.clip.top,t.clip.width,t.clip.height),c.clip()),t.ctx.storage&&t.ctx.storage.forEach(function(t){r(c,t)}),c.restore()}),u.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),1===e.elements.length&&"object"==typeof e.elements[0]&&"BODY"!==e.elements[0].nodeName?(h=s.Util.Bounds(e.elements[0]),a=i.createElement("canvas"),a.width=Math.ceil(h.width),a.height=Math.ceil(h.height),c=a.getContext("2d"),c.drawImage(d,h.left,h.top,h.width,h.height,0,0,h.width,h.height),d=null,a):d}}}(window,document),function(){"use strict";var t=function(t){this.options=_.extend({},{template:' <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">  <div class="locator {{ (noGenerate.controlsOpen) ? \'controls-open\' : \'controls-closed\' }}">  <section class="locator-display">  <div class="locator-map-wrapper">  <div class="locator-display-inner">  <div class="locator-map"></div>   <div class="locator-map-help">  Move the marker by dragging the base.  {{#(options.tilesets[options.tileset] && options.tilesets[options.tileset].attribution)}}  Required attribution for this map:  <span class="attribution">{{{ options.tilesets[options.tileset].attribution }}}</span>  {{/()}}  </div>  </div>  </div>  </section>    <section class="locator-controls">  <div class="minor-controls">  <div class="toggle-controls" on-tap="toggle:\'noGenerate.controlsOpen\'"></div>   {{#options.markerToCenter}}  <button class="minor-button" on-tap="marker-to-center" title="Move marker to center of map"><i class="fa fa-compass"></i></button>  {{/}}   {{#options.centerToMarker}}  <button class="minor-button" on-tap="center-to-marker" title="Center map on marker"><i class="fa fa-plus-square-o"></i></button>  {{/}}   <button class="minor-button minor-generate" on-tap="generate" title="Generate"><i class="fa fa-download"></i></button>  </div>   <div class="locator-controls-wrapper">  <header>{{ options.title }}</header>   <div class="locator-input">  <div class="config-option">  <label>Marker label. Use <code>&lt;br&gt;</code> to make line breaks.</label>  <input type="text" placeholder="Marker label" value="{{ options.markerText }}" lazy>  </div>   {{^options.geocoder}}  <div class="config-option">  <label>Latitude and longitude location</label>   <br><input type="number" placeholder="Latitude" value="{{ options.lat }}" lazy>  <br><input type="number" placeholder="Longitude" value="{{ options.lng }}" lazy>  </div>  {{/options.geocoder}}   {{#options.geocoder}}  <div class="config-option">  <label>Search location by address</label>  <input type="text" placeholder="Address or place" value="{{ geocodeInput }}" lazy disabled="{{ isGeocoding }}">  </div>  {{/options.geocoder}}   {{#(_.size(options.tilesets))}}  <div class="config-option">  <label>Background map set</label>   <div class="image-picker images-{{ _.size(options.tilesets) }}">  {{#options.tilesets:i}}  <div class="image-picker-item {{ (options.tileset === i) ? \'active\' : \'\' }}" style="background-image: url({{= preview }});" title="{{ i }}" on-tap="set:\'options.tileset\',{{ i }}"></div>  {{/options.tilesets}}  </div>  </div>  {{/()}}   {{#options.markerToCenter}}  <div class="config-option config-button">  <button on-tap="marker-to-center"><i class="fa fa-compass"></i></button>  <label>Move marker to center of map</label>  </div>  {{/}}   {{#options.centerToMarker}}  <div class="config-option config-button">  <button on-tap="center-to-marker"><i class="fa fa-plus-square-o"></i></button>  <label>Center map on marker</label>  </div>  {{/}}   {{#(_.size(options.widths))}}  <div class="config-option config-select">  <label>Map width</label>   <select value="{{ options.width }}">  {{#options.widths:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.widths}}  </select>  </div>  {{/()}}   {{#(_.size(options.ratios))}}  <div class="config-option config-select">  <label>Map aspect ratio</label>   <select value="{{ options.ratio }}">  {{#options.ratios:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.ratios}}  </select>  </div>  {{/()}}   <div class="config-option">  <label>Mini-map zoom</label>   <input type="range" min="-10" max="1" value="{{ options.miniZoomOffset }}" title="Adjust zoom level for map">  </div>   <div class="config-action">  <button class="generate-image" on-tap="generate">Generate <i class="fa fa-download"></i></button>  </div>   <div class="preview">  <h1>Preview</h1>  <img src="" /><br>  <a href="" class="download-link">Download</a>  </div>  </div>  </div>   <footer>  <p>Made by WNYC</p>  </footer>  </section> </div> ',title:"Locator",tilesets:{"CartoDB Positron":{url:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'},"Stamen Toner":{url:"http://tile.stamen.com/toner/{z}/{x}/{y}.png",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>'},"Mapbox Streets":{url:"https://api.mapbox.com/v4/jkeefe.np44bm6o/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>"}},tileset:"CartoDB Positron",zoom:17,lat:40.74844,lng:-73.98566,minZoom:1,maxZoom:18,miniWidth:"15w",miniHeight:"15w",miniZoomOffset:-6,miniExtentStyles:{fill:!1,stroke:!0,color:"#000000",opacity:.9,weight:4},miniStyles:{backgroundColor:"#FFFFFF",padding:3,shadow:!0,shadowColor:"rgba(0, 0, 0, 0.65)",shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1},markerText:"Empire State Building",markerBackground:"rgba(0, 0, 0, 0.9)",markerForeground:"rgba(255, 255, 255, 0.9)",markerRadius:5,markerFontSize:16,markerFont:'"Open Sans", Helvetica, Arial, sans-serif',markerLabelDistance:20,markerLabelWidth:3,markerPadding:10,draggableMarker:L.icon({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wwLFSU1meAbBQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACOUlEQVR42u3bP0sjQRjH8W8S/wYVFEFR1LOxMaSxsrKQlPcaBH1bCvcSvMrCQhAsbE5FwcZ/hVUQQcQ7CLheMSPYqjOzzyS/DyzpdnZ/u5k8s/sERERERERERERERERERERERERERERExJCKkeOoA7PAFDANjABjQD/QAZ791vbbPfDS6wH2AfPAug/rsx6AI+AWeO2lAKtAA2gF3Oc+cAEU3R7gOLAZad9vwC/gsVsDbAHNBONcA7vdFuAGMJnwYj0B2ykGqiUYYwuYSDxVDPl59iT3ADdKCO/dIPADOM81wBawWHKZNuqDvItZUsT6tW1iwwowl1OA1Yilylf9zCnAhsEl6zCwlkOAfYFXGCE1cwhwHrsGYoQYOsB1bFu1HGCdrz1VSaluOcBZ7KsCC1YDnCIPy1YDnM4kwCWrAY7Qg0IGONaD5xx0Z/2ZBFixGmAnkwDfrAb4nEmAhQLs0juwnUmAVwrwey6tBnifyfx3YzXAF1y7hWV/TReVuF4Vy46tB3hrOLwOcGo9wFdco49FZ+bXhd5F6ForgH/AYS4BFrguKUv2Yu041ov1R1yXlAV/Ys7N1YgHvovrkipTGziIOUAtwdVv4PpTypj3dmIPkqK97QTXJTWa+M7bSTFQLdEJnfu7cCbRnPc71ZVK3SM9h2v0GY70ld1LXcyX9TeHNVybxUCgFcZZrDrPaoDvmrh2i/onK4LCPxg4jrE8yynAjxZwL72XPpRYFb+qKfznFe553g0iAvwHgeJXccwK1poAAAAASUVORK5CYII=",iconSize:[80,80],iconAnchor:[40,55],popupAnchor:[-75,0]}),widths:{Small:400,Medium:600,Large:800},width:"Medium",ratios:{"1:1":1,"4:3":4/3,"16:9":16/9},ratio:"4:3",controlsOpen:!0,centerToMarker:!0,markerToCenter:!0,geocoder:this.defaultGeocoder},t),this.id=_.uniqueId("locator-"),this.el=this.options.el,this.options.tilesets=this.parseTilesets(this.options.tilesets),this.drawInterface()};_.extend(t.prototype,{drawInterface:function(){var t=_.clone(this.options),e={controlsOpen:this.options.controlsOpen};this["interface"]=new Ractive({el:this.options.el,template:this.options.template,data:{options:this.options,noGenerate:e,isGeocoding:!1,geocodeInput:"",_:_}}),this["interface"].on("generate",_.bind(this.generate,this)),this.throttledDrawMaps=_.throttle(_.bind(this.drawMaps,this),1500),_.isFunction(this.options.geocoder)&&(this.throttledGeocoder=_.throttle(_.bind(this.options.geocoder,this),1500)),this["interface"].observe("options",_.bind(function(e){var n=e.lat!==t.lat||e.lng!==t.lng;this.throttledDrawMaps(n),t=_.clone(e)},this),{init:!1}),this["interface"].observe("geocodeInput",_.bind(function(t){_.isFunction(this.throttledGeocoder)&&this.throttledGeocoder(t,_.bind(function(t,e){this.options.lat=t,this.options.lng=e,this.throttledDrawMaps(!0)},this))},this),{init:!1}),this["interface"].on("toggle",function(t,e){this.set(e,!this.get(e))}),this["interface"].on("set",function(t,e,n){this.set(e,n)}),this["interface"].on("marker-to-center",_.bind(function(){var t=this.map.getCenter();this.options.lat=t.lat,this.options.lng=t.lng,this["interface"].update()},this)),this["interface"].on("center-to-marker",_.bind(function(){this.map.setView([this.options.lat,this.options.lng])},this)),this.drawMaps()},drawMaps:function(t){this.alterOptions("preDraw"),this.drawMap(t),this.drawMarker(),this.drawMinimap(),this.fixMapVerticalAlign()},alterOptions:function(t){_.isFunction(this.options[t])&&_.bind(this.options[t],this)(this.options)},drawMap:function(t){t=t||!1;var e,n,i,o=this.getEl(".locator-map");o.id=this.id+"-map",i=[this.options.lat,this.options.lng,this.options.zoom],this.map&&!t?(i[0]=this.map.getCenter().lat,i[1]=this.map.getCenter().lng,i[2]=this.map.getZoom(),this.map.remove()):this.map&&this.map.remove(),e=_.size(this.options.widths)?this.options.widths[this.options.width]:o.getBoundingClientRect().width,n=_.size(this.options.ratios)?e/this.options.ratios[this.options.ratio]:o.getBoundingClientRect().height,o.style.width=e+"px",o.style.height=n+"px",this.map=new L.Map(o.id,{minZoom:this.options.minZoom,maxZoom:this.options.maxZoom,attributionControl:!1}),this.map.setView([i[0],i[1]],i[2]),this.mapLayer=new L.TileLayer(this.options.tilesets[this.options.tileset].url),this.map.addLayer(this.mapLayer)},drawMinimap:function(){var t,e=this.getEl(".locator-map").getBoundingClientRect().width,n=this.getEl(".locator-map").getBoundingClientRect().height,i=_.isNumber(this.options.miniWidth)?this.options.miniWidth:-1!==this.options.miniWidth.indexOf("w")?+this.options.miniWidth.replace("w","")/100*e:+this.options.miniWidth.replace("h","")/100*n,o=_.isNumber(this.options.miniHeight)?this.options.miniHeight:-1!==this.options.miniHeight.indexOf("w")?+this.options.miniHeight.replace("w","")/100*e:+this.options.miniHeight.replace("h","")/100*n;this.minimapLayer=new L.TileLayer(this.options.tilesets[this.options.tileset].url),this.miniMap=new L.Control.MiniMap(this.minimapLayer,{width:i,height:o,zoomLevelOffset:this.options.miniZoomOffset,aimingRectOptions:{fill:!1,stroke:!1}}),this.map.addControl(this.miniMap),this.miniMap._miniMap.addLayer(this.drawMiniCanvasLayer(this.options.miniExtentStyles)),t=this.getEl(".locator-map .leaflet-control-minimap"),_.each(this.miniStylesToCSS(this.options.miniStyles),function(e,n){t.style[n]=e})},drawMiniCanvasLayer:function(t){return this.miniCanvasLayer=L.tileLayer.canvas(),this.miniCanvasLayer.drawTile=_.bind(function(e,n,i){var o=e.getContext("2d");o.clearRect(0,0,e.width,e.height);var r={};r.nwPoint=n.multiplyBy(256),r.sePoint=r.nwPoint.add(new L.Point(256,256)),r.nwCoord=this.map.unproject(r.nwPoint,i,!0),r.seCoord=this.map.unproject(r.sePoint,i,!0),r.bCoord=L.latLngBounds([[r.nwCoord.lat,r.seCoord.lng],[r.seCoord.lat,r.nwCoord.lng]]),r.bPoint=[r.nwPoint,r.sePoint];var s=this.map.getBounds(),a=this.map.project(s.getNorthWest(),i,!0),h=this.map.project(s.getSouthEast(),i,!0);o.beginPath(),o.rect(a.x-r.nwPoint.x,a.y-r.nwPoint.y,h.x-a.x,h.y-a.y),o=this.leafletStylesToCanvas(t,o),o.closePath()},this),this.map.on("moveend",_.bind(function(){this.miniCanvasLayer.redraw()},this)),this.miniCanvasLayer},drawMarker:function(){this.markerCanvas&&this.map&&this.map.removeLayer(this.markerCanvas),this.markerCanvas=L.tileLayer.canvas(),this.markerCanvas.drawTile=_.bind(this.drawMarkerTile,this),this.markerCanvas.addTo(this.map),this.draggableMarker&&this.map&&this.map.removeLayer(this.draggableMarker),this.draggableMarker=L.marker(L.latLng(this.options.lat,this.options.lng),{icon:this.options.draggableMarker,draggable:!0,opacity:0,title:"Drag marker here"}).addTo(this.map),this.draggableMarker.on("dragstart",function(t){t.target.setOpacity(1)}),this.draggableMarker.on("dragend",_.bind(function(t){t.target.setOpacity(0);var e=t.target.getLatLng();this.options.lat=e.lat,this.options.lng=e.lng,this.drawMarker()},this))},drawMarkerTile:function(t,e,n){var i,o,r,s=t.getContext("2d"),a=this.options.markerText.split("<br>");a=_.map(a,function(t){return t.trim()});var h=a.length,l=1.25,u=this.options.markerFontSize*l*h+2*this.options.markerPadding;s.clearRect(0,0,t.width,t.height);var c={};c.nwPoint=e.multiplyBy(256),c.sePoint=c.nwPoint.add(new L.Point(256,256)),c.nwCoord=this.map.unproject(c.nwPoint,n,!0),c.seCoord=this.map.unproject(c.sePoint,n,!0),c.bCoord=L.latLngBounds([[c.nwCoord.lat,c.seCoord.lng],[c.seCoord.lat,c.nwCoord.lng]]),c.bPoint=[c.nwPoint,c.sePoint],c.locCoord=L.latLng(this.options.lat,this.options.lng),c.locPoint=this.map.project(c.locCoord,n,!0),i={x:c.locPoint.x-c.nwPoint.x,y:c.locPoint.y-c.nwPoint.y},s.beginPath(),s.translate(i.x-this.options.markerRadius,i.y-this.options.markerRadius),s.fillStyle=this.options.markerBackground,s.fillRect(0,0,2*this.options.markerRadius,2*this.options.markerRadius),s.setTransform(1,0,0,1,0,0),s.closePath(),s.beginPath(),s.translate(i.x-this.options.markerLabelWidth/2,i.y-this.options.markerRadius-this.options.markerLabelDistance),s.fillStyle=this.options.markerBackground,s.fillRect(0,0,this.options.markerLabelWidth,this.options.markerLabelDistance),s.setTransform(1,0,0,1,0,0),s.closePath(),s.beginPath(),s.font=this.options.markerFontSize+"px "+this.options.markerFont,s.fillStyle=this.options.markerForeground,s.textAlign="center",o=_.max(a,function(t){return s.measureText(t).width}),o=s.measureText(o).width,r=o+2*this.options.markerPadding,s.closePath(),s.beginPath(),s.translate(i.x-r/2,i.y-this.options.markerRadius-this.options.markerLabelDistance-u),s.fillStyle=this.options.markerBackground,s.fillRect(0,0,r,u),s.setTransform(1,0,0,1,0,0),s.closePath(),_.each(a,_.bind(function(t,e){var n=1;s.beginPath(),s.translate(i.x,i.y-this.options.markerRadius-this.options.markerLabelDistance-u+this.options.markerPadding+n+this.options.markerFontSize*l*e),s.font=this.options.markerFontSize+"px "+this.options.markerFont,s.fillStyle=this.options.markerForeground,s.textAlign="center",s.textBaseline="top",s.fillText(t,0,0),s.setTransform(1,0,0,1,0,0),s.closePath()},this))},generate:function(){this.getEl(".locator-map .leaflet-control-zoom").style.display="none",this.getEl(".locator-map .leaflet-control-minimap").style.display="none",html2canvas(this.getEl(".locator-map"),{useCORS:!0,onrendered:_.bind(function(t){this.getEl(".locator-map .leaflet-control-zoom").style.display="block",this.getEl(".locator-map .leaflet-control-minimap").style.display="block",html2canvas(this.getEl(".locator-map .leaflet-control-minimap"),{useCORS:!0,onrendered:_.bind(function(e){var n=this.drawCanvasMiniMap(t,e);this.preview(n),this["export"](n)},this)})},this)})},drawCanvasMiniMap:function(t,e){var n=t.getContext("2d"),i=this.getEl(".locator-map .leaflet-control-minimap"),o=i.getBoundingClientRect().width,r=i.getBoundingClientRect().height,s=this.options.miniStyles,a=10,h=10;return n.beginPath(),n.fillStyle=s.backgroundColor,s.shadow&&(n.shadowColor=s.shadowColor,n.shadowBlur=s.shadowBlur,n.shadowOffsetX=s.shadowOffsetX,n.shadowOffsetY=s.shadowOffsetY),n.fillRect(n.canvas.width-a-o-2*s.padding,n.canvas.height-h-r-2*s.padding,o+2*s.padding,r+2*s.padding),n.closePath(),n.beginPath(),n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0,n.drawImage(e,n.canvas.width-a-o-s.padding,n.canvas.height-h-r-s.padding,o,r),n.closePath(),n},preview:function(t){this.getEl(".preview img").src=t.canvas.toDataURL()},"export":function(t){var e=this.getEl(".download-link");e.href=t.canvas.toDataURL(),e.download=this.makeID(this.options.markerText)+".png",e.click()},getEl:function(t){return document.querySelector(this.el+" "+t)},miniStylesToCSS:function(t){var e={"background-color":t.backgroundColor,border:t.padding+"px solid "+t.backgroundColor};return t.shadow&&(e["box-shadow"]=t.shadowOffsetX+"px "+t.shadowOffsetY+"px "+t.shadowBlur+"px "+t.shadowColor),e},leafletStylesToCanvas:function(t,e){return t.fill&&(e.globalAlpha=t.fillOpacity||1,e.fillStyle=t.fillColor||t.color,e.fill(t.fillRule||"evenodd")),t.stroke&&0!==t.weight&&(e.globalAlpha=t.opacity||1,e.strokeStyle=t.color,e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.stroke()),e},defaultGeocoder:function(t,e){var n=new XMLHttpRequest,i="https://maps.googleapis.com/maps/api/geocode/json?address="+encodeURIComponent(t),o=_.once(e);n.onreadystatechange=function(){var t;200===n.status&&n.responseText&&(t=JSON.parse(n.responseText),t&&t.results&&t.results.length&&o(t.results[0].geometry.location.lat,t.results[0].geometry.location.lng))},n.open("GET",i),n.send()},parseTilesets:function(t){return _.each(t,function(e,n){_.isString(e)&&(t[n]={url:e}),t[n].preview||(t[n].preview=t[n].url.replace("{s}","a").replace("{x}","301").replace("{y}","385").replace("{z}","10"))}),t},makeID:function(t){return t=t.toString(),t=t.toLowerCase().trim().replace(/\W+/g,"-"),t=t?t:"locator",_.uniqueId(t+"-")},overflowed:function(t,e){return e?"y"===e?t.scrollHeight>t.clientHeight:"x"===e?t.scrollWidth>t.clientWidth:!1:t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth},fixMapVerticalAlign:function(){var t=this.getEl(".locator-display");this.overflowed(t,"y")?t.classList.add("overflowed-y"):t.classList.remove("overflowed-y")}}),window.Locator=t}();